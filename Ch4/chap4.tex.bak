%--------------------------------------------------------------------------------------------------------------------
%------------------------------------------------- Chapter 4 --------------------------------------------------------
\chapter{Dise{\~n}o y aplicaci{\'o}n de un SDDEF h{\'\i}brido}
La idea fundamental detr{\'a}s de todo dise{\~n}o de un sistema de detecci{\'o}n, diagn{\'o}stico y estimaci{\'o}n de fallas
(SDDEF) es brindar un herramienta de soporte para la toma de decisiones en grandes procesos qu{\'\i}micos. Aqu{\'\i},
pueden existir cientos de lazos de control y miles de variables medidas en cada segundo. En este caso donde
la interacci{\'o}n y el n{\'u}mero de las variables resulta elevada se presenta el mayor desaf{\'\i}o en las estrategias
de dise{\~n}o de SDDEF h{\'\i}bridos. B{\'a}sicamente el dise{\~n}o de un SDDEF y su funcionamiento debe realizarse de forma
independiente de varios factores tales como:
\begin{enumerate}
    \item Dimensi{\'o}n del proceso: una variable simple o miles,
    \item Complejidad del proceso: sistemas lineales o fuertemente no lineales,
    \item Tipo de proceso: qu{\'\i}mico, petroqu{\'\i}mico, biol{\'o}gico, el{\'e}ctrico, etc.,
    \item Tipo de fallas presentes: en actuadores o en sensores (retardos, offset, bloqueos),
    \item Tipo de perturbaciones presentes: medias o no medidas, abruptas o suaves,
    \item Modo de funcionamiento: si es necesario seguir una trayectoria de referencia cambiante (servo) o
    mantener el proceso en su punto operativo fijo (regulador) rechazando perturbaciones,
    \item Tipo de la pol{\'\i}tica de control: decentralizada donde los lazos de control son tratados como lazos
    SISO (generalmente incluyendo controladores tipo P, PI, o PID). Las pol{\'\i}ticas multivariables generalmente
    incluyen estrategias SISO (P,PI,PID) en los lazos de control de mas bajo nivel, y una estrategia de
    control avanzado (CPM, CPA, CP funcional, etc) como control supervisor de estos.
\end{enumerate}

\section{Dise{\~n}o del SDDEF}\label{sec_sddef}
Actualmente los avances en los dispositivos de medici{\'o}n as{\'\i} como en los elementos de almacenamiento de datos
permiten tener una gran cantidad de informaci{\'o}n recolectada bajo condiciones de operaci{\'o}n normal y anormal.
Esta bases de datos, as{\'\i} presentadas, contienen gran cantidad de informaci{\'o}n redundante y deben ser
procesadas por medio de algoritmos adecuados. La estrategia presentada en esta tesis representa una
metodolog{\'\i}a alternativa para procesar de forma inteligente las bases de datos y dise{\~n}ar de forma adecuada un
SDDEF para ser integrado a lazos de CTF. Herramientas tales como, ACP adaptivo, SLD y RNA son combinadas de
forma eficiente para realizar tareas de detecci{\'o}n, clasificaci{\'o}n y estimaci{\'o}n en l{\'\i}nea.

\subsection{Monitoreo y detecci{\'o}n de fallas: ACP, ACP adaptivo y estad{\'\i}sticos combinados}\label{sec_sddef_apca}
En la secci{\'o}n \ref{sec_PCA} se presento en detalle la estrategia de ACP cl{\'a}sico, el monitoreo de procesos
basados en estad{\'\i}sticos de control tales como $T^2$ o $Q$ y las diferentes metodolog{\'\i}as para la selecci{\'o}n de
los componentes principales.

Una de las principales limitaciones del ACP cl{\'a}sico es su capacidad de trabajar correctamente con la
naturaleza cambiante de los procesos industriales. Las diferentes condiciones de operaci{\'o}n y modos pueden
producir un n{\'u}mero excesivo de falsas alarmas o alternativamente p{\'e}rdida de detecci{\'o}n de las fallas del
proceso. En la literatura especializada pueden encontrarse diferentes estrategias para solucionar estos
inconvenientes (\cite{TdLkJl:04}).

En esta secci{\'o}n se propone una nueva estrategia de ACP adaptiva (ACPA) basada en estad{\'\i}sticos combinados
(\cite{YhQs:01}) para realizar las tareas de monitoreo y detecci{\'o}n de fallas en procesos de naturaleza
cambiante. Esta estrategia es comparada con una metodolog{\'\i}a cl{\'a}sica para diferenciar claramente los aportes
y beneficios. Adem{\'a}s, este nuevo algoritmo desde su construcci{\'o}n esta pensado para integrarse con los
subsistemas de clasificaci{\'o}n y estimaci{\'o}n de fallas, focalizado en la interconexi{\'o}n con el CTF.

El modelo de ACP ($\mathbf{P}$) se construye utilizando la matriz de datos normal la cual posee informaci{\'o}n
respecto de las variaciones de causa com{\'u}n alrededor del punto operativo del proceso. EL estad{\'\i}stico de
Hotteling $T^2$ para un nuevo dato obtenido desde el proceso es una medida de su distancia respecto del
origen del SVD. Este origen y sus proximidades delimitan la llamada zona \textit{bajo control}. Puede
ocurrir que el estad{\'\i}stico de Hotteling permanezca bajo su l{\'\i}mite de confianza a{\'u}n cuando un evento anormal
ha ocurrido, esto principalmente se debe a que el evento no posee la suficiente variaci{\'o}n sobre el SVD. Para
evitar este tipo de inconvenientes se propone vincular los estad{\'\i}sticos de monitoreo $T^2$ y $Q$. As{\'\i}
entonces se define el estad{\'\i}stico combinado $z$ como se muestra en la ec. \ref{e4_1} que permite en adici{\'o}n
con la estrategia ACPA monitorear el proceso bajo condiciones cambiantes y mejorar el tiempo de detecci{\'o}n,
minimizar las falsas alarmas y la p{\'e}rdida de detecci{\'o}n.
\begin{equation}\label{e4_1}
    z(k) = \frac{T^2(k)}{\delta_{T^2}(k)} + \frac{Q(k)}{\delta_{Q}(k)}
\end{equation}
Notar que $z(k)$, $T^2(k)$ y $Q(k)$ son los estad{\'\i}sticos computados para la medici{\'o}n actual del proceso
$\overline{\mathbf{x}}(k)$. Por otro lado, $\delta_{T^2}(k)$ and $\delta_{Q}(k)$ son los limites de control
actualizados para el instante temporal $k$ utilizando alg{\'u}n criterio de nivel de confianza $\nu$ (95\% o
99\%) y la estrategia vista en la secci{\'o}n \ref{sec_PCA}. Bajo estas definiciones una condici{\'o}n de operaci{\'o}n
normal puede definirse si $z(k)\leq \delta_{z}$, donde $\delta_{z}$ es el nuevo l{\'\i}mite de control.

En la Fig. \ref{f4_1} puede observarse el nuevo algoritmo propuesto de ACPA con estad{\'\i}sticos combinados. El
algoritmo comienza con una etapa de inicializaci{\'o}n ($k=0$), donde se procesa los datos que representan el
estado normal de operaci{\'o}n $\mathbf{X}$ y se obtiene los datos en estado normal autoescalados
$\overline{\mathbf{X}}$ cuyos par{\'a}metros de escala vienen dados por $\mathbf{b}(0)$ y $\mathbf{s}(0)$ siendo
estos el vector de medias y varianza respectivamente. A continuaci{\'o}n se calcula la matrix de correlaci{\'o}n de
los datos $\mathbf{R}$ y su descomposici{\'o}n utilizando DVS, as{\'\i} podemos obtener el modelo ACP $\mathbf{P}$.
Los $A$ componentes principales se seleccionan mediante la estrategia PVA considerando un $\delta_{pva}$ \%.
Los l{\'\i}mites de confianza iniciales son ajustados a $\delta_{T^2}(0)$ y $\delta_{Q}(0)$ utilizando el
criterio de $\nu$ veces la varianza (ver ec. \ref{e2_10}). Tambi{\'e}n en esta secci{\'o}n se ajusta el tama{\~n}o de la
ventana temporal de los datos normales $N_w$, la dimensi{\'o}n de la matriz auxiliar $N_{aux}$ y la llamada
matrix de datos normales $\overline{\mathbf{X}}_{n}(0)$ utilizada para actualizar los par{\'a}metros.
%------------------------------------------------------------------------------------------------
\begin{figure}
\centering
\begin{minipage}[c]{12cm}
\small\rmfamily
\begin{description}
    \item[\textrm{Inicializaci{\'o}n,} $k=0$:] Adquirir datos de entrenamiento en condiciones normales de operaci{\'o}n
    $\mathbf{X}$. Aplicar auto-escalado de los datos de entrenamiento para obtener media cero y varianza
    unidad $\overline{\mathbf{X}}$ con los factores de escala $\mathbf{b}(0)$ y $\mathbf{s}(0)$. Obtener la
    matriz de correlaci{\'o}n de los datos $\mathbf{R}$ y realizar la DVS para construir el modelo
    $\mathbf{P}$, seleccionar los componentes principales iniciales $A(0)$ utilizando el criterio PVA con
    $\delta{pva}$ \%. Determinar los l{\'\i}mites de control $\delta_{T^2}(0)$ y $\delta_{Q}(0)$. Ajustar la
    dimensi{\'o}n de la ventana m{\'o}vil $N_{w}$ y la matriz de datos normales $\overline{\mathbf{X}}_{n}(0)$.
    \item[\textrm{Monitoreo,} $k>0$:] Obtener la pr{\'o}xima medici{\'o}n del proceso $\mathbf{x}(k)$.\\
    (1) Escalar $\mathbf{x}(k)$ los factores de escala y obtener $\overline{\mathbf{x}}(k)$.\\
    (2) Evaluar los estad{\'\i}sticos $T^2(k)$ y $Q(k)$ con el modelo ACP actual.\\
    (3) Construir el estad{\'\i}stico combinado $z(k)$ con los {\'u}ltimos l{\'\i}mites de control $\delta_{T^2}(k-1)$ y
    $\delta_{Q}(k-1)$.\\
    (4) Comprobar si $z(k)\leq \delta_z$. Si esto es cierto actualizar la matriz de datos normales
    $\overline{\mathbf{X}}_{n}(k)$ borrando el dato mas antiguo y concatenando el nuevo
    $\overline{\mathbf{x}}(k)$.\\
    (5) Si $z(k)>\delta_z$ ajustar una \textit{alerta de peligro}. Si $N_{a}$ alertas de peligro
    consecutivas se presentan ajustar una \textit{alerta de falla}.\\
    (6) Si una alerta de falla es encendida, almacenar el vector de datos del proceso $\mathbf{x}(k)$ en
    una matrix auxiliar $\mathbf{X}_{aux}$ durante las pr{\'o}ximas $N_{aux}$  muestras.\\
    (7) Si una alerta de falla ha sido encendida y $k>=N_{aux}$ actualizar los factores de escalado
    $\mathbf{b}(k)$ y $\mathbf{s}(k)$ utilizando la matriz de datos auxiliar $\mathbf{X}_{aux}$.\\
    (8) Actualizar los l{\'\i}mites de control $\delta_{T^2}(k)$ y $\delta_{Q}(k)$, utilizando la matriz de
    datos normales actual y el nivel de confianza $\nu$.\\
    (9) Realizar la DVS de la matriz de autocorrelaci{\'o}n de los datos normales
    $\overline{\mathbf{X}}_{n}(k)$.\\
    (10) Seleccionar los componentes principales retenidos $A(k)$ utilizando e criterio PVA con
    $\delta_{pva}$ \%. Actualizar el modelo ACP y \\
    (11) Ir al item de monitoreo nuevamente con $k+1$.
\end{description}
\normalsize\sffamily
\end{minipage}
\caption{Algoritmo ACPA con estad{\'\i}sticos combinados}\label{f4_1}
\end{figure}
%----------------------------------------------------------------------------------------------------------

El monitoreo en linea comienza con la obtenci{\'o}n de una nueva muestra del proceso $\mathbf{x}(k)$, la cual es
escalada utilizando los factores de escala para obtener $\overline{\mathbf{x}}(k)$. Esta es evaluada en los
estad{\'\i}sticos $T^2(k)$ and $Q(k)$ y utilizando los l{\'\i}mites de control previos $\delta_{T^2}(k-1)$ y
$\delta_{SPE}(k-1)$ el estad{\'\i}stico combinado $z(k)$ es calculado. Si $z(k)\leq \delta_z$, la matriz de datos
normales es actualizada $\overline{\mathbf{X}}_{n}(k)$ borrando los datos mas antiguos y concatenando el
dato nuevo $\overline{\mathbf{x}}(k)$, si esto no se cumple entonces el dato nuevo no se incluye en la
matriz de datos normales. Si $z(k)>\delta_z$ una \textit{alerta de peligro} es ajustada y si $N_{a}$ alertas
de peligro consecutivas est{\'a}n activas entonces debe activarse una \textit{alerta de falla}. En este {\'u}ltimo
caso las muestras actuales del proceso $\mathbf{x}(k)$ son almacenadas en la matriz de datos auxiliar
$\mathbf{X}_{aux}$ durante las pr{\'o}ximas $N_{aux}$ muestras. Notar que la ventana temporal esta {\'\i}ntimamente
relacionada con el tiempo m{\'a}ximo requerido para alcanzar el estado estacionario (propio de cada proceso).
Adicionalmente si $k>=N_{aux}$ (todos los datos anormales han sido almacenados en la matriz auxiliar) los
factores de escala son actualizados a $\mathbf{b}(k)$ y $\mathbf{s}(k)$ utilizando dicha matriz. El pr{\'o}ximo
paso es actualizar los l{\'\i}mites de confianza $\delta_{T^2}(k)$ y $\delta_{Q}(k)$ utilizando el criterio de
$\nu$ veces la varianza como se explic{\'o} en la ec. \ref{e2_10}, siendo $\nu=2$ para 95\% y $\nu=3$ para 99\%
de nivel de confianza.

Tambi{\'e}n puede considerarse, en el caso de que sea necesario, actualizar la informaci{\'o}n respecto de los
cambios en la correlaci{\'o}n de los datos del proceso. Esto puede llevarse a cabo considerando o no los puntos
(9) y (10) del algoritmo de la Fig. \ref{f4_1}. El primero, involucra la descomposici{\'o}n DVS de la nueva
matriz de correlaci{\'o}n calculada sobre $\overline{\mathbf{X}}_{n}(k)$ y para completar el proceso de
actualizaci{\'o}n el punto (10) recalcula los componentes principales $A(k)$ retenidos utilizando el criterio
PVA. Notar que con estas modificaciones tanto el modelo ACP como $A$ son actualizados en cada instante
temporal $k$.

Generalmente la actualizaci{\'o}n del modelo $\mathbf{P}$ y de los componentes principales $A$ es necesaria
cuando la correlaci{\'o}n entre las variables del proceso se ve modificada, por ejemplo cuando cambia el tiempo
muerto entre las variables. Las modificaciones de las variables del proceso respecto de sus valores medios y
de varianza son actualizados utilizando la matriz de datos auxiliar $\mathbf{X}_{aux}$. En la mayor{\'\i}a de los
casos esta actualizaci{\'o}n de medias y varianza en conjunto con la actualizaci{\'o}n de los l{\'\i}mites de confianza
resulta suficiente para mantener el correcto monitoreo del proceso en situaciones cambiantes, bajo
diferentes pol{\'\i}ticas de trabajo, perturbaciones y fallas.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Estad{\'\i}stico $T^2(k)$]{\includegraphics[width=7cm,height=7cm]{Ch4/t2_pca_apca}\label{f4_2a}}
\subfigure[Estad{\'\i}stico $Q(k)$
statistic]{\includegraphics[width=7cm,height=7cm]{Ch4/q_pca_apca}\label{f4_2b}} \subfigure[Estad{\'\i}stico
combinado $z(k)$]{\includegraphics[width=7cm,height=7cm]{Ch4/z_pca_apca}\label{f4_2c}} \caption{Algoritmo
cl{\'a}sico de ACP y el propuesto ACPA} \label{f4_2}
\end{figure}
%-------------------------------------------------------------------------------------------------------

En la Fig. \ref{f4_2} se puede apreciar un ejemplo de aplicaci{\'o}n donde se comparan el algoritmo de ACP
cl{\'a}sico con el propuesto ACPA de la Fig. \ref{f4_1}, en ambos casos con estad{\'\i}sticos combinados. En este
caso se presenta un an{\'a}lisis realizado sobre una planta de pulpa y papel en la que ocurren dos fallas
secuenciales en sensores. La primera aparece en $t=500$ min. y es debida a una falla en el sensor de
temperatura del reactor de ox{\'\i}geno (bias positivo) y la segunda ocurre en $t=7000$ min. y es debida a un
error de medici{\'o}n en el sensor de temperatura del reactor de blanqueo $E$ (bias negativo). Las Figs.
\ref{f4_2a}, \ref{f4_2b} y \ref{f4_2c} muestran la evoluci{\'o}n temporal en este caso de los estad{\'\i}sticos
$T^2(k)$, $Q(k)$ y $z(k)$ respectivamente, cuando una estrategia cl{\'a}sica de ACP y la propuesta ACPA es
utilizada. Puede observarse claramente como el ACP cl{\'a}sico solo puede detectar la primera falla quedando su
estad{\'\i}stico fuera de los l{\'\i}mites de confianza sin permitir detectar la segunda. Por otro lado, la
metodolog{\'\i}a ACPA propuesta adapta sus par{\'a}metros permitiendo la correcta detecci{\'o}n de ambos eventos
anormales con buena resoluci{\'o}n temporal. Adem{\'a}s mantiene sus estad{\'\i}sticos dentro de la regi{\'o}n de confianza
dejando a el sistema listo para nuevas posibles detecciones. Es posible observar tambi{\'e}n el beneficio de
contar con el estad{\'\i}stico combinado $z(k)$ para evitar p{\'e}rdida de detecciones. En el caso por ejemplo de
ACPA  la segunda falla no es detectada con el estad{\'\i}stico $T^2(k)$, pero perfectamente detectable cuando se
utiliza el estad{\'\i}stico combinado.

\subsection{Aislamiento: SLD y extracci{\'o}n autom{\'a}tica de reglas (EAR)}\label{sec_sddef_fl}
La idea detr{\'a}s de este m{\'e}todo es la de utilizar la informaci{\'o}n obtenida del sistema de monitoreo y detecci{\'o}n
ACPA, para realizar la clasificaci{\'o}n del estado del proceso. Por ejemplo, estas se{\~n}ales pueden ser la
contribuci{\'o}n a los estad{\'\i}sticos tales como $\mathbf{t}(k)=\mathbf{P}^{T}\overline{\mathbf{x}}^{T}(k)$ que
contribuye a $T^2(k)$ y/o  $\Delta
\overline{\mathbf{x}}(k)=\widetilde{\mathbf{C}}\overline{\mathbf{x}}^{T}(k)$ que contribuye a $Q(k)$.
% Figure-------------------------------------------------------
\begin{figure}[t]
\centering%
\includegraphics[width=11cm,height=8cm]{Ch4/fuzzy_approach}\caption{Estrategia del SLD} \label{f4_3}
\end{figure}
%--------------------------------------------------------------

La base de datos del proceso, ya sea la base de comportamiento normal como la anormal son procesadas y
analizadas. Bajo operaci{\'o}n normal todas las variables del proceso se encuentran dentro de su rango
delimitado por sus l{\'\i}mites superiores e inferiores. La primera base de datos posee informaci{\'o}n respecto de
los l{\'\i}mites de todas la variables en operaci{\'o}n normal. En presencia de un evento anormal ciertas variables
espec{\'\i}ficas del proceso exceden sus respectivos l{\'\i}mites generando un patr{\'o}n (huella) de la falla
perfectamente definido. El conjunto de estos patrones para cada tipo de eventos definen la llamada
\textit{matriz de reglas} en el lenguaje de SLD.

En esta tesis el sistema de clasificaci{\'o}n esta basado en la teor{\'\i}a de SLD. El sistema de detecci{\'o}n ACPA
otorga informaci{\'o}n concreta respecto del instante de ocurrencia de la falla e informaci{\'o}n respecto de las
modificaciones sufridas por el proceso. As{\'\i}, pueden construirse las funciones de pertenencia, los valores
ling{\"u}{\'\i}sticos y las reglas correspondientes a una falla particular. Entonces analizando la contribuci{\'o}n a los
estad{\'\i}sticos ($\mathbf{t}(k)$ y/o $\Delta \overline{\mathbf{x}}(k)$) y sus desviaciones puede definirse un
{\'u}nico patr{\'o}n (huella) para cada evento anormal que ocurre en el proceso. La base de datos de operaci{\'o}n
anormal del proceso es analizada para realizar la \textit{extracci{\'o}n autom{\'a}tica de reglas} y agrupar los
patrones obtenidos en la llamada matrix de reglas.

Esta es una estrategia modificada a la dada por \cite{Me:05} y \cite{MeYiPl:06}. En estos trabajos ha sido
considerado: ACP cl{\'a}sico, monitoreo utilizando estad{\'\i}sticos simples, no se ha considerado fallas
secuenciales, se han tomado valores fijos de las fallas, se considera la contribuci{\'o}n media despu{\'e}s de la
fuzificaci{\'o}n y el SLD funciona continuamente. En la contribuci{\'o}n presentada en esta tesis se amplia y mejora
el funcionamiento considerando: ACP adaptivo, estad{\'\i}sticos combinados, fallas secuenciales, la magnitud de
la falla puede tomar cualquier valor dentro de una rango determinado, la contribuci{\'o}n media es calculada
antes de la fuzificaci{\'o}n y el SLD funciona solamente cuando un evento anormal es detectado por el sistema de
monitoreo.

La entrada del SLD se define en la ec. \ref{e4_2}, donde las $u_{i}(k)$ (Fig. \ref{f4_3}) son las variables
a ser analizadas (contribuciones a $T^2$ y/o $Q$) y presentadas como normalizaci{\'o}n respecto del estado
normal.
\begin{equation}\label{e4_2}
    \mathbf{u}_{FL}(k)=\left[u_{1}(k),u_{2}(k),\ldots,u_{r}(k)\right]
\end{equation}
donde $r$ es el n{\'u}mero de componentes. Utilizando el instante de detecci{\'o}n $t_d$ de la falla que ocurre en
$t_f$, dado por el subsistema de monitoreo, se puede definir una zona de an{\'a}lisis $[T_{iz},T_{fz}]$ para
cada componente. Esto puede observarse en la Fig. \ref{f4_3}, donde se presenta la estrategia utilizada por
el SLD, siendo la variable $i$ la que esta sujeta a an{\'a}lisis.

Con la finalidad de poder evaluar el estado del proceso utilizando $\mathbf{u}_{FL}(k)$ y la zona de
an{\'a}lisis, se calcula entonces la contribuci{\'o}n media de cada componente $u_{i}(k)$ en dicha zona y se agrupa
en
\begin{equation}\label{e4_3}
    \mathbf{u}_{FL}^{m}=\left[u_{1}^{m},u_{2}^{m},\ldots,u_{r}^{m}\right]
\end{equation}
donde
\begin{equation}\label{e4_4}
    u_{i}^{m}= mean\left(u_{i}(k)\right) \qquad T_{iz}\leq k\leq T_{fz} \quad 1\leq i\leq r
\end{equation}

Para cada componente $u_{i}^{m}$ se definen tres cualidades o estados posibles, representados como
\textit{funciones de pertenencia} (FP) seg{\'u}n: $fp_{h}^{i}$, $fp_{n}^{i}$ y $fp_{l}^{i}$ generando los
valores ling{\"u}{\'\i}sticos  \textit{alto}, \textit{normal} y \textit{bajo} respectivamente. As{\'\i} el estado
individual de la componente $i$ puede caracterizarse mediante dichos valores ling{\"u}{\'\i}sticos. Las funciones de
pertenencia est{\'a}n representadas mediante funciones trapezoidales (Fig. \ref{f4_3}) caracterizadas mediante
cuatro par{\'a}metros como se muestra en la ec. \ref{e4_5}.
\begin{equation}\label{e4_5}
\begin{array}{rcl}
  fp_{h}^{i}(u_{i}^{m}) & = & trap(u_{i}^{m},b_{i},a_{i},e_{i},e_{i}) \\
  fp_{n}^{i}(u_{i}^{m}) & = & trap(u_{i}^{m},d_{i},c_{i},b_{i},a_{i}) \qquad 1\leq i\leq r\\
  fp_{l}^{i}(u_{i}^{m}) & = & trap(u_{i}^{m},f_{i},f_{i},d_{i},c_{i}) \\
\end{array}
\end{equation}
donde $a_{i}$, $b_{i}$, $c_{i}$, $d_{i}$, $e_{i}$ y $f_{i}$ est{\'a}n directamente relacionados con los l{\'\i}mites
de operaci{\'o}n en funcionamiento normal $[L_{min}^{i},L_{max}^{i}]$ para cada componente $i$ y pueden
considerarse par{\'a}metros de ajuste. Los valores de salida de cada FP ($mf_{j}^{i}(u_{i}^{m})$) es un n{\'u}mero
que se encuentra entre 0 y 1 e indica el grado de pertenencia de $u_{i}^{m}$ a los estados definidos con
$j=l,n,h$. De esta forma el valor ling{\"u}{\'\i}stico $l_{i}$ puede asignarse a cada componente indicando el estado
individual de la misma y depender{\'a} del grado de pertenencia. La FP con mayor grado de pertenencia define el
valor ling{\"u}{\'\i}stico (estado), matem{\'a}ticamente esto puede representarse como:
\begin{equation}\label{e4_6}
l_{i}=\left\{%
\begin{array}{ll}
    low    & ,\text{\textrm{si}}\quad fp_{l}^{i}>fp_{n}^{i}\quad\text{\textrm{y}}\quad fp_{l}^{i}>fp_{h}^{i};\\
    normal & ,\text{\textrm{si}}\quad fp_{n}^{i}>fp_{l}^{i}\quad\text{\textrm{y}}\quad fp_{n}^{i}>fp_{h}^{i};\\
    high   & ,\text{\textrm{si}}\quad fp_{h}^{i}>fp_{n}^{i}\quad\text{\textrm{y}}\quad fp_{h}^{i}>fp_{l}^{i}.\\
\end{array}%
\right. \qquad \text{\textrm{for}}\quad 1\leq i\leq r
\end{equation}

Analizando todas las componentes $r$ de $\mathbf{u}_{FL}^m$ puede obtenerse el estado global del proceso por
medio de los valores ling{\"u}{\'\i}sticos que cada componente adquiere individualmente. Este conjunto define un
patr{\'o}n (huella) para cada evento anormal que ocurre en la planta y se denomina \textit{regla} del SLD. Para
una falla/evento particular del tipo $p$ su regla asociada esta definida por
$\mathbf{R}_{p}=\left[l_1^p,l_2^p,\cdots,l_r^p\right]$, donde $l_i^p$ est{\'a}n dados por la ec. \ref{e4_6}.

As{\'\i}, analizando la base de datos del proceso bajo comportamiento anormal fuera de l{\'\i}nea pueden obtenerse las
reglas del SLD. Este procedimiento es denominado \textit{extracci{\'o}n autom{\'a}tica de reglas} y una o mas reglas
pueden obtenerse para cada tipo de evento particular. Estas reglas ser{\'a}n utilizadas para clasificaci{\'o}n en
l{\'\i}nea y ser{\'a}n almacenadas en una matriz de reglas del tipo
$\mathbf{R}_{matrix}=[\mathbf{R}_1,\mathbf{R}_2,\cdots,\mathbf{R}_p]^T$ con $p$ la cantidad de
eventos/fallas diferentes que pueden ocurrir en el proceso.

En el monitoreo en l{\'\i}nea del proceso, cuando una falla es detectada por el subsistema de ACPA, las
contribuciones a los estad{\'\i}sticos se analizan mediante el subsistema de l{\'o}gica difusa y se computa
$\mathbf{u}_{FL}^m$. Las salidas del SLD $\mathbf{y}_{FL}=[y_1,y_2,\cdots,y_p]$ son la posibilidad de
ocurrencia de los estados/fallas $[1,2,\ldots,p]$. Esta posibilidad es un n{\'u}mero escalar entre cero y uno
que representa el llamado \textit{soporte de la regla} en la teor{\'\i}a de SLD. Valores cercanos a cero indican
una baja posibilidad de que la regla correspondiente sea verdadera, en otras palabras, la falla/evento
correspondiente presenta baja posibilidad de que ocurra. Valores cercanos a uno indican la situaci{\'o}n
opuesta. Cada componente de la salida del SLD es calculada mediante el procedimiento de defuzificaci{\'o}n
evaluando el correspondiente soporte de la regla de la matriz de reglas.
\begin{equation}\label{e4_7}
    y_i = mean\left[\mathbf{R}_i(\mathbf{u}_{FL}^m)\right] =
          mean\left[mf_{j}^{1,i}(u_1^m),mf_{j}^{2,i}(u_2^m),\cdots,mf_{j}^{r,i}(u_r^m)\right]
\end{equation}
con $i=1,\cdots,p$ los tipos de fallas/eventos, $r$ las componentes de $\mathbf{u}_{FL}^m$ y $j=l,n,h$ las
correspondiente FP en concordancia con los valores ling{\"u}{\'\i}sticos representados en la matriz de reglas. De
esta forma la falla/evento presente en el proceso es aislada analizando las componentes de $\mathbf{y}_{FL}$
con mayor soporte.

\subsection{Estimaci{\'o}n de la falla: M{\'e}todo RNA}\label{sec_sddef_ann}
Finalmente otro subsistema se desarrolla basado en RNA para estimar la magnitud de las fallas. La idea
b{\'a}sica para alcanzar este prop{\'o}sito radica en utilizar la informaci{\'o}n generada por el subsistema ACPA
respecto de las modificaciones del proceso y estimar la magnitud de inter{\'e}s. De esta forma el lazo puede
cerrarse integrando el SDDEF con la estrategia de control existente en el proceso y convertirla en tolerante
a fallos. El subsistema ACPA provee informaci{\'o}n respecto de las desviaciones sufridas por el proceso
respecto de los valores medios y de varianza de las variables cuando alg{\'u}n evento/falla ocurre.

En esta tesis se utilizar{\'a} la estrategia de RNA para la estimaci{\'o}n de fallas en sensores y actuadores
caracterizado por un bias abrupto y un retardo extra respectivamente. Con el objeto de realizar una correcta
compensaci{\'o}n de las fallas una estimaci{\'o}n precisa de estas cantidades es crucial. Detalles espec{\'\i}ficos
respecto de la estructura y entrenamiento de las RNA puede encontrarse en la secci{\'o}n \ref{sec_ANN}.

Un problema adicional es el de encontrar las variables del proceso que mas relacionadas est{\'a}n con el tipo de
falla que permitan la estimaci{\'o}n de su magnitud. En un lazo de control descentralizado una falla en el
sensor presenta un efecto similar a un rechazo de perturbaci{\'o}n de salida. As{\'\i}, la variable mas
representativa de la magnitud de la falla resulta ser la correspondiente VM en este caso. En el caso de
control multivariable puede ocurrir que mas de una VM exista para la misma VC. En este caso el mapeo puede
hacerse igualmente eligiendo la variable mas representativa. En el caso de fallas en actuadores/v{\'a}lvulas del
tipo retardo extra el efecto producido como ya se ha visto es el de inestabilizar el lazo de control,
generando oscilaciones en la VC y en la VM correspondiente. Analizando entonces la base de datos del proceso
en funcionamiento anormal pueden realizarse las siguientes vinculaciones
\begin{description}
    \item[Fallas en sensores:] Produce una modificaci{\'o}n del punto operativo real del proceso. Puede relacionarse
    con las modificaciones en el valor medio de las VM's. Adem{\'a}s, esta informaci{\'o}n se encuentra disponible
    del subsistema ACPA, $\mathbf{b}(k)$.
    \item[Fallas en actuadores:] La inestabilidad producida en los lazos de control por este tipo de fallas puede
    relacionarse directamente con las variaciones en la varianza de las VC's del proceso. Esta informaci{\'o}n
    nuevamente se encuentra disponible del subsistema ACPA, $\mathbf{s}(k)$.
\end{description}

De esta forma quedan definidos los mapeos a realizar para estimar la magnitud de las fallas. Para el caso de
fallas en sensores se propone vincular \emph{``variaci{\'o}n en la media de $VM_i$ -- offset del sensor de la
$VC_j$''} donde $VM_i$ es la VM mas representativa del offset introducido por el sensor de la $VC_j$. As{\'\i},
la estimaci{\'o}n del offset se realiza seg{\'u}n la ec. \ref{e4_8}.
\begin{equation}\label{e4_8}
\hat{o}_{ff}^{{VC}_j}(k)={RNA}_{p}\left(\mathbf{b}_{{VM}_i}(k)\right)
\end{equation}
donde $\hat{o}_{ff}^{VC_j}(k)$ es el offset estimado presente en el sensor de la $VC_j$, $RNA_{p}$ es la RNA
encargada de realizar la estimaci{\'o}n y $\mathbf{b}_{VM_i}(k)$ es el valor medio de la VM $i$ otorgado por el
subsistema ACPA en su proceso de readaptaci{\'o}n.
% Figure-------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\includegraphics[width=11cm,height=14cm]{Ch4/SDDEF}\caption{Estructura general del SDDEF}
\label{f4_4}
\end{figure}
%--------------------------------------------------------------------------------

De forma similar puede vincularse \emph{``variaci{\'o}n en la varianza de $VC_i$ -- retardo en el actuador de la
$VM_j$''}, donde $VC_i$ es la VC mas representativa del retardo introducido por el actuador de la $VM_j$.
As{\'\i}, la estimaci{\'o}n del retardo puede efectuarse seg{\'u}n la ec. \ref{e4_9}.
\begin{equation}\label{e4_9}
\hat{t}_d^{{VM}_j}(k)={RNA}_{p}\left(\mathbf{s}_{{VC}_i}(k)\right)
\end{equation}
donde $\hat{t}_d^{VM_j}(k)$ es el retardo estimado presente en el actuador de la $VM_j$, $RNA_{p}$ es la RNA
encargada de realizar la estimaci{\'o}n y $\mathbf{s}_{VC_i}(k)$ es el valor de la varianza de la VC $i$
otorgado por el subsistema ACPA en su proceso de readaptaci{\'o}n.

El proceso de entrenamiento de las RNA's es realizado utilizando las versiones normalizadas de las variables
del proceso. La metodolog{\'\i}a de mapeo propuesta aqu{\'\i} permite manipular tanto relaciones lineales como
fuertemente no lineales con solo unos poco puntos de la base de datos.

El formato general del SDDEF puede observarse en la Fig. \ref{f4_4}, presentando la interconexi{\'o}n entre las
herramientas vistas anteriormente. El algoritmo comienza con una etapa de inicializaci{\'o}n de las variables y
matrices espec{\'\i}ficas. El paso siguiente involucra la adquisici{\'o}n de nuevos datos desde el proceso para ser
evaluados. Utilizando estos nuevos datos se calculan los estad{\'\i}sticos mediante la estrategia ACPA propuesta
completando el monitoreo en l{\'\i}nea. En el caso de comportamiento normal los estad{\'\i}sticos permanecen bajo los
niveles de confianza y el algoritmo retorna a la etapa de adquisici{\'o}n de nuevos datos. Si un evento anormal
ocurre el estad{\'\i}stico combinado $z(k)$ exceder{\'a} su l{\'\i}mite de confianza produciendo alertas de peligro y
eventualmente alertas de falla. En este caso se almacena el tiempo de detecci{\'o}n $T_d$ y el comportamiento
anormal del proceso en la matriz auxiliar $\mathbf{X}_{aux}$. Cuando la zona de an{\'a}lisis es habilitada
($k=T_d+T_{fz}$) se activa el SLD poni{\'e}ndose en ejecuci{\'o}n el procesamiento y an{\'a}lisis de la contribuci{\'o}n a
los estad{\'\i}sticos ($\mathbf{t}(k)$ o $\Delta\mathbf{x}(k)$) en el rango $[T_d+T_{iz},T_d+T_{fz}]$. El estado
del proceso se obtiene, como se comento anteriormente, mediante t{\'e}cnicas de SLD y extracci{\'o}n autom{\'a}tica de
reglas. Las salidas del SLD muestra la falla mas probable presente en el proceso utilizando el m{\'e}todo de
soporte de las reglas. Los subsistemas siguientes permiten la estimaci{\'o}n de la magnitud de las fallas. El
subsistema que maneja el tipo de falla permite seleccionar la RNA adecuada y su correspondiente variable de
entrada ($\mathbf{b}(k)$ o $\mathbf{s}(k)$) para realizar la estimaci{\'o}n. Las magnitudes de las fallas
estimadas se utilizar{\'a}n sobre los algoritmos de control para convertirlos en tolerante a fallas. Toda la
informaci{\'o}n relevante que pueda ayudar en la toma de decisiones y el monitoreo se presenta en l{\'\i}nea para su
an{\'a}lisis.

Existen diferentes estrategias de dise{\~n}o de SDDEF h{\'\i}bridos en la literatura. En \cite{Rc:01} se propone
todo un abordaje basado en estad{\'\i}sticos multivariados para efectuar tareas de monitoreo sobre proceso
biol{\'o}gicos como una planta de tratamiento de aguas residuales (PTAR). Por otro lado, \cite{Rd:01} propone
realizar la detecci{\'o}n y clasificaci{\'o}n de fallas utilizando herramientas tales como TWD y RNA. Trabajos como
\cite{LrMmHd:05,GxZqGz:04} integran las funcionalidades de TWD y el ACP din{\'a}mico y cl{\'a}sico respectivamente.
Otros autores proponen la interconexi{\'o}n de herramientas tales como sistemas expertos, RNA, discrimiantes de
Fisher, reconstrucci{\'o}n v{\'\i}a estad{\'\i}sticos combinados y ACP pesado exponencialmente
\citep{VvRrDs:03,WjLc:08,HqWjQs:04,YhQs:01,LsMeMaGp:03}. Independientemente de la estrategia utilizada la
mayor{\'\i}a de estos trabajos y otros existentes en la literatura no abordan el caso de procesos con
condiciones de operaci{\'o}n cambiante. En este escenario, la cl{\'a}sica estructura de ACP pierde validez y es
necesario realizar un banco de modelos (estad{\'\i}sticos o cuantitativos) para considerar todos los puntos
operativos posibles (no pr{\'a}ctico). Adem{\'a}s, pr{\'a}cticamente ninguno trata el caso de fallas secuenciales,
perturbaciones, rangos de variaci{\'o}n continua de las fallas, integraci{\'o}n futura al CTF automatizado, {\'\i}ndices
de confiabilidad de las clasificaciones y una correcta conexi{\'o}n con el usuario en lo que respecta a
cantidad y calidad de la informaci{\'o}n.

\section{{\'I}ndices de rendimiento}\label{sec_indexes}
En esta secci{\'o}n se desarrollan {\'\i}ndices que permiten la evaluaci{\'o}n  tanto del SDDEF como del sistema
resultante de CTF de forma adecuada.

El subsistema ACPA esta encargado de realizar las tareas propias del monitoreo. En este caso una de las
variables de mayor importancia es el tiempo de detecci{\'o}n de la falla, $T_d$, respecto a el instante de
ocurrencia de la misma, $T_f$. Una r{\'a}pida detecci{\'o}n permitir{\'a} una r{\'a}pida compensaci{\'o}n generando mejores
niveles de seguridad en la operaci{\'o}n de la planta. De esta forma el subsistema ACPA puede evaluarse respecto
de su velocidad de detecci{\'o}n. La diferencia $\Delta T=T_d-T_f$, representa el retardo en la detecci{\'o}n y
puede compararse con la din{\'a}mica mas lenta presente en el proceso, $T_{sd}$. De esta forma el retardo en la
detecci{\'o}n es evaluado como un porcentaje del tiempo m{\'a}ximo para alcanzar el estado estacionario, resultando
en el {\'\i}ndice que se observa en la ec. \ref{e4_10}, llamado \textit{porcentaje del tiempo de detecci{\'o}n}
($PTD$).
\begin{equation}\label{e4_10}
PTD = \frac{T_d-T_f}{T_{sd}}100\%
\end{equation}

El subsistema de LD desarrolla la clasificaci{\'o}n de la falla utilizando parte de la informaci{\'o}n generada por
el ACPA. En este caso las variables de mayor importancia est{\'a}n relacionadas con la calidad (confianza) de la
clasificaci{\'o}n y el grado de robustez, es decir los valores alcanzados por el vector de soporte de las
reglas. El {\'\i}ndice desarrollado aqu{\'\i}, llamado \textit{porcentaje de soporte de la regla} ($PSR$) mide la
relaci{\'o}n entre el soporte promedio de las reglas que han sido descartadas en la clasificaci{\'o}n, respecto del
soporte de la regla seleccionada como mas probable. Esto indica el grado de precisi{\'o}n del procedimiento a
priori. Caracter{\'\i}stica que resulta de vital importancia en un SDDEF y que transfiere confianza a las
personas encargadas del proceso. Considerando la salida del SLD $\mathbf{y}_{FL}=[y_1,y_2,\ldots,y_p]$
conteniendo los soportes individuales de las $p$ reglas, un valor de $y_i$ cercano a la unidad indica alta
posibilidad de ocurrencia de la falla espec{\'\i}fica $i$ y un valor cercano a cero indica la situaci{\'o}n
contraria. Suponiendo que el SLF realiza una clasificaci{\'o}n $y_j$ cuando la falla $j$ ocurre entonces el
{\'\i}ndice $PSR$ viene dado por
\begin{equation}\label{e4_11}
PSR_j = \frac{\left(y_j-\frac{1}{(p-1)}\sum_{i=1,i\neq j}^{p}y_i\right)}{y_j}100\%
\end{equation}
la contribuci{\'o}n media de las reglas que quedaron fuera de la clasificaci{\'o}n, $\sum_{i=1,i\neq
j}^{p}y_i/(p-1)$ es evaluada respecto del soporte de la clasificaci{\'o}n realizada, $y_j$ en forma de
porcentaje. Valores de $PSR_j$ mayores que cero indican buenas propiedades de aislamiento de las fallas, la
falla correcta no puede ser confundida con otras reglas. Por otro lado, valores cercanos a cero indican una
alta posibilidad de realizar una clasificaci{\'o}n err{\'o}nea, poco robusto. Y finalmente un valor de $RSP_j$
negativo indica claramente un error en a clasificaci{\'o}n.

La estimaci{\'o}n de la magnitud de la falla esta realizada por el subsistema de RNA. En este caso el {\'\i}ndice mas
importante esta relacionado con el error presente en la estimaci{\'o}n. Es decir, el \textit{error cuadr{\'a}tico
medio de predicci{\'o}n} (ECMP) para la estimaci{\'o}n de la magnitud de la falla $j$ viene dado por la ec.
\ref{e4_12}.
\begin{equation}\label{e4_12}
ECMP_j = \frac{1}{N}\sum_{k=1}^{N}\left(\hat{q}_j(k)-q_j(k)\right)^2
\end{equation}
donde $q_j(k)$ es la magnitud real de la falla $j$, $\hat{q}_{j}(k)$ la estimaci{\'o}n realizada por el
subsistema RNA, y $N$ la muestras utilizadas para computar el error.

Finalmente es necesario contar con alg{\'u}n tipo de {\'\i}ndice que permita evaluar el rendimiento del sistema CTF
en su conjunto, respecto de una estructura de control cl{\'a}sica. En este caso se utiliza el \textit{porcentaje
de mejora del error} ($PME$) basado en la \textit{integral del error absoluto} ($IEA$) y expresado como
muestra la ec. \ref{e4_13} (\cite{CjDf:04a,CjDf:04b}).
\begin{equation}\label{e4_13}
PME_j = \frac{IEA_j^{conv}-IEA_j^{ctf}}{IEA_j^{conv}}100\%
\end{equation}
donde $PME_j$ corresponde a la mejora del error para el caso de la falla $j$ presente, $IEA_j^{conv}$ es el
rendimiento para la variable de inter{\'e}s (lazo individual) cuando se utiliza un estrategia convencional de
control (sin SDDEF), y $IEA_j^{ctf}$ es el mismo {\'\i}ndice evaluado con una estrategia integrada de CTF (con
SDDEF). El {\'\i}ndice $IEA$ resulta
\begin{equation}\label{e4_14}
IEA_j^i = \sum_{k=1}^{N}\left|sp_r(k)-y^{mr}_i(k)\right|
\end{equation}
siendo $sp_r(k)$ la trayectoria de referencia para la variable de salida $r$, $y^{mr}_i(k)$ es la variable
medida del proceso correspondiente al lazo $r$ y a la estrategia de control $i=conv,ctf$, y $IEA_j^i$ indica
el error ocurrido cuando se encuentra presente una falla tipo $j$ y la estrategia de control $i$. Un valor
positivo de $PME$ significa que la nueva estrategia de control mejora el rendimiento respecto de la
convencional. Valores pr{\'o}ximos a cero indican que no existe mejora significativa y  que ambas estrategias
pueden considerarse semejantes en cuanto a $IEA$.

Adem{\'a}s de los indices de rendimiento desarrollados aqu{\'\i}, cada proceso particular puede incorporar una serie
de requerimientos que deben ser cumplidos y comprobados respecto del correcto funcionamiento de la planta en
si misma. {\'I}ndices relacionados con costos de operaci{\'o}n, calidad final de los productos, {\'\i}ndices de
contaminaci{\'o}n, etc. pueden ser algunos de los mas importantes a la hora de definir una estrategia de control
sobre otra.

%\section{Caso de aplicaci{\'o}n N\textordmasculine 1: RTAC con camisa}

\section{Caso de aplicaci{\'o}n N\textordmasculine 1: Planta de tratamiento de aguas residuales (PTAR)}
En la literatura algunos trabajos solo se han focalizado en sistemas de monitoreo para PTAR. En
\cite{LcCsLi:04} se presenta una sistema de reconstrucci{\'o}n de mediciones sujetas a fallas y ruidosas. En
este caso no se ha considerado la ocurrencia simult{\'a}nea de ruido y offset, ni fallas secuenciales. El
sistema de identificaci{\'o}n de fallas esta construido en base a ACPD. Adem{\'a}s, incorpora herramientas como
optimizaci{\'o}n iterativa para la reconstrucci{\'o}n de la falla y un {\'\i}ndice de validez del sensor. En
\cite{YcVpLi:06} se propone un sistema de monitoreo construido por herramientas estad{\'\i}sticas (ACP) y de
l{\'o}gica difusa integrada con clustering (Fuzzy-c-means y adaptive Fuzzy-c-means). Otra aplicaci{\'o}n de SE es
propuesta por \cite{PaReLj:02}, donde un sistema basado en el conocimiento y reglas $Si-Entonces$ se aplica
sobre una PTAR. As{\'\i}, son generadas las acciones de informaci{\'o}n y avisos. Tambi{\'e}n existen algunas
aplicaciones sobre la PTAR de control supervisor. Tal es el caso del trabajo propuesto por \cite{EmBbAm:06}
donde se propone una cascada de controladores del tipo PI y una estrategia de conmutaci{\'o}n para un proceso
de lodos activos, con la finalidad de controlar el nivel de aireaci{\'o}n. En este caso no se han considerado
fallas ni aspectos de monitoreo y mucho menos CTF. Por otro lado, un m{\'e}todo para caracterizar sensores es
propuesto por \cite{RlTtGwSh:05}. La metodolog{\'\i}a esta basada en regresi{\'o}n lineal y comprobaciones
estad{\'\i}sticas para validar la informaci{\'o}n suministrada por los sensores.

En esta secci{\'o}n se presenta el ajuste y aplicaci{\'o}n de la estrategia SDDEF/CTF propuesta anteriormente sobre
la PTAR. En este caso se han considerado fallas en sensores del tipo offset y en actuadores del tipo
retardo extra. Adem{\'a}s, se ha realizado un completo conjunto de simulaciones comprobando el correcto
funcionamiento de la metodolog{\'\i}a propuesta ante fallas simples, secuenciales perturbaciones, mediciones
ruidosas y actualizaciones de la pol{\'\i}tica de control. Parte de los resultados mostrados aqu{\'\i} se resumen en
el trabajo \cite{ZdBm:08c}.

El proceso presentado aqu{\'\i} es el resultado de estrategias de dise{\~n}o de planta de tratamiento de aguas
residuales (PTAR) desarrollados por \cite{Cj:01}. La planta ha sido desarrollada bajo diferentes entornos de
programaci{\'o}n con la finalidad de convertirse en una planta patr{\'o}n (benchmark) donde puedan ser probados
diferentes estrategias de control v{\'\i}a simulaci{\'o}n. Esta incluye un completo dise{\~n}o de la estructura del
proceso, par{\'a}metros espec{\'\i}ficos del modelo y un conjunto de perturbaciones mas comunes para el desarrollo de
estrategias de control. Adem{\'a}s incluye un completo conjunto de {\'\i}ndices de rendimiento que pueden utilizarse
para analizar el funcionamiento del proceso y de los lazos de control.

El modelo completo esta basado en dos modelos de procesos internacionalmente aceptados como, el modelo de
lodos activados no. 1 (ASM1) con 13 variables de estados y 8 unidades de proceso, como modelo del proceso
biol{\'o}gico, y una funci{\'o}n de sedimentaci{\'o}n de velocidad doble exponencial, la cual esta basada en conceptos
de flujos solidos, como el modelo del proceso de sedimentaci{\'o}n. Para asegurar una aplicaci{\'o}n consistente
del modelo como prueba patr{\'o}n, se han identificado y definido todos los par{\'a}metros estequiom{\'e}tricos y
cin{\'e}ticos.

Ambos modelos interconectados dan como resultado un complejo proceso biol{\'o}gico que debe ser controlado bajo
condiciones de perturbaci{\'o}n permanente. En este caso particular han sido utilizadas las condiciones de
perturbaci{\'o}n denominadas de \textit{tiempo seco} que representan las condiciones diurnas normales de
variaci{\'o}n del flujo y concentraci{\'o}n de ox{\'\i}geno disuelto (COD) en el influente. El correcto monitoreo y
control del proceso resulta esencial debido a que posibles eventos anormales resultar{\'\i}an en inadmisibles
acciones de control y excursiones de los {\'\i}ndices de rendimiento por rangos no permitidos.

Un proceso de lodos activados pretende alcanzar una suficientemente baja concentraci{\'o}n de materia
biodegradable en el efluente con m{\'\i}nima producci{\'o}n de barro y m{\'\i}nimos costos. Esto es alcanzado {\'u}nicamente
controlando el proceso. El proceso consiste de cinco tanques biol{\'o}gicos ($R_i$, $i=1\ldots 5$) en serie con
un sedimentador no reactivo secundario ($S$). Los reactores $R_1$ y $R_2$ son tanques an{\'o}xicos y
perfectamente mezclados, mientras que los {\'u}ltimos tres tanques $R_3$, $R_4$ y $R_5$ son aireados. Existen
dos reciclos internos en el proceso, el reciclo de nitr{\'o}geno desde el quinto reactor hacia el primer tanque
y el reciclo de barros desde el flujo de salida del sedimentador hacia la entrada de la planta. Como en el
sedimentador no se llevan a cabo reacciones biol{\'o}gicas la concentraci{\'o}n de ox{\'\i}geno en el reciclo es la misma
que la del quinto tanque. El desperdicio es bombeado de forma continua desde el flujo inferior del
sedimentador. La estructura completa del proceso y la estrategia de control se muestran en la Fig.
\ref{f4_5}.
% Figure---------------------------------------------------------
\begin{figure}[t]
\centering
\includegraphics[width=12cm,height=4.5cm]{Ch4/WWTP}
\caption{PTAR y estrategia de control descentralizada} \label{f4_5}
\end{figure}
%----------------------------------------------------------------

Los atributos f{\'\i}sicos de los elementos del proceso, los flujos nominales y los coeficientes de aireaci{\'o}n se
muestran en la Tabla \ref{t4_1}.
%---------------------------------------------------------------------------
\begin{table}[t]
  \centering
  \caption{Elementos del proceso y variables en la PTAR}\label{t4_1}
  \rmfamily
  \begin{tabular}{lll}
    \addlinespace[0.3cm]
    \toprule[0.1em]
    Elementos                   & Valores & Unidades \\
    \midrule[0.08em]
    Volumen - Tanques 1, 2      & 1000   & $m^3$ \\
    Volumen - Tanques 3, 4, 5   & 1333   & $m^3$ \\
    {\'A}rea - sedimentador         & 1500   & $m^2$ \\
    Volumen - sedimentador       & 6000   & $m^3$ \\
    \midrule[0.08em]
    Variables                   &        &         \\
    \midrule[0.08em]
    Flujo del influente         & 18446  & $m^3/d$\\
    Flujo del reciclo           & 18446  & $m^3/d$\\
    Flujo del reciclo interno   & 55338  & $m^3/d$\\
    Flujo del desperdicio       & 385    & $m^3/d$\\
    $K_{L}a$ - 3, 4             & 10     & $1/hr$ \\
    $K_{L}a$ - 5                & 3.5    & $1/hr$ \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%------------------------------------------------------------

La estrategia de control descentralizada se encuentra implementada por medio de dos lazos, el primero
involucra el nivel de ox{\'\i}geno disuelto ($OD$) como VC en el quinto reactor, utilizando un controlador del
tipo PI que manipula el coeficiente de aireaci{\'o}n $K_{L}a5$ en dicho tanque. El segundo lazo, lleva a cabo el
control de nivel de nitr{\'o}geno ($N$) en el segundo tanque por medio de un controlador tipo PI y la
manipulaci{\'o}n del flujo del reciclo interno $Q_{intr}$. En el primer lazo se supone sensor de $OD$ ideal y
para el segundo una medici{\'o}n ruidosa y retardada del nivel de nitr{\'o}geno. En ambos casos este es su
comportamiento normal, es decir, sin considerar fallas. El ajuste inicial de los controladores y las
variables del proceso se pueden observar en la Tabla \ref{t4_2}.

En este caso se propone dos tipos de fallas en cuatro elementos del proceso, para mas detalles ver secci{\'o}n
\ref{sec_fallas}:
\begin{description}
    \item[Fallas en sensores:] Los sensores de $OD$ and $N$ est{\'a}n sujetos a posibles fallas caracterizadas
    por un offset abrupto que genera errores en la medici{\'o}n.
    \item[Fallas en actuadores:] Tanto el actuador $K_{L}a5$ como el $Q_{intr}$ pueden sufrir de
    comportamientos anormales adicionando retardos de acci{\'o}n en las VM's.
\end{description}

Los retardos temporales existen frecuentemente en la pr{\'a}ctica inducidos por transporte sobre grandes
distancias, comunicaciones o fallas mec{\'a}nicas en v{\'a}lvulas. Esto afecta fuertemente la estabilidad de los
lazos de control deteriorando el rendimiento. As{\'\i} el dise{\~n}o de sistemas de CTF representan una herramienta
sumamente importante para abordar este tipo de escenarios. No existen demasiados trabajos en la literatura
que traten este problema de manera eficiente y en l{\'\i}nea
(\cite{GwMgZmLyLy:05,JcZd:05,BsLl:03,JmBmZd:06,ZdBmJmCa:06,ZdBmJmCa:07}). Este tipo de fallas presentan un
desaf{\'\i}o real en la tareas de DDEF. Bloqueos en v{\'a}lvulas es otro tipo de falla habitual, si bien es una
versi{\'o}n extrema puede abordarse correctamente \citep{ZdBm:07}. Una reconfiguraci{\'o}n y redise{\~n}o del
controlador es esencial para garantizar caracter{\'\i}sticas de tolerancia a fallos. La reconfiguraci{\'o}n de la
pol{\'\i}tica de control puede realizarse en l{\'\i}nea o predefinirse fuera de l{\'\i}nea y conmutar en el momento
oportuno.

Otro tipo de fallas propuesto aqu{\'\i} refiere a posibles offset abruptos que tienen lugar en los sensores. Bajo
funcionamiento a lazo cerrado este tipo de fallas no son tan f{\'a}ciles de detectar y estimar debido al efecto
de rechazo de perturbaciones de los controladores.
%------------------------------------------------------------------------------------------------------
\begin{table}[t]
  \centering
  \caption{Ajuste de los controladores}\label{t4_2}
  \rmfamily\small
  \begin{tabular}{lll}
    \addlinespace[0.3cm]
    \toprule[0.1em]
    Variables                        & Lazo 1                         & Lazo 2            \\
    \midrule[0.08em]
    Tipo de controlador              & PI continuo con AW              & PI continuo con AW         \\
    Variable controlada (VC)         & $OD$     $[g/m^3]$              & $S_{NO}$    $[g N/m^3]$       \\
    Variable manipulada (VM)         & $K_La5$  $[1/hr]$               & $Q_{intr}$  $[m^3/d]$         \\
    Punto de trabajo                 & $2$      $[g/m^3]$              & $1$         $[g N/m^3]$       \\
    \midrule[0.08em]
    Par{\'a}metros                       &                                 &                            \\
    \midrule[0.08em]
    Ganancia proporcional ($K$)      & $500$    $[1/d/(g (-COD)/m^3)]$ & $15000$     $[m3/d/(g N/m^3)]$\\
    Const. de tiempo integral ($T_i$)& $0.001$  $[d]$                  & $0.05$      $[d]$          \\
    Const. de tiempo AW ($T_t$)      & $0.0002$ $[d]$                  & $0.03$      $[d]$          \\
    Saturaciones VM $[min,max]$      & $[0,10]$ $[1/hr]$               & $[0,92230]$ $[m^3/d]$         \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------------

Una descripci{\'o}n completa de diferentes tipos de fallas en casos reales puede encontrarse en el sitio web del
consorcio de manejo de situaciones anormales \cite{ASM}. Aqu{\'\i} puede encontrarse un presentaci{\'o}n detallada
respecto de diferentes tipos de eventos anormales, fuentes potenciales, soluciones, etc., para aplicaciones
en procesos qu{\'\i}micos reales.

\subsection{Ajustes de SDDEF}
%----------------------------------------------------------------
\begin{table}[t]
  \centering
  \caption{Par{\'a}metros del SDDEF}\label{t4_3}
  \rmfamily\small
  \begin{tabular}{lll}
   \addlinespace[0.3cm]
   \toprule[0.1em]
    ACPA                      &  SLD                                             & RNA                     \\
   \midrule[0.08em]
    $T_{s}=1/96$ [d{\'\i}as]       & $[b_i,c_i]=[L^{i}_{min}+0.1,L^{i}_{max}-0.1]$    & $\hat{t}_d^{VM1}$: 2UO, 1US   \\
    $A(0)=4$                  & $[a_i,d_i]=[L^{i}_{min}-0.1,L^{i}_{max}+0.1]$    & $\hat{t}_d^{VM2}$: 3UO, 1US  \\
    $N_{w}=1345$ [muestras]   & $[b^*_i,c^*_i]=[sat_{i}^{-}+0.1,sat_{i}^{+}-0.1]$& $\hat{o}_{ff}^{VC1}$ 2UO, 1US        \\
    $N_{aux}=100$ [muestras]  & $[a^*_i,d^*_i]=[sat_{i}^{-}-0.1,sat_{i}^{+}+0.1]$& $\hat{o}_{ff}^{VC2}$ 4UO, 1US         \\
    $\delta_{pva}=98$ [\%]    & $e_i=[-1000,1000]$                               & UO: tangente hiperb{\'o}lica \\
    $\delta_z=2$              & $[T_{iz},T_{fz}]=[45,80]$ [muestras]             & US: lineal\\
    $\nu=3$ (99 \%)           & $r=8$                                            & AE: Levenberg-Marquardt\\
    $N_a=3$                   &                                                  & \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%----------------------------------------------------------------

El monitoreo y detecci{\'o}n de fallas es realizado mediante el algoritmo presentado en la secci{\'o}n
\label{sec_sddef_apca}. Aqu{\'\i} las variables analizadas son el coeficiente de aireaci{\'o}n $K_La5$, el flujo de
reciclo interno $Q_{intr}$, las mediciones de nivel de nitr{\'o}geno en los reactores 1 y 5, $N_1$, $N_5$
respectivamente y los errores de seguimiento de los puntos operativos para ambos lazos de control
$e_{o5}=r_{o5}-OD$ y $e_{n2}=r_{n2}-N$, donde $r_{o5}$ representa la trayectoria de referencia para el lazo
de nivel de ox{\'\i}geno del reactor 5, $OD$ es la medici{\'o}n de dicho nivel en ese reactor, $r_{n2}$ es la
referencia para el lazo que controla en nivel de nitr{\'o}geno en el reactor 2 y $N$ la medici{\'o}n de dicho nivel.
Los par{\'a}metros mas importantes que se utilizaron en el ajuste del SDDEF se pueden apreciar en la primer
columna de la Tabla \ref{t4_3}. En este caso el algoritmo de la Fig. \ref{f4_1} es ejecutado en su totalidad
incluidos los puntos 9 y 10 que permiten la actualizaci{\'o}n del modelo $\mathbf{P}$ y el computo de los nuevos
componentes principales $A(k)$ retenidos. Debido a que la cantidad de componentes principales puede
modificarse a lo largo del funcionamiento del proceso la contribuci{\'o}n a los estad{\'\i}sticos utilizada en el
procedimiento de clasificaci{\'o}n son los $\Delta
\overline{\mathbf{x}}(k)=\widetilde{\mathbf{C}}\overline{\mathbf{x}}^{T}(k)$ ya que los
$\mathbf{t}(k)=\mathbf{P}^{T}\overline{\mathbf{x}}^{T}(k)$ poseen una dimensi{\'o}n variable.

La matriz de reglas resultante del procedimiento de extracci{\'o}n autom{\'a}tica de reglas (\ref{sec_sddef_fl})
puede observarse en la Fig. \ref{f4_6}. Aqu{\'\i} claramente se observa como en algunos casos las VM saturan
debido a la influencia de las fallas. La subdivisi{\'o}n de la matriz de reglas se realiza de la siguiente
manera: las primeras dos reglas $\mathbf{R}_1$ y $\mathbf{R}_2$ corresponden a fallas ocurridas en el sensor
de ox{\'\i}geno ($F_1$) en el reactor 5, la tercer regla $\mathbf{R}_3$ corresponde a el caso de fallas en el
sensor de nitr{\'o}geno en el reactor 2 ($F_2$), las reglas $\mathbf{R}_4$ y $\mathbf{R}_5$ corresponden a
fallas en el actuador $K_{L}a5$ ($F_3$) y la regla $R_6$ para el actuador $Q_{intr}$ ($F_4$)
respectivamente. Estas reglas definen un estado general del proceso definido como \textit{bajo control}, es
decir, las magnitudes de las fallas son tales que a{\'u}n permiten operar la planta sin saturaciones de larga
duraci{\'o}n en las VM's y recuperar el control. Las reglas $\mathbf{R}_7$ a $\mathbf{R}_10$ definen un estado
del proceso en el cual las magnitudes de las fallas en sensores son lo suficientemente grandes como para
provocar la saturaci{\'o}n definitiva de las VM's y por ello la \textit{p{\'e}rdida de control}. Las reglas
$\mathbf{R}_7$ y $\mathbf{R}_8$ hacen referencia a fallas tipo $F_1$ con offset positivos y negativos
respectivamente. De igual forma las reglas $\mathbf{R}_9$ y $\mathbf{R}_10$ definen fallas tipo $F_2$. Los
par{\'a}metros mas representativos del SLD se pueden encontrar en la segunda columna de la Tabla \ref{t4_3}.
% Figure---------------------------------------------------------
\begin{figure}[t]
\centering
\includegraphics[width=10cm,height=8cm]{Ch4/matrix_rules_wwtp}
\caption{Matriz de reglas en PTAR} \label{f4_6}
\end{figure}
%----------------------------------------------------------------

Las funciones de pertenencia como puede observarse de la Fig. \ref{f4_6} est{\'a}n diferenciadas seg{\'u}n los
componentes que se analicen. Es decir, cuando se analiza la contribuci{\'o}n al estad{\'\i}stico $Q$ ($\Delta
\overline{\mathbf{x}}(k)$) claramente existen definidos tres posibles estados individuales para cada
componente $i$, bajo, normal y alto, representados por la FP's $fp^i_b$, $fp^i_n$ y $fp^i_a$ respectivamente
y sus par{\'a}metros de dise{\~n}o $a_i$, $b_i$, $c_i$, $d_i$ y $e_i$. En el caso de que se analicen las VM's
aparecen adem{\'a}s dos estados adicionales los cuales representan \textit{saturaci{\'o}n a m{\'\i}nimo} y
\textit{saturaci{\'o}n a m{\'a}ximo}. Estas FP's poseen los valores ling{\"u}{\'\i}sticos $fp^i_{sat-}$  y $fp^i_{sat+}$
respectivamente y sus par{\'a}metros de dise{\~n}o son $a^*_i$, $b^*_i$, $c^*_i$, $d^*_i$. Todos los ajustes est{\'a}n
realizados seg{\'u}n la base de datos en funcionamiento normal del proceso de donde se puede extraer
$L^{i}_{min}$ y $L^{i}_{max}$, y por medio de las limitaciones f{\'\i}sicas en los actuadores se puede dise{\~n}ar
$sat_i^-$ y $sat_i^+$. De esta forma el SLD posee dos componentes que analizan las variables en paralelo,
por un lado la componente que clasifica el estado de la contribuci{\'o}n a los estad{\'\i}sticos y por otro la
componente que permite definir el estado de las VM's.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Estimaci{\'o}n $\hat{t}_d^{VM1}$
]{\includegraphics[width=7cm,height=7cm]{Ch4/ann_wwtp_1}\label{f4_7a}} \subfigure[Estimaci{\'o}n
$\hat{t}_d^{VM2}$]{\includegraphics[width=7cm,height=7cm]{Ch4/ann_wwtp_2}\label{f4_7b}}
\subfigure[Estimaci{\'o}n
$\hat{o}_{ff}^{VC1}$]{\includegraphics[width=7cm,height=7cm]{Ch4/ann_wwtp_3}\label{f4_7c}}
\subfigure[Estimaci{\'o}n
$\hat{o}_{ff}^{VC2}$]{\includegraphics[width=7cm,height=7cm]{Ch4/ann_wwtp_4}\label{f4_7d}} \caption{RNA para
la PTAR} \label{f4_7}
\end{figure}
%-------------------------------------------------------------------------------------------------------

Final mente en la tercer columna de la Tabla \ref{t4_3} se resumen los par{\'a}metros de las RNA's utilizados en
su entrenamiento. Para cada tipo de falla se entrena una RNA con sus correspondientes unidades de capa
oculta (UO) y unidades de salida (US). Recordando el mapeo propuesto en las ecs. \ref{e4_8} y \ref{e4_9} en
este caso resulta:
\begin{equation}\label{e4_15}
\hat{o}_{ff}^{VC1}(k)={RNA}_{1}\left(\mathbf{b}_{VM1}(k)\right),\quad
\hat{o}_{ff}^{VC2}(k)={RNA}_{2}\left(\mathbf{b}_{VM2}(k)\right)
\end{equation}
para la estiamci{\'o}n del offset presente en los sensores, siendo, $\hat{o}_{ff}^{VCi}(k)$ dicha estimaci{\'o}n y
$i=OD,N$ y $\mathbf{b}_{VMj}(k)$ las modificaciones del valor medio en las VM $j$, con $j=K_La5,Q_{intr}$
respectivamente. El mapeo para la estimaci{\'o}n del retardo resulta de forma similar
\begin{equation}\label{e4_16}
\hat{t}_d^{VM1}(k)={RNA}_{3}\left(\mathbf{s}_{VC1}(k)\right), \quad
\hat{t}_d^{VM2}(k)={RNA}_{4}\left(\mathbf{s}_{VC2}(k)\right)
\end{equation}
siendo en este caso $\hat{t}_d^{VMi}(k)$ el retardo estimado presente en el actuador $i=K_La5,Q_{intr}$ y
$\mathbf{s}_{VCj}(k)$ las modificaciones en el valor de la varianza de la VC en cuesti{\'o}n, con $j=OD,N$
respectivamente.

El mapeo realizado por las $RNA_1$ a $RNA_4$ puede observarse en la Fig. \ref{f4_7}. En cada caso el
entrenamiento se ha realizado utilizando solo unos pocos puntos experimentales ($\blacksquare$), obteniendo
un buen grado de generalizaci{\'o}n (l{\'\i}nea a trazos). En todos los casos se utilizaron neuronas del tipo
tangente hiperb{\'o}lica en capa oculta y del tipo lineal para las unidades de salida. EL algoritmo de
entrenamiento seleccionado fue el de  Levenberg-Marquardt del toolbox de Matlab (\cite{neural:02})

En el caso de que el SLD detecte saturaci{\'o}n en la VM debido a fallas en sensores el proceso de estimaci{\'o}n
del offset se convierte en mas simple. La saturaci{\'o}n en la VM produce que el proceso trabaje a lazo abierto
y la VC se desplace hacia otro punto operativo alej{\'a}ndose de su trayectoria de referencia. Este alejamiento
se asume proporcional a la magnitud de la falla y no es necesario realizar su estimaci{\'o}n mediante RNA's. En
este caso la estimaci{\'o}n del offset se realiza mediante las expresiones de la ec. \ref{e4_17}.
\begin{equation}\label{e4_17}
    \hat{o}_{ff}^{VCi}(k)=\left\{\begin{array}{l}
      -\max\left(sp_{i}(k)-VC_{i}(k)\right)\quad \text{\textrm{si,} }MV_{j}(k)\geq MV_{j}^{max} \\
      -\min\left(sp_{i}(k)-VC_{i}(k)\right)\quad \text{\textrm{si,} }MV_{j}(k)\leq MV_{j}^{min} \\
    \end{array}\right.
\end{equation}
donde $sp_{i}(k)$ es la trayectoria de referencia para el lazo $i$, V$C_{i}(k)$ es la medici{\'o}n de la VC del
lazo $i$, $MV_{i}(k)$ es la VM correspondiente al lazo de control $i$, $MV_{j}^{max}$ and $MV_{j}^{min}$ son
los l{\'\i}mites m{\'a}ximo y m{\'\i}nimo para las VM's, con $i=OD,N$ y $j=K_{L}a5,Q_{intr}$ respectivamente.

En la Fig. \ref{f4_8} se puede apreciar el esquema general del SDDEF para este caso. La idea general esta
basada en la estructura mostrada en la Fig. \ref{f4_4}. En este caso solo peque{\~n}as modificaciones se
incorporaron para tener en cuenta aspectos particulares de este tipo de proceso. Una diferencia clara es el
bloque de manejo de saturaciones conmutando entre las redes y el algoritmo de la ec. \ref{e4_12} para
realizar la estimaci{\'o}n. Luego la estructura realiza las mismas tareas definidas en la secci{\'o}n
\ref{sec_sddef}.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\includegraphics[width=10cm,height=13cm]{Ch4/sddef_wwtp} \caption{Estructura del SDDEF para la
PTAR} \label{f4_8}
\end{figure}
%-------------------------------------------------------------------------------------------------------

\subsection{Integraci{\'o}n al CTF}
Un aspecto no menos importante es como utilizar la informaci{\'o}n generada por el SDDEF de forma tal de poder
compensar el efecto introducido por los diferentes tipos de fallas. De esta forma la integraci{\'o}n entre el
SDDEF y la estrategia de control existente es una tarea fundamental para lograr convertir la pol{\'\i}tica de
control en una que sea tolerante a fallos. En este caso particular el proceso posee una estrategia de
control descentralizada conteniendo dos lazos de control y controladores del tipo PI.

En secciones anteriores (secci{\'o}n \ref{sec_CPA_apli}) se pudo observar que para la compensaci{\'o}n de fallas en
sensores el CAP tenia un tratamiento similar a actualizar la trayectoria de referencia de forma proporcional
utilizando el offset estimado. Basado en dichas ideas se puede sugerir una integraci{\'o}n para este tipo de
fallas y una estrategia descentralizada como se muestra en la Fig. \ref{e4_13}. En este caso se propone una
integraci{\'o}n via actualizaci{\'o}n de la trayectoria de referencia original $sp_{i}^0(k)$ utilizando la
estimaci{\'o}n del offset dado por el SDDEF $\hat{o}^{VCi}_{ff}(k)$.
\begin{equation}\label{e4_18}
    sp_{i}(k)=sp_{i}^{0}(k)+\hat{o}^{VCi}_{ff}(k) \quad \text{con} \quad i=OD,N
\end{equation}
donde $sp_{i}(k)$ es la referencia actual (actualizada).

Por otro lado, se vio en la secci{\'o}n \ref{sec_CPA_apli} que para el caso de fallas en actuadores (retardos
extras en el lazo de control) una forma de compensaci{\'o}n efectiva era la actualizaci{\'o}n de los par{\'a}metros del
controlador teniendo en cuenta el retardo estimado. En dicho caso la estrategia de control era predictiva
adaptiva y una forma de incorporar esta informaci{\'o}n del retardo es mediante la actualizaci{\'o}n del modelo
interno del proceso mas una actualizaci{\'o}n del inicio del horizonte de predicci{\'o}n $H_w$ que ajusta las
dimensiones del controlador (ver secci{\'o}n \ref{sec_FIR}).

En el caso de controladores PI descentralizados la estrategia de compensaci{\'o}n de modifica un poco ya que no
existe $H_w$ y no hay un modelo adaptivo. Una forma efectiva para realizar dicha compensaci{\'o}n es realizar un
ajuste de los par{\'a}metros del PI en l{\'\i}nea utilizando la teor{\'\i}a de control basado en modelo interno (CBMI)
propuesto por \cite{Rd:07,Rd:86} (ver ap{\'e}ndice en la secci{\'o}n \ref{A_5}). Teniendo la estimaci{\'o}n del tiempo
muerto entregada por SDDEF $\hat{t}_d^{VMi}(k)$ la selecci{\'o}n de la constante de tiempo del filtro puede
realizarse considerando la condici{\'o}n $\tau_{f}>\hat{t}_d^{VMi}(k)$, entonces
\begin{equation}\label{e4_19}
\begin{split}
    \tau_{f}^{i}(k)&=\eta \hat{t}_d^{VMi}(k)\mu\\
    \end{split}
\end{equation}
donde $\mu$ es un par{\'a}metro de conversi{\'o}n de unidades (minutos a d{\'\i}as),  $\eta$ es un par{\'a}metro de dise{\~n}o
para considerar el criterio de robustez $\tau_{f}>\hat{t}_d^{VMi}(k)$ y $i=K_La5,Q_{intr}$. Mediante esta
actualizaci{\'o}n del tiempo de respuesta del filtro el redise{\~n}o de los controladores puede llevarse a cabo
mediante la ec. \ref{ea_28}.

Los par{\'a}metros iniciales de los CBMI para este caso se muestran en la Tabla \ref{t4_4}. En ella se pueden
distinguir los ajustes iniciales de los modelos internos para cada lazo de control ($\tau_{m}$, $k_{m}$ y
$\tau_{f}$), as{\'\i} como tambi{\'e}n el ajuste de los par{\'a}metros de dise{\~n}o para la reconfiguraci{\'o}n de los
controladores ($\mu$ y $\eta$).
\begin{table}[t]
  \centering
  \caption{Ajuste inicial del CBMI}\label{t4_4}
  \rmfamily\small
  \begin{tabular}{lccccc}
   \addlinespace[0.3cm]
   \toprule[0.1em]
    Lazo de control& $\tau_{m}$& $k_{m}$            & $\tau_{f}$ & $mu$   & $\eta$\\
    \midrule[0.08em]
    OD             & $0.001$  & $0.004$             & $0.001/2$  & 1/1440 & 5 \\
    N              & $0.05$   & $1.33\times 10^{-4}$& $0.05/2$   & 1/1440 & 5  \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}

\subsection{Resultados}
En esta secci{\'o}n se resume un completo conjunto de simulaciones considerando los diferentes tipos de fallas
comentados anteriormente. La implementaci{\'o}n de la estrategia del SDDEF se realiza en un algoritmo que recibe
los datos del proceso en cada instante de muestreo, $T_{s}=1/96$ d{\'\i}as. El modelo del PTAR se asume
funcionado con una perturbaci{\'o}n del tipo \textit{clima seco} y se analiza un per{\'\i}odo de simulaci{\'o}n de dos
semanas.

La primera simulaci{\'o}n mostrada en la Fig. \ref{f4_9} considera una falla en el sensor de OD (falla tipo 1)
donde aparece un offset abrupto de $1$ $g/m^3$ en $T_{f}=3$ d{\'\i}as. En la Fig. \ref{f4_9a} se presentan las
evoluciones de la VC medida cuando la estrategia de control existente se integra o no con el SDDEF, as{\'\i} como
tambi{\'e}n la actualizaci{\'o}n de la trayectoria de referencia. En la Fig. \ref{f4_9b} se puede observar como la
actualizaci{\'o}n de dicha referencia permite retornar la VC real a las proximidades del punto operativo normal
(OD: $2$ $g/m^3$). La VM del lazo en cuesti{\'o}n puede apreciarse en la Fig. \ref{f4_9c} donde se compara con
el funcionamiento normal. La informaci{\'o}n otorgada por el SDDEF respecto del tipo de falla, grado de soporte
de la regla y estimaci{\'o}n del offset presente puede observarse en la Fig. \ref{f4_9e}, esta informaci{\'o}n
permite integrar eficientemente la pol{\'\i}tica de reconfiguraci{\'o}n y permitir dejar el sistema listo para
posibles nuevas detecciones, como muestra el estad{\'\i}stico combinado de la Fig. \ref{f4_9d}. En la Fig.
\ref{f4_9f} se resume la contribuci{\'o}n media de las variables analizadas por el SLD en este tipo de falla.
Para este tipo de falla los tiempos involucrados en la detecci{\'o}n, clasificaci{\'o}n y reconfiguraci{\'o}n de la
falla son, $T_d=3,4791$ d{\'\i}as y $T_c\sim T_r=4,5104$ d{\'\i}as respectivamente.

El rendimiento del SDDEF y el comportamiento del sistema integrado en un CTF ser{\'a}n analizados de forma
detallada mas adelante cuando de se definan los {\'\i}ndices adecuados.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $OD$]{\includegraphics[width=7cm,height=5cm]{Ch4/f1}\label{f4_9a}}
\subfigure[Variable real - $OD$]{\includegraphics[width=7cm,height=5cm]{Ch4/f2}\label{f4_9b}} \subfigure[VM
- $K_La5$]{\includegraphics[width=7cm,height=5cm]{Ch4/f3}\label{f4_9c}} \subfigure[Estad{\'\i}stico
$z(k)$]{\includegraphics[width=7cm,height=5cm]{Ch4/f4}\label{f4_9d}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=5cm]{Ch4/f5}\label{f4_9e}} \subfigure[Contribuci{\'o}n media
$\mathbf{u}_{FL}^m$]{\includegraphics[width=7cm,height=5cm]{Ch4/f6}\label{f4_9f}} \caption{Falla tipo 1
(offset en el sensor de $OD$) - $o_{ff}=1$ $g/m^3$} \label{f4_9}
\end{figure}
%-------------------------------------------------------------------------------------------------------

La segunda simulaci{\'o}n muestran el efecto de la misma falla analizada anteriormente pero en este caso su
magnitud ($o_{ff}=4$ $g/m^3$) es tal que produce la saturaci{\'o}n de su MV y su eventual p{\'e}rdida de control
causando problemas serios en el proceso. Las Figs. \ref{f4_10a} y \ref{f4_10b} resumen el comportamiento de
la VC medida y real respectivamente, en ambos casos se puede observar claramente como la integraci{\'o}n del
SDDEF permite retornar la variable de inter{\'e}s a las proximidades del punto de trabajo y recuperar el
control del lazo (Fig. \ref{f4_10c}). Las Figs. \ref{f4_10d}, \ref{f4_10e} y \ref{f4_10f} muestran la
evoluci{\'o}n del estad{\'\i}stico combinado $z(k)$, las salidas del SDDEF (soporte de la regla, tipo de falla y
estimaci{\'o}n del offset) y la contribuci{\'o}n media de las variables analizadas. Para este tipo de falla los
tiempos involucrados en la detecci{\'o}n, clasificaci{\'o}n y reconfiguraci{\'o}n de la falla son, $T_f\sim T_d=3$ d{\'\i}as
y $T_c\sim T_r=4,0521$ d{\'\i}as respectivamente. Puede verse claramente en este caso como esta estrategia de
integraci{\'o}n permite resolver el problema de saturaciones debido a fallas de magnitud considerable de manera
eficiente.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $OD$]{\includegraphics[width=7cm,height=5cm]{Ch4/f7}\label{f4_10a}}
\subfigure[Variable real - $OD$]{\includegraphics[width=7cm,height=5cm]{Ch4/f8}\label{f4_10b}} \subfigure[VM
- $K_La5$]{\includegraphics[width=7cm,height=5cm]{Ch4/f9}\label{f4_10c}} \subfigure[Estad{\'\i}stico
$z(k)$]{\includegraphics[width=7cm,height=5cm]{Ch4/f10}\label{f4_10d}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=5cm]{Ch4/f11}\label{f4_10e}} \subfigure[Contribuci{\'o}n media
$\mathbf{u}_{FL}^m$]{\includegraphics[width=7cm,height=5cm]{Ch4/f12}\label{f4_10f}} \caption{Falla tipo 1
(offset en el sensor de $OD$ - saturaci{\'o}n) - $o_{ff}=4$ $g/m^3$} \label{f4_10}
\end{figure}
%-------------------------------------------------------------------------------------------------------

En la Fig. \ref{f4_11} se resume las simulaciones resultantes de operar el sistema con y sin integraci{\'o}n con
el SDDEF cuando ocurre una falla en el sensor de nitr{\'o}geno. En este caso el offset aparece en $T_f=3$ d{\'\i}as y
posee una magnitud de $-1$ $gN/m^3$. La VC medida y sus correspondientes actualizaciones de la pol{\'\i}tica de
referencia se pueden apreciar en la Fig. \ref{f4_11a}. Dicha compensaci{\'o}n utilizando el SDDEF permite operar
el proceso en funcionamiento normal a{\'u}n cuando la falla existe en el sensor (Figs. \ref{f4_11b} y
\ref{f4_11c}). Las salidas del SDDEF en este caso pueden observarse en la Fig. \ref{f4_11e}, claramente se
observa el soporte de la regla clasificada, el tipo de falla y la estimaci{\'o}n del offset presente en el
sensor. Los tiempos en este caso resultan $T_{f}\sim T_{d}=3$ d{\'\i}as y $T_c=T_{r}=4,0521$ d{\'\i}as para el
instante de detecci{\'o}n, clasificaci{\'o}n y compensaci{\'o}n de la falla respectivamente.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $N$]{\includegraphics[width=7cm,height=5cm]{Ch4/f13}\label{f4_11a}}
\subfigure[Variable real - $N$]{\includegraphics[width=7cm,height=5cm]{Ch4/f14}\label{f4_11b}} \subfigure[VM
- $Q_{intr}$]{\includegraphics[width=7cm,height=5cm]{Ch4/f15}\label{f4_11c}} \subfigure[Estad{\'\i}stico
$z(k)$]{\includegraphics[width=7cm,height=5cm]{Ch4/f16}\label{f4_11d}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=5cm]{Ch4/f17}\label{f4_11e}} \subfigure[Contribuci{\'o}n media
$\mathbf{u}_{FL}^m$]{\includegraphics[width=7cm,height=5cm]{Ch4/f18}\label{f4_11f}} \caption{Falla tipo 2
(offset en el sensor de $N$) - $o_{ff}=-1$ $gN/m^3$} \label{f4_11}
\end{figure}
%-------------------------------------------------------------------------------------------------------

% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $N$]{\includegraphics[width=7cm,height=5cm]{Ch4/f19}\label{f4_12a}}
\subfigure[Variable real - $N$]{\includegraphics[width=7cm,height=5cm]{Ch4/f20}\label{f4_12b}} \subfigure[VM
- $Q_{intr}$]{\includegraphics[width=7cm,height=5cm]{Ch4/f21}\label{f4_12c}} \subfigure[Estad{\'\i}stico
$z(k)$]{\includegraphics[width=7cm,height=5cm]{Ch4/f22}\label{f4_12d}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=5cm]{Ch4/f23}\label{f4_12e}} \subfigure[Contribuci{\'o}n media
$\mathbf{u}_{FL}^m$]{\includegraphics[width=7cm,height=5cm]{Ch4/f24}\label{f4_12f}} \caption{Falla tipo 2
(offset en el sensor de $N$ - saturaci{\'o}n) - $o_{ff}=4$ $gN/m^3$} \label{f4_12}
\end{figure}
%-------------------------------------------------------------------------------------------------------

Otro caso interesante de analizar y donde probar el rendimiento del SDDEF es cuando la falla en el sensor
de nitr{\'o}geno es de tal magnitud que provoca la saturaci{\'o}n de su VM. Esto efectivamente genera el
funcionamiento a lazo abierto y la p{\'e}rdida de control. La Fig. \ref{f4_12} resume este escenario cuando una
falla en el sensor de N ocurre a $T_f=3$ d{\'\i}as con una magnitud de $4$ $gN/m^3$. Claramente en las Figs.
\ref{f4_12a} y \ref{f4_12b} puede observarse como este tipo de falla, en caso de no contar con integraci{\'o}n
del SDDEF, provoca el mal funcionamiento del proceso al no poder seguir la trayectoria de referencia
original ajustada en $1$ $gN/m^3$. Por otro lado, la integraci{\'o}n con el SDDEF efectivamente actualiza la
pol{\'\i}tica de referencia permitiendo retornar la VC real a su punto operativo (o a su cercan{\'\i}a). Esta
compensaci{\'o}n de la falla adem{\'a}s recupera el lazo de control, permitiendo su funcionamiento de forma normal
(Fig. \ref{f4_12c}). La Fig. \ref{f4_12d} resume el comportamiento del estad{\'\i}stico combinado para este caso
y se puede observar como su correcta evoluci{\'o}n deja el sistema completo listo para nuevas posibles
detecciones. Las salidas del SDDEF pueden apreciarse en las Figs. \ref{f4_12e} y \ref{f4_12f}, donde se
presentan el soporte de la regla clasificada, el tipo de falla identificada, el offset estimado y la
contribuci{\'o}n de las variables analizadas de forma respectiva. De forma similar a el caso anterior los
tiempos involucrados son $T_{f}\sim T_{d}=3$ d{\'\i}as y $T_c=T_{r}=4,0521$ d{\'\i}as para el instante de detecci{\'o}n,
clasificaci{\'o}n y compensaci{\'o}n de la falla respectivamente.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $OD$]{\includegraphics[width=7cm,height=5cm]{Ch4/f25}\label{f4_13a}}
\subfigure[VM - $K_La5$]{\includegraphics[width=7cm,height=5cm]{Ch4/f26}\label{f4_13b}}
\subfigure[Estad{\'\i}stico $z(k)$]{\includegraphics[width=7cm,height=5cm]{Ch4/f27}\label{f4_13c}}
\subfigure[Salidas del SDDEF]{\includegraphics[width=7cm,height=5cm]{Ch4/f28}\label{f4_13d}}
\subfigure[Contribuci{\'o}n media
$\mathbf{u}_{FL}^m$]{\includegraphics[width=7cm,height=5cm]{Ch4/f29}\label{f4_13e}} \caption{Falla tipo 3
(retardo en el actuador $K_La5$) - $t_d=0.6$ $min.$} \label{f4_13}
\end{figure}
%-------------------------------------------------------------------------------------------------------

En lo siguiente se pretende evaluar el SDDEF integrado a una pol{\'\i}tica de CTF cuando fallas multiplicativas
(retardos) se producen en los actuadores de aireaci{\'o}n del tanque n{\'u}mero 5 y la v{\'a}lvula de recilo interno. En
ambos casos la falla se caracteriza por un retardo adicional introducido en el lazo de control debido a
malfuncionamiento mec{\'a}nico de la misma.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $N$]{\includegraphics[width=7cm,height=5cm]{Ch4/f30}\label{f4_14a}}
\subfigure[VM - $Q_{intr}$]{\includegraphics[width=7cm,height=5cm]{Ch4/f31}\label{f4_14b}}
\subfigure[Estad{\'\i}stico $z(k)$]{\includegraphics[width=7cm,height=5cm]{Ch4/f32}\label{f4_14c}}
\subfigure[Salidas del SDDEF]{\includegraphics[width=7cm,height=5cm]{Ch4/f33}\label{f4_14d}}
\subfigure[Contribuci{\'o}n media
$\mathbf{u}_{FL}^m$]{\includegraphics[width=7cm,height=5cm]{Ch4/f34}\label{f4_14e}} \caption{Falla tipo 4
(retardo en el actuador $Q_{intr}$) - $t_d=20$ $min.$} \label{f4_14}
\end{figure}
%-------------------------------------------------------------------------------------------------------

Inicialmente, la Fig. \ref{f4_13} resume el caso en que el actuador $K_{L}a5$ posee un mal funcionamiento a
partir del instante $T_f=3$ d{\'\i}as introduciendo en el lazo un retardo adicional de $t_d=0.6$ minutos.
Claramente en la Fig. \ref{f4_13a} se puede observar el efecto producido por este tipo de falla cuando no se
cuenta con una estrategia integrada de SDDEF. A su vez la versi{\'o}n de CTF integrada con el SDDEF realiza el
correcto ajuste del controlador involucrado y mantiene las caracter{\'\i}sticas de estabilidad del lazo. La Fig.
\ref{f4_13b} muestra el comportamiento de la VM en ambos casos (con y sin SDDEF), no contar con una forma de
reconfiguraci{\'o}n ocasiona que dicha VM alcance la saturaci{\'o}n y eventualmente la p{\'e}rdida de rendimiento en el
seguimiento de la referencia. Las Figs. \ref{f4_13c}, \ref{f4_13d} y \ref{f4_13e} muestran la evoluci{\'o}n del
estad{\'\i}stico combinado en este caso, las salidas del SDDEF y  la contribuci{\'o}n de las variables analizadas
respectivamente. EL soporte de la regla clasificada, el tipo de falla identificada as{\'\i} como el retardo
estimado en este caso se puede apreciar en la Fig. \ref{f4_13d}. Los instantes de detecci{\'o}n, clasificaci{\'o}n y
reconfiguraci{\'o}n resultaron respectivamente $T_f\sim T_{d}=3$ d{\'\i}as y $T_c\sim T_{r}=4,0625$ d{\'\i}as.

Finalmente se presenta en la Fig. \ref{f4_14} el caso de falla en la v{\'a}lvula del reciclo interno $Q_{intr}$
generando la introducci{\'o}n de un retardo adicional en el lazo de control del nivel de nitr{\'o}geno, en $T_f=3$
d{\'\i}as de magnitud $t_d=20$ minutos. La Fig. \ref{f4_14a} muestra el efecto de contar con una estrategia de
integraci{\'o}n SDDEF y CTF devolviendo a el lazo las cualidades de estabilidad originales al reconfigurar el
controlador de forma efectiva (utilizando la teor{\'\i}a de CBMI en l{\'\i}nea). Nuevamente en la Fig. \ref{f4_14b} se
puede observar el efecto de saturaci{\'o}n en la VM debido a la falla y el correcto funcionamiento luego de la
compensaci{\'o}n. Debe notarse aqu{\'\i} que el efecto del retardo introducido en este lazo de control, aunque sea de
elevado valor (20 min.), no resulta en un funcionamiento dr{\'a}stico debido al la baja constante de tiempo de
del lazo de nitr{\'o}geno. Por lo contrario, en el caso anterior, el lazo de control de nivel de OD posee una
din{\'a}mica mas elevada ocasionando que cualquier m{\'\i}nimo retardo introducido genere diferencias considerables
en el rendimiento de control. Puede observarse en la Fig. \ref{f4_14c} que el estad{\'\i}stico combinado posee un
funcionamiento fuera del l{\'\i}mite de confianza luego de la etapa de reconfiguraci{\'o}n, esto es esencialmente
generado por una diferencia en la actualizaci{\'o}n en los par{\'a}metros de escalado. Es decir, ser{\'\i}a de gran
utilidad contar con una etapa de actualizaci{\'o}n de los par{\'a}metros del modelo ACPA ($\mathbf{b}$,
$\mathbf{s}$, $A$, l{\'\i}mites de confianza, etc.) luego de dicho instante. Esta cuesti{\'o}n sera abordada al final
de esta secci{\'o}n como una tapa de mejora de dicho algoritmo y de constante evoluci{\'o}n. De todas formas, se
puede apreciar la correcta clasificaci{\'o}n de la falla ocurrida, el grado de soporte de la regla identificada
y la adecuada estimaci{\'o}n del retardo introducido por la v{\'a}lvula en la Fig. \ref{f4_14d}. La Fig.
\ref{f4_14e} resume la contribuci{\'o}n media de las variables analizadas por el SLD indicando su aporte a la
detecci{\'o}n y clasificaci{\'o}n.
%-------------------------------------------------------------------------------------------------------
\begin{table}[t]
  \centering
  \caption{{\'I}ndices de funcionamiento del PTAR}\label{t4_5}
  \rmfamily\footnotesize
  \begin{tabular}{llll}
   \addlinespace[0.3cm]
   \toprule[0.13em]
    Casos                         & IEA                            & Energ{\'\i}a   &Violaciones \\
                                  &$[g/m^3]$                       & de bombeo &del efluente \\
                                  &$\times 10^3$                   &$[kWh/d]$  &[\% del tiempo\\
                                  &                                &           & de operaci{\'o}n]\\
    \midrule[0.08em]
    Funcionamiento normal         & lazo OD: 0.005                 & 1488.14   & VN: 18.30                   \\
                                  & lazo N: 0.995                  &           & VA: 17.26                   \\
    \midrule[0.08em]
Falla en el sensor de OD          &                                &           &                                       \\
Offset = 1 $[g/m^3]$              &                                &           &                                       \\
    sin SDDEF                     & lazo OD: 4.705                 & 1687.57   & VN: 13.09, VA: 24.70 \\
    con SDDEF                     & lazo OD: 0.138                 & 1487.24   & VN: 18.00, VA: 16.81 \\
Offset = 4 $[g/m^3]$              &                                &           &                       \\
    Without FTC                   & lazo OD: 9.200                 & 4246.63   & VN: 26.04, VA: 97.76\\
    With FTC                      & lazo OD: 0.005                 & 1496.33   & VN: 18.30, VA: 17.55 \\
  \midrule[0.08em]
Falla en el sensor N              &                                &           &                   \\
Offset = -1 $[gN/m^3]$            &                                &           &                   \\
   sin SDDEF                      & lazo N: 4.780                  & 1844.37   & VN: 12.35, VA: 17.26 \\
   con SDDEF                      & lazo N: 0.950                  & 1486.54   & VN: 18.00, VA: 16.81 \\
Offset = 4 $[gN/m^3]$             &                                &           &                     \\
   sin SDDEF                      & lazo N: 3.915                  & 1753.24   & VN: 96.13, VA: 14.28 \\
   con SDDEF                      & lazo N: 1.365                  & 1555.94   & VN: 15.77, VA: 16.81\\
  \midrule[0.08em]
Falla en el actuador $K_{L}a5$    &                                &           &                   \\
Retardo = 0.6 $[min.]$            &                                &           &                   \\
    sin SDDEF                     & lazo OD: 0.510                 & 1492.00   & VN: 17.85 VA: 16.81 \\
    con SDDEF                     & lazo OD: 0.018                 & 1489.84   & VN: 17.85, VA: 16.81 \\
  \midrule[0.08em]
Falla en el actuador $Q_{intr}$   &                                &           &                   \\
Retardo= 20 $[min.]$              &                                &           &                   \\
    sin SDDEF                     & lazo N: 2.005                  & 1487.97   & VN: 18.89, VA: 17.11\\
    con SDDEF                     & lazo N: 2.005                  & 1364.49   & VN: 23.51, VA: 16.81 \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%------------------------------------------------------------------------------------------------------------

Para este tipo de proceso en particular \cite{Cj:01} ha desarrollado una serie de {\'\i}ndices de rendimiento que
deben ser considerados a la hora de comparar estrategias de control. En la Tabla \ref{t4_5} se resumen los
{\'\i}ndices mas importantes evaluados sobre la ultima semana de operaci{\'o}n simulada.

Un {\'\i}ndice representativo para medir el rendimiento de los controladores es la $IEA$ entre la CV y su
correspondiente trayectoria de referencia. Otro indicador de importancia es la energ{\'\i}a de bombeo que mide el
costo energ{\'e}tico en el bombeo del  flujo del reciclo interno, el flujo de retorno de lodos y el flujo de
desperdicios. Finalmente, se consideran dos {\'\i}ndices representativos de la calidad de operaci{\'o}n del proceso.
Estos proporcionan informaci{\'o}n respecto del porcentaje de tiempo de operaci{\'o}n en que el proceso se encuentra
violando las restricciones del efluente. En este caso se considera:
\begin{enumerate}
    \item La violaci{\'o}n respecto del nivel total de nitr{\'o}geno (VN), cuyo l{\'\i}mite es  $18$ $gN/m^3$.
    \item La violaci{\'o}n respecto del nivel amon{\'\i}aco (VA), cuyo l{\'\i}mite es $4$ $gN/m^3$.
\end{enumerate}

En la parte superior de la Tabla \ref{t4_5} se presenta los {\'\i}ndices representativos para el caso de
funcionamiento normal del proceso sujeto a perturbaciones mas habituales.

En todos los casos de fallas en sensores el {\'\i}ndice $IEA$ resulta menor cuando la estrategia integrada
CTF/SDDEF esta funcionado. El mejoramiento general del $IEA$ es debido a la actualizaci{\'o}n de la pol{\'\i}tica de
referencia realizada por el SDDEF, retornando el proceso lo mas pr{\'o}ximo posible a su punto operativo normal.
En todos los casos la energ{\'\i}a de bombeo resulta menor y aproximadamente igual a el caso normal cuando se
utiliza la estrategia CTF/SDDEF. En particular, es dr{\'a}sticamente inferior para el caso de falla en el sensor
de OD que produce saturaci{\'o}n. Los {\'\i}ndices de violaci{\'o}n en el efluente son verdaderamente sensibles a las
fallas en los sensores. Las fallas en el sensor de OD trae aparejado grandes problemas con las violaciones
de amon{\'\i}aco y el sensor de N con las violaciones del nivel de nitr{\'o}geno.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{{\'I}ndices de rendimiento del SDDEF} \label{t4_6} \centering
  \rmfamily\footnotesize
  \begin{tabular}{llrrrccc}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  Eventos                  &Elemento            & $T_f$ [d.]& $T_d$ [d.] & $PTD$ [\%] & $y_j$   & $PSR_j$ [\%]  & $ECMP_j$             \\
  \midrule[0.08em]
  $F_{1}$(1$[g/m^3]$)      &sensor OD           &  3,00     &  3,48      & 31,94      & 1,00    & 62,50         & $8,64\times 10^{-4}$ \\
  $F_{1}$(4$[g/m^3]$)      &sensor OD           &  3,00     &  3,02      &  1,38      & 1,00    & 70,32         & $4,00\times 10^{-8}$ \\
  $F_{2}$(-1$[gN/m^3]$)    &sensor  N           &  3,00     &  3,02      &  1,38      & 1,00    & 56,25         & $5,63\times 10^{-5}$ \\
  $F_{2}$(4$[gN/m^3]$)     &sensor  N           &  3,00     &  3,02      &  1,38      & 1,00    & 65,62         & $2,46\times 10^{-2}$ \\
  $F_{3}$(0.6$[min.]$)     &actuador  $K_{L}a5$ &  3,00     &  3,03      &  2,08      & 1,00    & 79,68         & $9,36\times 10^{-4}$ \\
  $F_{4}$(20$[min.]$)      &actuador $Q_{intr}$ &  3,00     &  3,09      &  6,25      & 0,87    & 78,57         & $3,10\times 10^{-3}$ \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{{\'I}ndice PME} \label{t4_7} \centering
  \rmfamily\small
  \begin{tabular}{lcccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Eventos           &\multicolumn{2}{c}{$F_1$}&\multicolumn{2}{c}{$F_2$} & $F_3$        & $F_4$ \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){2-3}
  \cmidrule[0.08em](l{0.6em}r{0.6em}){4-5} \cmidrule[0.08em](l{0.6em}r{0.6em}){6-6}
  \cmidrule[0.08em](l{0.6em}r{0.6em}){7-7}
                    & 1 $[g/m^3]$& 4 $[g/m^3]$ &-1 $[gN/m^3]$& 4 $[gN/m^3]$& 0.6 $[min.]$ & 20 $[min.]$\\
  $PME$ [\%]        & 97,06      &  99,94      &  80,06      & 65,10       &  96,38       & -0.21    \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

De acuerdo con los {\'\i}ndices de rendimiento presentados en la secci{\'o}n \ref{sec_indexes} para evaluar el
sistema SDDEF se obtienen los valores resumidos en la Tabla \ref{t4_6}. EL $PTD$ es aproximadamente cero en
todos los casos indicando una r{\'a}pida detecci{\'o}n. En el caso de $F_{1}$(1$[g/m^3]$) que presenta un valor de
$31,94\%$ es debido a que con esta magnitud de la falla es mas dif{\'\i}cil de detectar ya que no produce
saturaci{\'o}n (el proceso a{\'u}n esta bajo control). Ninguno de los {\'\i}ndices $PSR_j$ es menor del $56,25\%$ lo que
indica buena caracter{\'\i}sticas de robustez en la clasificaci{\'o}n. El $ECMP_j$ para cada estimaci{\'o}n de la
magnitud de la falla demuestra ser lo suficientemente preciso. Finalmente en la Tabla \ref{t4_7} se resume
los {\'\i}ndices $PME$ en los diferentes tipos de fallas, presentando un valor mayor que cero y pr{\'o}ximo a 100 en
la mayor{\'\i}a de los casos. Indicando claramente los beneficios de contar con una estrategia CTF/SDDEF. Salvo
para el caso de la falla $F_4$ en el que dicho {\'\i}ndice define que no existen diferencias apreciables entre
estrategias de control.

\subsubsection{Cambiando la pol{\'\i}tica de control}
Los resultados observados en la Fig. \ref{f4_14} pueden no ser satisfactorios en cuanto al rechazo de
perturbaciones obtenido del lazo de nitr{\'o}geno y las posibles falsas alarmas generados por el estad{\'\i}stico
$z$. Esto b{\'a}sicamente es debido a que cuando el SDDEF reconfigura el control PI existente en dicho lazo el
efecto es el de reducir su ganancia proporcional mediante la constante del filtro (ver ap{\'e}ndice \ref{A_5}).
Esto suaviza la respuesta del controlador, brindando estabilidad, pero a su vez lo hace menos efectivo a
bruscas perturbaciones que ingresan al proceso. Una forma de resolver este problema es mediante la
implementaci{\'o}n de un controlador del tipo en avance (ver ap{\'e}ndice \ref{A_6}) para perturbaciones medidas. De
esta forma las acciones de control finales estar{\'a}n compuestas de los aportes del control en avance (CEA) mas
la del control por realimentaci{\'o}n (PI). Esta configuraci{\'o}n permite asegurar la estabilidad del lazo, el
seguimiento correcto de la referencia y  la compensaci{\'o}n a perturbaciones no medidas (PI) y  un correcto
rechazo de perturbaciones medidas (CEA). Si a esta estrategia se la dota de caracter{\'\i}sticas adaptivas
mediante un sistema SDDEF, se obtiene un sistema de CTF activo donde no solo el PI se reajusta en l{\'\i}nea si
no que adem{\'a}s la pol{\'\i}tica de control se actualiza permitiendo la inclusi{\'o}n de un CEA. En este caso el CEA es
del tipo proporcional con ganancia $K_{ff}=-1.36$.

El resultado de esta estrategia se puede observar en la Fig. \ref{f4_15}. Comparando las Figs. \ref{f4_14a}
y \ref{f4_15a} claramente se aprecian los beneficios de esta {\'u}ltima estrategia al presentar menor error de
seguimiento ($IEA=0.149\times 10^3$). Esto es debido a la correcta se{\~n}al de control de la Fig. \ref{f4_15b}
(con una energ{\'\i}a de bombeo de $1482.5727$ $kWh/d$) que comparada con la Fig. \ref{f4_14b} se pueden
apreciar los efectos de las acciones del CEA. Esto retorna el proceso a las proximidades del punto
operativo normal ($VN=17.55\%$, $VA=16.22\%$), quedando plasmado en el estad{\'\i}stico $z$ de la Fig.
\ref{f4_15c}, el cual no presenta falsas alarmas. Las salidas del SDDEF en este caso se resumen en la Fig.
\ref{f4_15d}. Indicando la correcta detecci{\'o}n, clasificaci{\'o}n e identificaci{\'o}n de la falla presente.
% Figure------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering%
\subfigure[Variable medida - $N$]{\includegraphics[width=7cm,height=4cm]{Ch4/f35}\label{f4_15a}}
\subfigure[VM - $Q_{intr}$]{\includegraphics[width=7cm,height=4cm]{Ch4/f36}\label{f4_15b}}
\subfigure[Estad{\'\i}stico $z(k)$]{\includegraphics[width=7cm,height=4cm]{Ch4/f37}\label{f4_15c}}
\subfigure[Salidas del SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/f38}\label{f4_15d}} \caption{Falla
tipo 4 - Con control en avance y control de realimentaci{\'o}n} \label{f4_15}
\end{figure}
%-------------------------------------------------------------------------------------------------------

La estructura final de integraci{\'o}n entre la PTAR y el SDDEF/CTF se puede apreciar en la Fig. \ref{f4_16}. Se
observa las actualizaciones referentes a los par{\'a}metros de control ($PI_1$ y $PI_2$) y las trayectorias de
referencia ($SP_1$ y $SP_2$) en conjunto con la reconfiguraci{\'o}n de la pol{\'\i}tica de control del lazo de
nitr{\'o}geno (CEA, $K_{ff}$).
% Figure--------------------------------------------------------------
\begin{figure}[t]
\centering%
\includegraphics[width=13cm,height=8cm]{Ch4/wwtp_SDDEF}
\caption{Estructura final de interconexi{\'o}n. WWTP/SDDEF} \label{f4_16}
\end{figure}
%---------------------------------------------------------------------

\section{Caso de aplicaci{\'o}n N\textordmasculine 2: Planta de pulpa y papel (PPP)}
En la actualidad solo existe un trabajo \citep{LgTtLjHc:06} que aborda el problema de dise{\~n}o de sistemas de
monitoreo en la PPP. En el se propone un sistema h{\'\i}brido de diagn{\'o}stico de fallas utilizando DGS y MCP
din{\'a}mico para realizar la detecci{\'o}n de posibles fallas en sensores y actuadores. En este trabajo se
consideran offset en sensores, degradaci{\'o}n de la precisi{\'o}n, derivas y bloqueos en v{\'a}lvulas. En este aporte
el sistema no ha sido probando ante falla secuenciales y solo tares de monitoreo son propuestas. No existe
integraci{\'o}n al CTF ni compensaci{\'o}n de fallas. En la literatura no existen reportes de CTF aplicado a este
proceso.

En esta secci{\'o}n se propone el ajuste al SDDEF dise{\~n}ado anteriormente para este proceso en particular y una
completa integraci{\'o}n al CTF para compensaci{\'o}n de fallas. La implementaci{\'o}n del SDDEF/CTF en este proceso a
gran escala es probado ante fallas secuenciales, perturbaciones, mediciones ruidosas, condiciones de
operaci{\'o}n cambiante y diferentes estrategias de control (descentralizada y CPM). Los resultados mostrados
aqu{\'\i} forman parte de las primeras contribuciones de CTF en este tipo de proceso y parte de ellas han sido
recopiladas en trabajos tales como \cite{ZdBm:07,ZdBm:08d}.

Los trabajos desarrollados por \cite{CjDf:04a,CjDf:04b} presentan una completa descripci{\'o}n del problema de
este caso de estudio. El correspondiente c{\'o}digo de simulaci{\'o}n puede obtenerse por medio de su p{\'a}gina web
(\cite{Doylegrouppage}). En \cite{CjDf:04a} se presenta el desarrollo del modelo riguroso de la PPP
(incluyendo l{\'\i}nea de fibra y recupero qu{\'\i}mico) como un caso patr{\'o}n (benchmark) de dise{\~n}o de estrategias de
control, entre otras {\'a}reas.

La estructura de esta planta puede observarse en la Fig. \ref{f4_17} de forma simplificada. El proceso
consiste de dos grandes {\'a}reas, la \textit{l{\'\i}nea de fibra} (LF) y el lazo de \textit{recupero qu{\'\i}mico} (RQ).
El objetivo fundamental en la LF es producir fibra de las astillas de madera a una deseada tasa de
producci{\'o}n y calidad. La mayor parte de la materia prima de esta {\'a}rea son las astillas de madera y los
qu{\'\i}micos denominados licor blanco (LB), consistiendo esencialmente de $NaOH$ y $NaSH$. Estos son combinados
en un tanque de impregnaci{\'o}n presurizado, donde las astillas son saturadas con el LB. De esta forma el
camino del proceso sigue hacia la zona de cocci{\'o}n del digestor , donde la lignina (material que mantiene las
fibras unidas) comienza a disolverse. Siguiendo su flujo hacia abajo los materiales pasan a trav{\'e}s de las
zonas del digestor denominadas mcc y emcc mientras el LB es adicionado y  mas lignina es disuelta. La
variable mas importante a controlar en esta zona es el n{\'u}mero Kappa, el cual es un una medida de la cantidad
remanente de lignina en las fibras. La zona final del digestor es la zona de lavado donde se produce la
limpieza de las fibras y se sacan del digestor. Un lavado adicional se complementa a la salida del digestor,
para remover qu{\'\i}micos y lignina residual. Las fibras siguen su camino hacia las torres de blanqueo, para que
mas lignina sea removida y se logren los est{\'a}ndares de brillo necesarios. La secuencia de blanqueo incluye,
una etapa de postdeslignificaci{\'o}n con un reactor de ox{\'\i}geno ($O$) y LB, las torres de di{\'o}xido de cloro
($D_1$), de hidr{\'o}xido de sodio ($E$) y una de generaci{\'o}n de brillo v{\'\i}a di{\'o}xido de cloro ($D_2$). Al final de
cada etapa de blanqueo la pulpa es lavada para remover qu{\'\i}micos adicionales y lignina. Existen muchos lazos
de reciclo en esta {\'a}rea, incluyendo el efluente del $O$ que es utilizado como licor de lavado en la secci{\'o}n
inmediatamente posterior a el digestor y la zona de emcc. El efluente de $D_2$ es licor de lavado para el
$E$. El flujo de qu{\'\i}micos de salida del digestos y las etapas de blanqueo poseen muchos residuos org{\'a}nicos y
un color marr{\'o}n, que son denominados \textit{licor negro d{\'e}bil} (LND). Para recuperar los componentes
qu{\'\i}micos de estos flujos el LND es enviado a el lazo recupero.

Los principales objetivos en el lazo de RQ son regenerar $NaOH$ y $Na_2S$ del LND. El recupero qu{\'\i}mico
transforma la planta completa en econ{\'o}micamente rentable. Este proceso comienza con una etapa de evaporaci{\'o}n
multi-efecto donde el LND es concentrado para alcanzar un contenido de solidos mayor al 63\%, despu{\'e}s del
cual es considerado licor negro (LN). El LN es enviado a una caldera de recuperaci{\'o}n donde la combusti{\'o}n del
licor org{\'a}nico provee energ{\'\i}a para producir vapor de alta presi{\'o}n y permite las reacciones de reducci{\'o}n para
obtener $Na_2S$ de $Na_2SO_4$, sales basadas en sulfuros y $Na_2CO_3$. El LN se mezcla con agua de lavado
para producir licor verde (LV), el cual mediante reaciones de caustizaci{\'o}n produce LB. Este LB es utilizado
por el digestor y el reactor de ox{\'\i}geno, formando as{\'\i} un gran lazo din{\'a}mico de realimentaci{\'o}n del proceso
global. Los barros de cal obtenidos del clarificador de LB son enviados hacia el horno para recuperar la
cal.

As{\'\i} se obtiene un modelo matem{\'a}tico no lineal de aproximadamente 8200 states con un total de 142 entradas
(82 VM y 60 variables de perturbaci{\'o}n) y 114 salidas (40 de la LF y 74 del lazo de RQ) que conforma un
modelo patr{\'o}n que emula de forma rigurosa el comportamiento real de un planta qu{\'\i}mica compleja.
% Figure--------------------------------------------------------------
\begin{figure}[t]
\centering%
\includegraphics[width=15cm,height=8cm]{Ch4/flowsheet_pulpmill}
\caption{Planta de pulpa y pael} \label{f4_17}
\end{figure}
%---------------------------------------------------------------------

Dentro de las potenciales {\'a}reas de aplicaci{\'o}n de este modelo se encuentran, modelado de procesos, control de
procesos, optimizaci{\'o}n, diagn{\'o}stico de fallas, educaci{\'o}n, etc.

\subsection{Estrategia de control}
La PPP posee muchos reciclos que incrementan la interacci{\'o}n del proceso, as{\'\i} como el tiempo requerido para
alcanzar el estado estacionario. La planta tambi{\'e}n exhibe grandes retardos temporales y no linealidades que
complican el dise{\~n}o de controladores y limitan el rendimiento obtenible mediante controladores de
realimentaci{\'o}n.

Cualquier estrategia de control aplicada a la PPP debe: 1- mantener el las variables del proceso en sus
valores deseados, 2- Mantener las condiciones del proceso dentro de sus respectivas restricciones, 3-
Minimizar la variabilidad de la tasa de producci{\'o}n, el no. Kappa en la torre $E$ y el brillo, 4- minimizar
la utilizaci{\'o}n de astillas de madera, utilidades y qu{\'\i}micos, y 5- rechazar perturbaciones tan r{\'a}pido como
sea posible sin violar ninguna restricci{\'o}n en las variables de calidad.

En los trabajos de \cite{CjDf:04a,CjDf:04b} se presentan dos estrategias de control bien diferentes. Una
descentralizada y una mixta con controladores CPM. Cada estrategia de control esta desarrollada bas{\'a}ndose en
en an{\'a}lisis de la matrix relativa de ganancias (MRG) en estado estacionario. Por un lado, se desarrolla una
estrategia de control descentralizada (solo lazos simples y en cascada) para lograr el control total de la
planta. Es decir tanto las variables primarias (producci{\'o}n, restricciones, calidad, etc.) como secundarias
(nivel, presi{\'o}n, temperatura, etc.) son controladas mediante lazos de control cl{\'a}sicos (P,PI). Por otro
lado, se presenta tambi{\'e}n una estrategia basada en CPM como control supervisor. En particular cuatro CPM son
desarrollados para cubrir las {\'a}reas del digestor/reactor de ox{\'\i}geno, torres de blanqueo, evaporadores y
horno de cal/recaustizadores, las cuales presentan mayores interacciones en la MRG. En general los CPM se
encargan de manipular las trayectorias de referencia de lazos simples de control y controlar directamente
alguna variable de inter{\'e}s. Los beneficios e inconvenientes de una y otra estrategia se encuentran bien
comentados en \cite{CjDf:04b}.

El punto operativo habitual de este proceso se encuentra definido por sus variables principales: tasa de
producci{\'o}n de 630 ton./d{\'\i}a, no. Kappa en $E$ de 2.5 y brillo de 0.81. De todas formas las necesidades del
mercado pueden requerir modificar estos valores, para lo cual la estrategia de control aplicada debe
realizar dichos cambios de la forma mas eficiente posible.

\subsection{Definici{\'o}n de las fallas}
De acuerdo a las fallas definidas en la secci{\'o}n \ref{sec_fallas}, en este caso particular se propone
analizar el caso de fallas en sensores del tipo offset abrupto y bloqueos en actuadores/v{\'a}lvulas. Siendo
estas las mas comunes en este tipo de procesos. La Tabla \ref{t4_8} resume las fallas, los elementos del
proceso involucrados y el rango posible de la magnitud de la falla. Notar que la falla podr{\'\i}a ocurrir con
cualquier valor dentro de dicho rango. La fig. \ref{f4_17} muestra en forma esquem{\'a}tica la PPP y las
locaciones de las posibles fallas.
%---------------------------------------------------------------------------------
\begin{table}[t]
\caption{Fallas propuestas en la PPP} \label{t4_8}
\centering%
  \rmfamily\small
  \begin{tabular}{clcl}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Fallas   &Definici{\'o}n de las variables        & Tipo     & Rango de\\
           &                                   &          & Valores\\
  \midrule[0.08em]
  $F_{1}$  & Sensor de la tasa de producci{\'o}n   & Offset   & $\pm 10$\% \\
  $F_{2}$  & Sensor del no. Kappa del digestor & Offset   & $\pm 12$\%\\
  $F_{3}$  & Sensor de temp. zona de cocci{\'o}n   & Offset   & $\pm 1$\%\\
  $F_{4}$  & Sensor de temp. en la zona mcc    & Offset   & $\pm 1$\%\\
  $F_{5}$  & Sensor de temp. en la zona emcc   & Offset   & $\pm 1.5$\%\\
  $F_{6}$  & Sensor de temp. en $O$            & Offset   & $\pm 1$\%\\
  $F_{7}$  & Sensor de temp. en $D_{1}$        & Offset   & $\pm 1$\%\\
  $F_{8}$  & Sensor de no. Kappa en $E$        & Offset   & $\pm 15$\%\\
  $F_{9}$  & Sensor de temp. en $E$            & Offset   & $\pm 1.5$\%\\
  $F_{10}$ & Sensor de temp. en $D_{2}$        & Offset   & $\pm 2$\%\\
  $F_{11}$ & Sensor de brillo                  & Offset   & $\pm 4$\%\\
  $F_{12}$ & Sensor de presi{\'o}n en $O$          & Offset   & $\pm 45$\%\\
  $F_{13}$ & Actuador del flujo de pulpa       & Bloqueo  & $\pm 10$\%\\
  $F_{14}$ & Actuador del flujo de LV          & Bloqueo  & $\pm 15$\%\\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------

Se pretende entonces analizar el comportamiento del SDDEF propuesto en secciones anteriores en grandes y
complicados procesos qu{\'\i}micos. A su vez se proponen diferentes escenarios de comportamiento de las fallas,
pudiendo ocurrir en forma individual como secuencial. Se adicionan adem{\'a}s posibles perturbaciones y eventos
comunes que pueden influenciar el comportamiento global del proceso. De esta forma se incluye modificaciones
en las trayectorias de referencia de la tasa de producci{\'o}n, no. Kappa de la torre $E$ y brillo, y tres
perturbaciones t{\'\i}picas: modificaciones en la humedad de las astillas de madera, modificaciones en la
concentraci{\'o}n de la lignina-celulosa y modificaciones en la concentraci{\'o}n del qu{\'\i}mico $ClO_2$.

El consorcio de manejo de situaciones anormales (\cite{ASM}\circledR), detalla una completa presentaci{\'o}n
respecto de eventos anormales, potenciales fuentes, impacto, soluciones, etc. para procesos qu{\'\i}micos reales
y aplicaciones concretas.

\subsection{PPP con control descentralizado}
\subsubsection{Ajustes del SDDEF}
En esta secci{\'o}n se presenta el ajuste de los par{\'a}metros del SDDEF y las variables involucradas en su
desarrollo. Inicialmente se muestra en la Tabla \ref{t4_9} las variables utilizadas para construir el
subsistema de ACPA. B{\'a}sicamente se mantiene la misma nomenclatura que la utilizada en los trabajos de
\cite{CjDf:04a,CjDf:04b}.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Variables utilizadas en al ACPA - Control descentralizado} \label{t4_9} \centering
  \footnotesize\rmfamily
  \begin{tabular}{clcl}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  \multicolumn{2}{c}{Variables controladas }                &\multicolumn{2}{c}{Variables manipuladas}        \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){1-2} \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  Variables          & Descripci{\'o}n                          & Variables                 & Descripci{\'o}n \\
  \midrule[0.08em]
  1                  & Tasa de producci{\'o}n del digestor      & 1                         & Flujo de astillas de madera\\
  2                  & Tasa de producci{\'o}n de almacenado     & 2--3                      & Flujo de LB del digestor\\
  5                  & no. Kappa del digestor               & 7--8                      & Flujos de vapor del digestor 4--5\\
  6                  & Producci{\'o}n de pulpa del digestor     & 9                         & Flujo de agua\\
  10                 & Conductividad superior del extracto  & 10--11                    & Fracci{\'o}n de pulpa lavada 1--2\\
  11                 & Conductividad inferior del extracto  & 14                        & Flujo de vapor 1 de $O$\\
  14                 & Temperatura de la zona emcc          & 17                        & Flujo de vapor 3 de $O$\\
  16                 & Temperatura superior del extracto    & 18                        & Flujo de pulpa hacia el lavado\\
  19                 & no. Kappa de $O$                     & 20                        & Flujo de $ClO_2$ en $D_1$ \\
  24                 & [$OH^-$] del lavador en $E$          & 21--22                    & Flujo de vapor y de agua en $E_1$\\
  26                 & Brillo en $D_2$                      & 23                        & Flujo c{\'a}ustico en $E$\\
  33                 & Factor de diluci{\'o}n del lavador no. 7 & 25                        & Flujo de vapor en $E$\\
  34                 & Almacenamiento $V$                   & 26                        & Flujo de $ClO_2$ en $D_2$\\
  35                 & Temperatura del efluente en $O$      & 29                        & Fracci{\'o}n 2 de $O$\\
  38                 & Volumen en $D_2$                     & 30                        & Fracci{\'o}n de $E$\\
  39                 & AE superior del extracto             & 33                        & Fracci{\'o}n de pulpa lavada 5\\
  40                 & AE inferior del extracto             & 36--37                    & Flujo de refrigerante y ox{\'\i}geno en $O$\\
                                                          & & 38                        & Flujo de pulpa blanqueada\\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros del APCA - Control descentralizado} \label{t4_10}
  \centering
  \small\rmfamily
  \begin{tabular}{ccccccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  $N_w$ [muestras] & $N_{aux}$ [muestras] & $\delta_z$ & $\nu$ & $\delta_{pva}$ [\%] & $T_s$ [min.] & N\textordmasculine entradas & $A$ & $N_a$\\
  \midrule[0.08em]
  1800             & 500                  & 2          & 3     & 90                  & 5            & 40                          & 12  & 6\\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{N\textordmasculine de reglas / Tipo de falla - Control descentralizado}\label{t4_11}
  \centering
  \small\rmfamily
  \begin{tabular}{llll}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Fallas                  & Regla      & Fallas                         & Regla     \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){1-2} \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  $F_{1}$ (-/+ offset)    & $1/2$      & $F_{11}$ (-/+ offset)          & $19/20$    \\
  $F_{2}$ (-/+ offset)    & $3/4$      & $F_{12}$ (-/+ offset)          & $21/22$    \\
  $F_{4}$ (-/+ offset)    & $5/6$      & $F_{13}$ (-/+ bloqueo)         & $23/24$    \\
  $F_{5}$ (-/+ offset)    & $7/8$      & $F_{14}$ (-/+ bloqueo)         & $25/26$    \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  $F_{6}$ (-/+ offset)    & $9/10$     & Eventos                        & Regla       \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  $F_{7}$ (-/+ offset)    & $11/12$    & Cambios de referencia          & 27         \\
  $F_{8}$ (-/+ offset)    & $13/14$    & Humedad de las astillas        & 28         \\
  $F_{9}$ (-/+ offset)    & $15/16$    & Concentraci{\'o}n lignina-celulosa & 29         \\
  $F_{10}$ (-/+ offset)   & $17/18$    & Concentraci{\'o}n $ClO_2$          & 30         \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

% Figure------------------------------------------------------------------------------------
\begin{figure}[t]
\centering {\includegraphics[width=9cm,height=8cm]{Ch4/matrix_pi}} \caption{Matriz de reglas - Control
descentralizado} \label{f4_18}
\end{figure}
%-------------------------------------------------------------------------------------------
% Figure-------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[$RNA_3$]{\includegraphics[width=6cm,height=5cm]{Ch4/fig6a}}
\subfigure[$RNA_5$]{\includegraphics[width=6cm,height=5cm]{Ch4/fig6b}} \caption{Generalizaci{\'o}n de las RNA -
Control descentralizado} \label{f4_19}
\end{figure}
%--------------------------------------------------------------

En la Tabla \ref{t4_10} los par{\'a}metros de ajuste del m{\'o}dulo ACPA son presentados. La dimensi{\'o}n de la matriz
de datos normales ($\bar{\mathbf{X}}_n$) resulta entonces de $[N_w\times N\text{\textordmasculine
}entradas]$. Por otro lado la matriz de datos auxiliar ($\mathbf{X}_{aux}$) posee su longitud definida
mediante $N_{aux}$, la cual a su vez esta directamente relacionado con la din{\'a}mica mas lenta del proceso.
As{\'\i}, para procesos con din{\'a}micas r{\'a}pidas la matriz auxiliar podr{\'a} tener una longitud menor que para procesos
con grandes constantes de tiempo. Tanto $N_w$ como $N_{aux}$ indican cantidad de muestras, las cuales han
sido tomadas cada $T_s$ minutos desde el proceso. El l{\'\i}mite de confianza para el estad{\'\i}stico combinado a
sido seleccionado fijo y con un valor de $\delta_z$. Este estad{\'\i}stico es computado mediante el algoritmo
adaptivo utilizando los estad{\'\i}sticos $T^2$ and $Q$, cuyos l{\'\i}mites de confianza son tambi{\'e}n actualizados por
el algoritmo utilizando el criterio de 99\% ($\nu$) de confianza. El proceso de inicializaci{\'o}n del algoritmo
ACPA utiliza una selecci{\'o}n de los componentes principales $A$ basada en $PVA$ con $\delta_{pva}$ como l{\'\i}mite
en el porcentaje de varianza retenida. Finalmente el n{\'u}mero m{\'a}ximo de alertas de peligro consecutivas (antes
de ser considerado un falla) es seleccionado en $N_a$.

La Tabla \ref{t4_11} presenta la cantidad de reglas obtenidas en el proceso de \textit{extracci{\'o}n autom{\'a}tica
de reglas} para cada evento particular. Puede observarse 13 eventos del tipo falla que pueden ocurrir con
direcciones positivas o negativas indistintamente y 4 eventos del tipo perturbaciones. Para cada evento y su
correspondiente magnitud de acci{\'o}n se ha identificado una regla particular, la cual es la huella que dicho
evento produce en el proceso. Se han considerado todas las fallas de la Tabla \ref{t4_8} salvo el caso de
fallas en el sensor de temperatura de la zona de cocci{\'o}n, por no presentar efectos relevantes.

La Fig. \ref{f4_18} resume la \textit{matriz de reglas} para este caso de estudio. Claramente se puede
apreciar la cantidad de reglas, el n{\'u}mero de entradas al SLD y adem{\'a}s las funciones de pertenencia que deben
estar activas para que dicha regla sea verdadera. Esta visi{\'o}n de la matriz de reglas permite de forma f{\'a}cil
e intuitiva informar respecto de como cada falla afecta el proceso, que similitudes poseen entre si y el
grado de impacto.

Los par{\'a}metros de ajuste del SLD se muestran en la Tabla \ref{t4_12}. La extracci{\'o}n autom{\'a}tica de reglas
divide el espacio de los eventos en $p$ reglas, utilizando para ello una dimensi{\'o}n $r$ del vector de
entrada. El an{\'a}lisis de la base de datos normal del proceso proporciona los l{\'\i}mites $[L_{min}^i,L_{max}^i]$
para cada variable $i=1,2,\ldots,r$. Las funciones de pertenencia quedan definidas mediante los par{\'a}metros
$a_i$, $b_i$, $c_i$, $d_i$, $e_i$ y $f_i$. Otro par{\'a}metro importante en este subsistema es la zona de
an{\'a}lisis $[T_{iz},T_{fz}]$. As{\'\i}, las entradas al SLD son computadas como contribuci{\'o}n media en dicha zona y
el estado global del proceso derivado en l{\'\i}nea.

Finalmente el subsistema de estimaci{\'o}n de la magnitud de la falla en sensores mediante RNA es ajustado seg{\'u}n
el mapeo propuesto en la Tabla \ref{t4_13}. En ella se muestra las RNA involucrada en cada estimaci{\'o}n, la
entrada correspondiente a cada RNA y la salida correspondiente. Es decir, la RNA definida como $RNA_1$, por
ejemplo, realiza la estimaci{\'o}n del offset presente en el sensor de la $VC_1$, $\hat{o}_{ff}^{{VC}_1}(k)$,
utilizando las variaciones del valor medio en la $VM_1$, $\mathbf{b}_{{VM}_1}(k)$. En la Tabla \ref{t4_14}
se resumen los ajustes referentes al entrenamiento de las RNA y su topolog{\'\i}a. Se han utilizado funciones de
activaci{\'o}n del tipo tangente hiperb{\'o}lica en las unidades de capa oculta y lineales en las unidades de
salida. El algoritmo de entrenamiento es del tipo Levenberg-Marquardt supervisado. La Fig. \ref{f4_19}
muestra por ejemplo los resultados del entrenamiento en dos redes neuronales particulares y su grado de
generalizaci{\'o}n respecto a datos nuevos.

\begin{landscape}
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros de SLD - Control descentralizado} \label{t4_12}
  \centering
  \small\rmfamily
  \begin{tabular}{ccccccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Reglas, $p$ & $r$ & $a_i$           & $b_i$           & $c_i$           & $d_i$           & $e_i$         & $f_i$         & $[T_{iz},T_{fz}]$[muestras]\\
  \midrule[0.08em]
  30         & 52  & $L_{max}^i-0.5$ & $L_{max}^i+0.5$ & $L_{min}^i+0.5$ & $L_{min}^i-0.5$ & $1\times10^5$& $-1\times10^5$ & $[0,90]$\\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Mapeo propuesto por las RNA - Control descentralizado} \label{t4_13}
  \centering
  \small\rmfamily
  \begin{tabular}{llllllllllll}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  RNA                          &$RNA_1$&$RNA_2$&$RNA_3$ & $RNA_4$& $RNA_5$& $RNA_6$& $RNA_7$& $RNA_8$& $RNA_9$&$RNA_{10}$ & $RNA_{11}$\\
  Offset del sensor de         & $VC1$ & $VC5$ & $VC13$ & $VC14$ & $VC20$ & $VC21$ & $VC22$ & $VC23$ & $VC25$ & $VC26$    & $VC37$ \\
  Variaciones de la media en   & $VM1$ & $VM2$ & $VM7$  & $VM8$  & $VM14$ & $VM17$ & $VM20$ & $VM22$ & $VM25$ & $VM26$    & $VM37$ \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros de las RNA - Control descentralizado} \label{t4_14}
  \centering
  \small\rmfamily
  \begin{tabular}{ccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Capa oculta          & Capa de salida & Entrenamiento       & Unidades ocultas                & Unidades de salida  \\
  \midrule[0.08em]
  Tangente hiperb{\'o}lica & Lineal         & Levenberg-Marquardt & $RNA_{1-4,6-11}=1$, $RNA_{5}=2$ & $RNA_{1-11}=1$ \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------
\end{landscape}

\subsubsection{Integraci{\'o}n al CTF}
En el caso de fallas en sensores del tipo offset abrupto la estrategia de integraci{\'o}n al CTF resulta igual a
la mostrada para el caso de PTAR. Las estimaciones del offset generadas por el SDDEF son utilizadas en este
caso para actualizar la pol{\'\i}tica de referencia en l{\'\i}nea. Recordando entonces
\begin{equation}
    sp_{i}(k)=sp_{i}^{0}(k)+\hat{o}^{VCi}_{ff}(k)
\end{equation}
donde $sp_{i}(k)$ es la referencia actualizada, $sp_{i}^{0}(k)$ la referencia original, y
$\hat{o}^{VCi}_{ff}(k)$ la estimaci{\'o}n del offset, para la VC $i$.

En el caso de fallas en v{\'a}lvulas del tipo bloqueo la estrategia de compensaci{\'o}n e integraci{\'o}n al CTF es
diferente a la presentada en el caso de PTAR. Aqu{\'\i}, se propone compensar y asegurar el correcto
funcionamiento del proceso en una zona segura de funcionamiento utilizando lazos adicionales de control. En
este caso se han considerado como posibles elementos del proceso sujetos a falla la v{\'a}lvula que comanda el
flujo de pulpa hacia las torres de blanqueo, $F_{12}$ y la v{\'a}lvula que manipula el flujo de LV hacia el
apagador de cal, $F_{13}$. Estos son flujos importantes del proceso, por un lado el primero pr{\'a}cticamente
define la tasa de producci{\'o}n de pulpa blanqueada y el segundo define la tasa de recupero de LB para
reutilizaci{\'o}n. Cuando un bloqueo se produce en alguna de estas v{\'a}lvulas y ninguna acci{\'o}n de compensaci{\'o}n
existe sobre el proceso se produce la salida de funcionamiento de la planta completa, debido esencialmente a
violaciones en los l{\'\i}mites de operaci{\'o}n del digestor por una manipulaci{\'o}n dr{\'a}stica del flujo de astillas de
madera.

Una alternativa para evitar la salida de funcionamiento del proceso, evitar peligros y p{\'e}rdidas econ{\'o}micas
es activar un lazo adicional de control en estos casos, que pueda conducir la planta a una zona de operaci{\'o}n
segura, aunque el rendimiento sea menor. La estructura de estos lazos de control de emergencia se muestra en
la Fig. \ref{f4_20}.
% Figure---------------------------------------------
\begin{figure}[t]
\centering
\includegraphics[width=12cm,height=5cm]{Ch4/fig8}
\caption{Estrategia de lazos de control adicionales}
\label{f4_20}
\end{figure}
%----------------------------------------------------

La estrategia propuesta para manejar correctamente este tipo de eventos anormales es utilizar las mediciones
existentes de flujo a la salida de la v{\'a}lvula que esta fallando y conducir la tasa de producci{\'o}n hacia ese
nuevo punto operativo. Es decir, realizar una correcci{\'o}n de la referencia original de tasa de producci{\'o}n
$sp_{pr}^0(k)$ de forma adecuada a la magnitud del bloqueo existente en la v{\'a}lvula.

Bajo operaci{\'o}n normal del proceso (estado estacionario) el flujo medido de pulpa hacia los blanqueadores
($y_1^m(k)$) y el flujo de LV hacia el apagador de cal ($y_2^m(k)$) est{\'a}n directamente relacionados con la
trayectoria de referencia de tasa de producci{\'o}n seleccionada ($sp_{pr}^1(k)$). De esta forma un modelo
inferencial $M_i$ puede desarrollarse como se muestra en la ec. \ref{e4_10}.
\begin{equation}\label{e4_20}
\hat{y}_i^m(k) = \frac{sp_{pr}^1(k)+\kappa_i}{\upsilon_i}
\end{equation}
donde $\kappa_i$ y $\upsilon_i$ son par{\'a}metros escalares, $i=1,2$ hace referencia a el lazo de control
involucrado (v{\'a}lvula de pulpa o LV respectivamente) y $\hat{y}_i^m(k)$ es la estimaci{\'o}n de los flujos a la
salida de la v{\'a}lvula correspondiente en caso libre de fallas.

Mientras no ocurre ninguna falla en los actuadores/v{\'a}lvulas los lazos adicionales permanecen desconectados e
inactivos, $s_i=abierto$, siendo en este caso $sp_{pr}^1(k)=sp_{pr}^0(k)$. Cuando alguna de las v{\'a}lvulas
mencionadas anteriormente falla, bloque{\'a}ndose en alguna posici{\'o}n, el lazo de control que la tiene como VM se
abre y el valor del flujo queda fijo en un valor que corresponde al del bloqueo. En este caso, la correcta y
oportuna detecci{\'o}n y clasificaci{\'o}n del evento dada por el SDDEF permite accionar el lazo de control
adicional correspondiente ($s_i=cerrado$) y modificar la referencia original de tasa de producci{\'o}n
$sp_{pr}^0(k)$ como se muestra en la ec. \ref{e4_21}
\begin{equation}\label{e4_21}
sp_{pr}^1(k)=sp_{pr}^0(k)+u_i^c(k)
\end{equation}
desde el punto de vista del lazo adicional la variable de correcci{\'o}n $u_i^c(k)$ es considerada como una VM y
en este caso es calculada mediante un controlador PI. La inferencia $\hat{y}_i^m(k)$ puede verse como la VC
siendo esta la predicci{\'o}n del flujo a la salida de la v{\'a}lvula en el caso libre de fallas. La medici{\'o}n real
de este flujo $y_i^m(k)$ a la salida de la v{\'a}lvula que realmente se encuentra fallando juega el rol de
referencia.

El ajuste de estos controladores PI se realiza por m{\'e}todos gr{\'a}ficos, utilizando la curva de reacci{\'o}n del
proceso a un salto del tipo escal{\'o}n en las variables involucradas. Ajustando un modelo de primer orden con
retardo a esta curva se puede obtener la ganancia $k_p$, la constante de tiempo $\tau_p$ y el retardo
$\theta_p$ gr{\'a}ficamente. Puede ajustarse un controlador PI continuo (ganancia proporcional $K_{PI}$ y
constante de tiempo integral $\tau_{PI}$) mediante las reglas de Cohen-Coon y finalmente discretizar dicho
controlador para obtener la versi{\'o}n discreta con tiempo de muestreo $T_s$ y la regla rectangular por atraso,
por ejemplo. El conjunto de par{\'a}metros completo utilizados en el ajuste de dichos controladores puede
observarse en la Tabla \ref{t4_15}.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros de los lazos adicionales de control - Control descentralizado} \label{t4_15} \centering
  \small\rmfamily
  \begin{tabular}{lcccccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Caso   & $\kappa_i$ & $\nu_i$ & $k_p$ & $\tau_p$ [min.]  & $\theta_p$ [min.] & $K_{PI}$ & $\tau_{PI}$ [min.] & $T_s$ [min.]  \\
  \midrule[0.08em]
  Lazo 1 & 0.4422     & 22.6762 & 0.044 & 0.8              & 5                 & 5        & 1                  & 5        \\
  Lazo 2 &-0.0903     &  1.6421 & 0.609 & 0.001            & 5                 & 0.1      & 1                  & 5        \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

La estructura general del SDDEF para este caso de PPP puede observarse en la Fig. \ref{f4_21}, y su formato
es similar al mostrado en la Fig. \ref{f4_4}. Los tres subsistemas ACPA, SLD, y RNA contin{\'u}an realizando las
tareas de detecci{\'o}n, clasificaci{\'o}n y estimaci{\'o}n de las fallas respectivamente. Un bloque que realiza el
manejo del tipo de falla, permite seleccionar las acciones a ejecutar una vez clasificada la falla. Si el
evento anormal es clasificado como del tipo falla en actuador/v{\'a}lvula el lazo de control adicional
correspondiente es activado. En el caso de fallas en sensores la se selecciona la adecuada RNA y la
estimaci{\'o}n de la falla es llevada acabo. Si los eventos ocurridos pertenecen a la categor{\'\i}a de cambios en la
referencia o perturbaciones el SDDEF solo informa de su ocurrencia pero no realiza acciones de compensaci{\'o}n,
la estructura de control esta preparada para una correcta operaci{\'o}n en estos casos. En cualquiera de los
tipos de eventos enumerados anteriormente, adem{\'a}s se genera la informaci{\'o}n correspondiente para el monitoreo
en l{\'\i}nea del estado del proceso y las evaluaciones necesarias para ayudar en la toma de decisiones.
% Figure---------------------------------------------
\begin{figure}[t]
\centering
\includegraphics[width=10cm,height=12cm]{Ch4/SDDEF_ppp}
\caption{Estructura del SDDEF para la PPP - Control descentralizado} \label{f4_21}
\end{figure}
%----------------------------------------------------

\subsubsection{Resultados}
En esta secci{\'o}n se presenta los principales resultados de operar este complejo caso de estudio integrando o
no el SDDEF con el CTF. En forma gr{\'a}fica se muestran algunos de los casos mas sobresalientes y mediante
{\'\i}ndices apropiados y tabulaciones se resumen un gran conjunto de simulaciones que ponen en evidencia los
beneficios de contar o no con este tipo de estrategia.

El SDDEF es evaluado mediante los {\'\i}ndices presentados en la secci{\'o}n \ref{sec_indexes} ($PTD$, $PSR$ y
$ECMP$). La estrategia integrada SDDEF/CTF es evaluada utilizando los {\'\i}ndices $PME$. En adici{\'o}n a estos
{\'\i}ndices este proceso cuenta con un conjunto de evaluaciones de costos de operaci{\'o}n. Los trabajos de
\cite{CjDf:04a,CjDf:04b} sugieren utilizar el porcentaje de mejora del beneficio $PMB$. Este {\'\i}ndice se
calcula basado en el beneficio total de operaci{\'o}n $BTO$ del proceso como se muestra en la ec. \ref{e4_22}.
\begin{equation}\label{e4_22}
PMB_j^i = \frac{BTO_j^i-BTO_{normal}}{BTO_{normal}}100\%
\end{equation}
donde $j$ representa el tipo de falla presente ,$BTO_j^i$ es el beneficio total de operaci{\'o}n con la
estrategia de control $i$, donde $i=convencional,CTF$. Cuando una falla ocurre el $BTO_j^i$ puede tomar
valores diferentes a el que tiene el proceso en funcionamiento normal, $BTO_{normal}$. Un $PMB$ negativo
significa que la estrategia de control actual no puede compensar el efecto de la falla y los beneficios de
operaci{\'o}n son menores a el caso normal. Un $PBM$ cercano a cero significa que la estrategia de control
actual mantiene el proceso bajo condiciones de operaci{\'o}n esperadas, debido a la compensaci{\'o}n del efecto de
la falla. Finalmente un $PBM$ positivo significa que las herramientas de tolerancia incluidas incrementan
los beneficios de operaci{\'o}n respecto del caso normal.

El {\'\i}ndice $BTO$ no considera costos de capital, salarios de personal e implementaciones de control, as{\'\i} como
otros costos que no dependen de la tasa de producci{\'o}n. Tiene en cuenta la suma de todos los costos
vinculados con materias primas, utilidades y beneficios obtenidos de la venta de productos. El $BTO$ se
define com muestra la ec. \ref{e4_23}
\begin{equation}\label{e4_23}
BTO_j=\sum_k\sum_i\bar{c}_i\bar{F}_i^j(k)
\end{equation}
los coeficientes $\bar{c}_i$ representan precio de costo/venta por unidad de medida (masa, volumen,
potencia, etc.) de utilidades, materias primas, penalidades ambientales o violaciones de calidad del
producto. $\bar{F}$ representa la cantidad de tales materias, utilidades y productos utilizados o vendidos
durante la operaci{\'o}n del proceso. Un resumen de los costos utilizados en este trabajo se presentan en la
Tabla \ref{t4_16}.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Valores de costo y venta} \label{t4_16}
\centering
  \small\rmfamily
  \begin{tabular}{llll}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Especie           & Costo [\$/kg]        & Especie          & Costo [\$/kg] \\
  \midrule[0.08em]
  Astillas de madera& $3.86\times 10^{-2}$ & Ox{\'\i}geno          & $0.15$ \\
  Vapor (1 atm)     & $2.53\times 10^{-3}$ & CLO$_2$          & $1.00$ \\
  Vapor (7.8 atm)   & $5.18\times 10^{-3}$ & Na$_2$SO$_4$     & $0.100$\\
  Vapor (35 atm)    & $7.94\times 10^{-3}$ & CaO              & $0.063$\\
  Agua refrigerante & $5.3\times 10^{-5}$  & Gas natural      & $0.170$\\
  Agua de proceso   & $1.321\times 10^{-5}$& Pulpa            & $0.33$ \\
  NaOH              & $0.20$               &                  &  \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

La primer simulaci{\'o}n de la Fig. \ref{f4_22} se puede observar la evoluci{\'o}n de las principales variables del
proceso cuando una falla en el sensor de no. Kappa en $E$ ($F_{8}$) ocurre en un instante $T_f=25$ hr. y con
una magnitud del 30 \% respecto se su punto operativo normal. El algoritmo del SDDEF realiza la detecci{\'o}n,
clasificaci{\'o}n y estimaci{\'o}n en los instantes $T_d=25,5$ hr., $T_c=33$hr. y $T_r=67,1$ hr. respectivamente. La
Fig. \ref{f4_22}(a) presenta el no. Kappa real y medido en $E$ cuando la estrategia de SDDEF/CTF esta
funcionando. En $T_r$ la informaci{\'o}n suministrada por el SDDEF es utilizada para actualizar la
correspondiente trayectoria de referencia en l{\'\i}nea. As{\'\i}, el valor real del no. Kappa en $E$ retorna a su
punto operativo normal, compens{\'a}ndose el efecto de la falla. La Fig. \ref{f4_22}(b) muestra el caso cuando
no existe ninguna estrategia de integraci{\'o}n ni sistema SDDEF. Es posible observar como claramente el proceso
evoluciona hacia otro punto operativo, diferente al deseado. Esto es esencialmente debido a que en lazos de
control no tolerantes las fallas en sensores son consideradas como perturbaciones de salida propagando el
error de medici{\'o}n hacia el proceso. El monitoreo realizado por el estad{\'\i}stico combinado en la Fig.
\ref{f4_22}(c) muestra evidentemente las caracter{\'\i}sticas adaptivas del mismo. Las salidas del SDDEF en este
caso se resumen en la Fig. \ref{f4_22}(d), donde se presentan el soporte de la regla clasificada
$y_j(k)=0.95$, la estimaci{\'o}n del offset normalizado $\hat{o}_{ff}^{CV22}(k)=0.3$ y la regla clasificada como
verdadera, N\textordmasculine=14 ($F_8+$ seg{\'u}n la Tablas \ref{t4_8} y \ref{t4_11}). finalmente en la Fig.
\ref{f4_22}(e) puede apreciarse la contribuci{\'o}n media ($u^m_i(k)$, $i=13,\ldots,40$) de las variables del
proceso a la regla identificada. Dando as{\'\i} un punto de vista entendible del estado global de la planta.
% Figure----------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[Con SDDEF/CTF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig9a}} \subfigure[Sin
SDDEF/CTF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig9b}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/fig9c}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig9d}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 14]{\includegraphics[width=7cm,height=4cm]{Ch4/fig9e}} \caption{Falla en el sensor de no.
Kappa en $E$ ($F_{8}$)} \label{f4_22}
\end{figure}
%-----------------------------------------------------------------------------------------------------

En la Fig. \ref{f4_23} se presenta el caso de fallas en sensores ocurriendo de forma secuencial.
Inicialmente ocurre una falla en el sensor de temperatura del reactor $O$ ($F_6$) en $T_{f1}=8,33$ hr. con
una magnitud de $-1\%$ respecto de su valor de operaci{\'o}n normal. En $T_{f2}=116,66$ hr. se presenta de forma
secuencial una falla en el sensor de temperatura de la torre de blanqueo $E$ ($F_{9}$) ocurriendo con una
magnitud de $1,5\%$. En las Figs. \ref{f4_23}(a),(b) se pueden observar las evoluciones de la variable real
y medida para la temperatura en $O$ cuando se cuenta o no con una estrategia de SDDEF/CTF respectivamente.
La compensaci{\'o}n de la falla otorgada por la estrategia integrada de SDDEF/CTF permite retornar la variable
real a los valores deseados de operaci{\'o}n. Sin dicha estrategia se observa el claro funcionamiento fuera de
rango normal. Resultados an{\'a}logos se obtienen para el caso de la segunda falla, Figs. \ref{f4_23}(c),(d).
Los beneficios de contar con una estrategia adaptiva de monitoreo son visualizados en la Fig. \ref{f4_23}(e)
donde claramente se observa como el estad{\'\i}stico combinado permite detectar de forma eficaz ambos eventos
anormales. Luego de la ocurrencia de la pier falla el SDDEF realiza la detecci{\'o}n en $T_{d1}=8,91$ hr., la
clasificaci{\'o}n en $T_{c1}=16,41$ hr. y la estimaci{\'o}n de la magnitud de dicha falla en $T_{r1}=50,58$ hr.. As{\'\i}
el proceso es retornado a su comportamiento normal r{\'a}pidamente y el estado global del sistema permite
futuras posibles ocurrencia de nuevas fallas. Cuando la segunda falla aparece, el SDDEF esta listo para
realizar su tarea, detectando en $T_{d2}=118,83$ hr., clasificando en $T_{c2}=126,33$ y estimando en
$T_{r2}=160,50$ hr.. La Fig. \ref{f4_23}(f) muestra las salidas del SDDEF en este caso, el soporte de la
regla clasificada en cada caso, la estimaci{\'o}n del offset normalizado en ambos casos
($\hat{o}_{ff}^{CV20}(k)$ y $\hat{o}_{ff}^{CV23}(k)$) y el n{\'u}mero de las reglas utilizadas en la
clasificaci{\'o}n, N\textordmasculine=9 para la falla $F_6-$ y N\textordmasculine=16 para la falla $F_9+$. En
las Figs. \ref{f4_23}(g),(h) se presentan las contribuciones medias ($u^m_i(k)$, $i=13,\ldots,40$) a cada
regla por las variables del proceso.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[Con SDDEF/CTF, $O$]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10a}} \subfigure[Sin
SDDEF/CTF, $O$]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10b}} \subfigure[Con SDDEF/CTF,
$E$]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10c}} \subfigure[Sin SDDEF/CTF,
$E$]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10d}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10e}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10f}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 9]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10g}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 16]{\includegraphics[width=7cm,height=4cm]{Ch4/fig10h}} \caption{Fallas en
sensores secuenciales ($F_{6}$ y $F_{9}$) } \label{f4_23}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

Otro conjunto de simulaciones es resumido en la Fig. \ref{f4_24}, en este caso se presentan eventos
secuenciales tales como perturbaciones y fallas en actuadores/v{\'a}lvula. Este tipo de escenario permite
comprobar el funcionamiento del SDDEF ante diferentes condiciones del proceso. En $T_{f1}=8,33$ hr. ingresa
a la planta una perturbaci{\'o}n referente a la composici{\'o}n de las astillas de madera. La concentraci{\'o}n de la
lignina y celulosa (regla N\textordmasculine=29) se modifica asumiendo una magnitud normalizada 1 y -1
respectivamente. En las Figs. \ref{f4_24}(a),(b),(c) se puede apreciar como el efecto de la perturbaci{\'o}n es
rechazado correctamente por la estructura de control, mientras el SDDEF detecta , clasifica e informa
adecuadamente el evento. La evoluci{\'o}n temporal del estad{\'\i}stico combinado puede observarse en la Fig.
\ref{f4_24}(e) realizando la primera detecci{\'o}n r{\'a}pidamente en el instante $T_{d1}=11$ hr.. La clasificaci{\'o}n
y la reconfiguraci{\'o}n del algoritmo ACPA son realizadas en $T_{c1}=18,5$ hr. y $T_{r1}=52,66$ hr.
respecivamente. El rechazo de la perturbaci{\'o}n es realizado con {\'e}xito por la estructura de control y no son
necesarias acciones de tolerancia o reconfiguraci{\'o}n del controlador. De forma secuencial en $T_{f2}=116,66$
hr. ocurre un bloqueo en la v{\'a}lvula de flujo de LV hacia el apagador de cal ($F_{14}$, regla
N\textordmasculine=25) con una magnitud de $-30\%$ respecto de su valor de trabajo. La estrategia de control
original (sin SDDEF/CTF) no es capaz de mantener el comportamiento estable del proceso. Esto puede
observarse de las Figs. \ref{f4_24}(a),(b),(c) donde el flujo de astillas es incrementado tratando de
mantener la tasa de producci{\'o}n original. Esto genera que las variables del proceso se muevan hacia otro
punto operativo no deseado, por ejemplo \ref{f4_24}(c) el no. Kappa en $E$. Este tipo de falla es realmente
un problema serio, ya que r{\'a}pidamente algunos tanques podr{\'\i}an descargarse y eventualmente el proceso deber{\'\i}a
parar. Para evitar este problema y mantener la operabilidad del proceso se implementa un lazo adicional de
control con la estrategia SDDEF/CTF hasta que el correspondiente actuador/v{\'a}lvula es reparado. El SDDEF
realiza la detecci{\'o}n y clasificaci{\'o}n de este segundo evento en $T_{d2}=117,5$ hr. y $T_{c2}=125$ hr.
respectivamente. El correcto manejo de la falla permite activar el lazo adicional de control correspondiente
(N\textordmasculine=2) como se observa en la Fig. \ref{f4_24}(d). As{\'\i}, el proceso es conducido hacia un
estado de operaci{\'o}n mas estable de acuerdo con la magnitud de la falla. En este caso el no. Kappa en $E$
puede observarse como se mantiene en su valor deseado de trabajo y  el flujo de astillas se disminuye de
forma adecuada a la actualizaci{\'o}n de la referencia en la tasa de producci{\'o}n. Las salidas del SDDEF pueden
apreciarse en la Fig. \ref{f4_24}(f), el soporte de las reglas clasificadas, las reglas clasificadas
N\textordmasculine=29 y N\textordmasculine=25 y el lazo de control adicional activado N\textordmasculine=2.
Las Figs. \ref{f4_24}(g),(h) resumen la contribuci{\'o}n media de las variables del proceso a cada una de las
reglas identificadas.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[Flujo de astillas]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11a}} \subfigure[Tasa
de producci{\'o}n]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11b}} \subfigure[no. Kappa en
$E$]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11c}} \subfigure[Lazo de control
adicional]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11d}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11e}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11f}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 29]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11g}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 25]{\includegraphics[width=7cm,height=4cm]{Ch4/fig11h}} \caption{Eventos
secuenciales (perturbaci{\'o}n de lignina/celulosa y falla en el actuador $F_{14}$)} \label{f4_24}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

La Fig. \ref{f4_25} agrupa los resultados obtenidos de las simulaciones en el caso de fallas secuenciales en
sensores y actuadores. En este caso particular se presenta una falla en el sensor de temperatura de la torre
de blanqueo $D_2$ ($F_{10}$) en $T_{f1}=8,33$ hr. con una magnitud de $-1,5\%$ respecto a su punto operativo
normal. Secuencialmente en $T_{f2}=116,66$ hr. se produce el bloqueo de la v{\'a}lvula que manipula el flujo de
pulpa hacia las torres de blanqueo ($F_{13}$) en un valor de $-10\%$. La Fig. \ref{f4_25}(a) muestra la
temperatura en $D_2$ con y sin estrategia SDDEF/CTF. Claramente, la integraci{\'o}n del SDDEF con CTF permite
retornar la temperatura real en $D_2$ a su punto operativo normal actualizando la trayectoria de referencia.
Esta primer falla es detectada, clasificada y reconfigurada en los instantes temporales $T_{d1}=8,83$ hr.,
$T_{c1}=16,33$ hr. y $T_{r1}=50,5$ hr. respectivamente. La segunda falla provoca que el proceso tienda a
moverse hacia otro punto operativo. Puede observarse en las Figs. \ref{f4_25}(b),(c) como no contar con un
estrategia CTF integrada permite que el algoritmo de control cl{\'a}sico incremente dr{\'a}sticamente el flujo de
astillas sobrepasando los l{\'\i}mites admisibles del digestor para tratar de mantener la tasa de producci{\'o}n
original. Este comportamiento no puede continuar indefinidamente en esta situaci{\'o}n y a las 150 hrs. de
simulaci{\'o}n se produce la parada del proceso. Para evitar este comportamiento indeseado se desarrolla la
estrategia SDDEF/CTF activando el lazo adicional de control correspondiente. La detecci{\'o}n y clasificaci{\'o}n de
esta segunda falla se realiza en los instantes $T_{d2}=117,16$ hr. y $T_{c2}=124,66$ fr. respectivamente, y
la activaci{\'o}n del lazo es inmediata (Figs. \ref{f4_25}(d)). Esto permite la estabilizaci{\'o}n del proceso en un
nuevo punto operativo considerando las limitaciones introducidas por la magnitud de la falla. El estad{\'\i}stico
combinado muestra la evoluci{\'o}n en la detecci{\'o}n de ambos eventos y puede apreciarse en la Fig.
\ref{f4_25}(e). Las salidas del SDDEF se resumen en la Fig. \ref{f4_25}(f), donde se puede apreciar el
soporte de las reglas, tipo de reglas (17 y 23 relacionando $F_{10}-$ y$F_{13}-$ respectivamente),
estimaci{\'o}n del offset normalizado y el lazo adicional de control activado (N\textordmasculine=1). Las Figs.
\ref{f4_25}(g),(h) muestran la contribuci{\'o}n media de las variables del proceso a cada una de las reglas
involucradas en la clasificaci{\'o}n.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[Temperatura en $D_2$]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12a}}
\subfigure[Flujo de astillas]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12b}} \subfigure[Tasa de
producci{\'o}n]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12c}} \subfigure[Lazo de control
adicional]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12d}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12e}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12f}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 17]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12g}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 23]{\includegraphics[width=7cm,height=4cm]{Ch4/fig12h}} \caption{Fallas
secuenciales ($F_{10}$ y $F_{13}$)} \label{f4_25}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{{\'I}ndices de rendimiento - Control descentralizado} \label{t4_17} \centering
  \footnotesize\rmfamily
  \begin{tabular}{lrrrcccc}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  Eventos               & $T_f$ [hr.]& $T_d$ [hr.] & $PTD$ [\%] & $y_j$   & $PSR_j$ [\%]  & $ECMP_j$             & $PME_j$ [\%] \\
  \midrule[0.08em]
  $F_{1}$($+10$\%)      &  25,00     &  25,50      &  6,00      & 0,75    & 63            & $0,49\times 10^{-6}$ & 72,50             \\
  $F_{2}$($+12$\%)      &  25,00     &  25,58      &  6,96      & 0,86    & 47            & $0,40\times 10^{-5}$ & 68,71             \\
  $F_{4}$($+1$\%)       &  25,00     &  25,50      &  6,00      & 0,82    & 41            & $0,86\times 10^{-5}$ & 67,95             \\
  $F_{5}$($+1$\%)       &  25,00     &  25,91      & 10,92      & 1,00    & 37            & $0,22\times 10^{-4}$ & 62,57             \\
  $F_{6}$($+1$\%)       &  25,00     &  25,50      &  6,00      & 0,85    & 38            & $0,11\times 10^{-4}$ & 72,58             \\
  $F_{7}$($+1$\%)       &  25,00     &  25,50      &  6,00      & 0,89    & 36            & $0,61\times 10^{-5}$ & 66,66             \\
  $F_{8}$($+30$\%)      &  25,00     &  26,33      & 15,96      & 0,91    & 43            & $0,25\times 10^{-5}$ & 69,93              \\
  $F_{9}$($+1.5$\%)     &  25,00     &  27,00      & 24,00      & 1,00    & 38            & $0,11\times 10^{-4}$ & 70,49              \\
  $F_{10}$($+1.5$\%)    &  25,00     &  25,50      &  6,00      & 0,99    & 36            & $0,94\times 10^{-7}$ & 73,72              \\
  $F_{11}$($+4$\%)      &  25,00     &  25,41      &  4,92      & 0,91    & 47            & $0,12\times 10^{-4}$ & 74,93              \\
  $F_{12}$($+30$\%)     &  25,00     &  26,16      & 13,92      & 0,99    & 36            & $0,19\times 10^{-3}$ & 73,16             \\
  $F_{13}$($-10$\%)     &  8.33      &   8,83      &  6,00      & 0,99    & 68            &  $\bigotimes$        & 93.44              \\
  $F_{14}$($-30$\%)     &  8.33      &   9,08      &  9,00      & 0,98    & 83            &  $\bigotimes$        & 86.89              \\
  \midrule[0.08em]
  $F_{6}$($-1$\%) y     &  8,33      &   8,91      &  6,96      & 0,81    & 35            & $0,34\times 10^{-3}$ & 74,74             \\
  $F_{9}$($+1.5$\%)     &  116,66    & 118,83      & 26,05      & 0,99    & 38            & $0,14\times 10^{-4}$ & 41,95             \\
  \midrule[0.08em]
  lignina/celulosa y    &  8,33      &  11,00      & 32,05      & 0,92    & 55            & $\bigotimes$         &              \\
  $F_{14}$($-30$\%)     &  116,66    & 117,50      & 10,08      & 0,86    & 73            & $\bigotimes$         & 92,16               \\
  \midrule[0.08em]
  $F_{10}$($-1.5$\%) y  &  8,33      &   8,83      &  6,00      & 0,96    & 35            & $0,29\times 10^{-3}$ & 68,18             \\
  $F_{13}$($-10$\%)     &  116,66    & 117,16      &  6,00      & 0,99    & 68            & $\bigotimes$         & 91,84              \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{{\'I}ndices de costos - Control descentralizado} \label{t4_18} \centering
  \footnotesize\rmfamily
  \begin{tabular}{lccccc}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  \multirow{2}{1.5cm}{Fallas} & \multicolumn{2}{c}{Beneficio [\$]} & \multicolumn{2}{c}{$PMB_j$ [\%]} & Per{\'\i}odo \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){2-3}\cmidrule[0.08em](l{0.6em}r{0.6em}){4-5}
                              &Sin CTF      &Con CTF                &Sin CTF       & Con CTF             & [d{\'\i}as] \\
  \midrule[0.08em]
  $F_{1}$($+10$\%)            &  672387     &  765614               &  -12,30      &  -0,14              &  5,21 \\
  $F_{11}$($+4$\%)            & -3952926    &  766872               & -615,56      &   0,02              &  5,21 \\
  $F_{13}$($-10$\%)           & -595655     &  607210               & -177,77      & -20,71              &  5,21 \\
  $F_{14}$($-30$\%)           & -433076     &  641990               & -156,55      & -16,17              &  5,21 \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

Las simulaciones previas y otros casos diferentes son resumidos en la Tabla \ref{t4_17} utilizando los
{\'\i}ndices de rendimiento definidos en secciones anteriores. En esta tabla puede observarse como la detecci{\'o}n
de las fallas, $T_d$ se realizan r{\'a}pidamente respecto del su instante de ocurrencia, $T_f$. Adem{\'a}s esta
r{\'a}pida detecci{\'o}n comparado con la din{\'a}mica mas lenta del proceso utilizando el {\'\i}ndice de porcentaje del
tiempo de detecci{\'o}n, $PTD$. En todos los casos, este {\'\i}ndice no excede el 35 \% de magnitud. Por otro lado,
el SLD es evaluado mediante el soporte de la regla que cuantifica el grado de posibilidad de ocurrencia de
la regla clasificada correctamente, $y_j$ y  el grado de robustez de dicha clasificaci{\'o}n mediante el
porcentaje de soporte de la regla, $PSR$. En todos los casos el soporte de la regla presenta buenas
caracter{\'\i}sticas, valores cercanos a uno. Adem{\'a}s, el $PSR$ nunca es menor del 35 \%, indicando buenas
cualidades de robustez, la clasificaci{\'o}n es consistente. El subsistema de RNA que realiza la identificaci{\'o}n
de la falla es evaluado respecto del grado de generalizaci{\'o}n que presenta a nuevos eventos y la precisi{\'o}n en
la estimaci{\'o}n mediante el $ECMP$. En el caso de fallas en actuadores el subsistema RNA no es utilizado y
esta condici{\'o}n se indica con el s{\'\i}mbolo $\bigotimes$ en la tabla. El rendimiento del sistema completo
SDDEF/CTF es evaluado mediante el {\'\i}ndice de porcentaje de mejora del error, $PME$ sobre las variables de
inter{\'e}s y respecto al caso sin SDDEF/CTF. En todos los casos la mejora es evidente. Para el caso de falla en
sensores las variables utilizadas en dicho {\'\i}ndice corresponden a las involucradas en el lazo de control
afectado por el sensor correspondiente. En el caso de fallas en actuadores las variables utilizadas son las
mas afectadas por este tipo de fallas. En particular para la falla $F_{13}$ es utilizado el no. Kappa del
digestor y  para la falla $F_{14}$ el no. Kappa en la torre $E$. La falla $F_3$ no ha sido considerada en
este caso de estrategia de control descentralizado por no generar modificaciones importantes en el proceso.
Variaciones de esta falla entorno al $\pm 1\%$ no modifican el punto operativo global del proceso. Si ser{\'a}
considerada en el caso controladores multivariables.

% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[Tasa de producci{\'o}n con SDDEF/CTF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13a}}
\subfigure[Tasa de producci{\'o}n sin SDDEF/CTF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13b}}
\subfigure[no. Kappa en $E$ y brillo]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13c}}
\subfigure[Estad{\'\i}stico combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13d}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13e}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 27]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13f}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 1]{\includegraphics[width=7cm,height=4cm]{Ch4/fig13g}} \caption{Eventos
secuenciales (tres cambios de referencia y $F_{1}$)} \label{f4_26}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

Finalmente se presenta el an{\'a}lisis de costos en la Tabla \ref{t4_18} para las fallas mas representativas. El
computo de los beneficios y costos de operaci{\'o}n son realizados en base a los trabajos de
\cite{CjDf:04a,CjDf:04b} donde se considera el porcentaje de mejora del beneficio, $PMB$ calculado como
funci{\'o}n del beneficio total de operaci{\'o}n, $BTO$. Notar que el $PMB$ esta calculado comparando las
estrategias con/sin SDDEF/CTF respecto a los beneficios y costos bajos condiciones normales de operaci{\'o}n.
As{\'\i}, un $PMB$ negativo significa que la estrategia actual no puede compensar el efecto de las fallas y el
beneficio decrece respecto al normal. Un $PMB$ cercano a cero significa que la estrategia de control actual
ha podido compensar la falla y retorno los beneficios a su estado normal. Un valor positivo de dicho {\'\i}ndice
refleja que la estrategia de control a mejorado los beneficios de operaci{\'o}n en este caso. El per{\'\i}odo de
evaluaci{\'o}n ha sido fijado en 5,21 d{\'\i}as. El caso de la falla $F_1$ sin CTF genera la disminuci{\'o}n de la tasa
de producci{\'o}n respecto del punto operativo deseado, provocando grandes p{\'e}rdidas. Cuando la estrategia CTF es
integrada la falla es rechazada correctamente y los beneficios vuelven pr{\'o}ximos a sus valores normales,
$PMB$ cercano a cero. Claramente se observa la ventaja de contar con un SDDEFF/CTF. Conclusiones similares
pueden obtenerse para el caso de la falla $F_{11}$ que afecta las cualidades de brillo de la pulpa, el cual
es fuertemente penalizado. Los productos fuera de especificaci{\'o}n no pueden ser vendidos. De la tabla puede
observarse los beneficios obtenidos al contar con una estrategia de CTF, en particular para este tipo de
falla las p{\'e}rdidas por no utilizar CTF son realmente grandes. Un escenario diferente se observa para las
fallas en actuadores, este tipo de fallas generan la parada de planta si las acciones correctivas necesarias
no son tomadas a tiempo. Tanto la falla $F_{13}$ como la $F_{14}$ generan condiciones sumamente
desfavorables para la operabilidad del proceso, esto puede observarse de los grandes valores negativos del
{\'\i}ndice $PMB$ y eventualmente las p{\'e}rdidas ocasionadas. Esto puede disminuirse considerablemente mediante la
integraci{\'o}n de los lazos adicionales de control (SDDEF/CTF) direccionando la planta hacia una condici{\'o}n mas
estable y segura de operaci{\'o}n permitiendo la operaci{\'o}n del proceso. Claramente esto puede realizarse a costa
de trabajar a menor tasa de producci{\'o}n, la cual ser{\'a} proporcional a la magnitud de la falla.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Variables utilizadas en al ACPA - CPM} \label{t4_19} \centering
  \footnotesize\rmfamily
  \begin{tabular}{clcl}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  \multicolumn{2}{c}{Variables controladas }                &\multicolumn{2}{c}{Variables manipuladas}        \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){1-2} \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  Variables          & Descripci{\'o}n                                 & Variables                 & Descripci{\'o}n \\
  \midrule[0.08em]
  1                  & Tasa de producci{\'o}n del digestor             & 1                         & Flujo de astillas\\
  2                  & Tasa de producci{\'o}n de almacenamiento        & 2-3                       & Flujo de LB (cocci{\'o}n/lavado)\\
  3                  & Tasa de producci{\'o}n en $D_2$                 & 4-5                       & Flujos de vapor  1-2\\
  5                  & no. Kappa en el digestor                    & 7-8                       & Flujos de vapor  4--5\\
  6                  & Pulpa producida en el digestor              & 9                         & Flujo de agua\\
  7                  & Pulpa producida blanqueada                  & 10--11                    & Fracci{\'o}n de pulpa lavada 1--2\\
  10                 & Conductividad superior del extracto         & 14                        & Flujo de vapor 1 en $O$\\
  11                 & Conductividad inferior del extracto         & 17                        & Flujo de vapor 3 en $O$\\
  12-14              & Temp. de cocci{\'o}n $T$(cook,mcc,emcc)         & 18                        & Flujo de pulpa\\
  15                 & Temperatura del LB del digestor             & 20                        & Flujo de $ClO_2$ en $D_1$ \\
  16                 & Temperatura superior del extracto           & 21--22                    & Flujo de agua y vapor en $E_1$\\
  17-18              & Reciclos de vapor no. 1-2                   & 23                        & Flujo c{\'a}ustico en $E$\\
  19-20              & no. Kappa y temperatura en $O$              & 25                        & Flujo de vapor en $E$\\
  21                 & Temperatura en $D_1$                        & 26                        & Flujo de $ClO_2$ en $D_2$ \\
  22-23              & no. Kappa y temperatura en $E$              & 29                        & Fracci{\'o}n 2 en $O$\\
  24                 & Lavador [$OH^-$] en $E$                     & 30                        & Fracci{\'o}n $E$\\
  25-26              & Brillo y temperatura en $D_2$               & 31                        & Fracci{\'o}n de pulpa lavada 3\\
  27-33              & FD lavadores no. 1-7                        & 33                        & Fracci{\'o}n de pulpa lavada 5\\
  34                 & Almacenamiento $V$                          & 36                        & Flujo de refrigerante en $O$\\
  35                 & Temperatura del efluente en $O$             & 37                        & Flujo de ox{\'\i}geno $O$\\
  36                 & Consistencia del lavador en $O$             & 38                        & Flujo de pulpa blanqueada\\
  37-38              & Presi{\'o}n en $O$ y volumen en $D_2$           & & \\
  39-40              & EA superior e inferior                      & & \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

Con la finalidad de poder poner en contraste de forma efectiva las caracter{\'\i}sticas adaptivas del sistema
SDDEF propuesto aqu{\'\i} se generan los resultados de la Fig. \ref{f4_26}. En este caso el punto operativo del
proceso es cambiado dr{\'a}sticamente modificando las referencias de la tasa de producci{\'o}n, el no. Kappa en $E$
y el brillo de forma simultanea. En $T_{f1}=8,33$ hr. la tasa de producci{\'o}n cambia a 690 ton./d{\'\i}a, el no.
Kappa a 2 y el brillo a 0,86, las Figs. \ref{f4_26}(a),(c) muestran las evoluciones temporales.
Secuencialmente en $T_{f2}=116,66$ hr. aparece un falla en el sensor de tasa de producci{\'o}n, $F_1$ de
magnitud $-10\%$. La estrategia propuesta claramente detecta, clasifica y reconfigura la falla en los
instantes $T_{fd2}=117.25$ hr., $T_{c2}=124.75$ hr. y $T_{r2}=158.33$ hr. respectivamente, a{\'u}n bajo cambios
importantes de las condiciones del proceso. Pueden apreciarse de las Figs. \ref{f4_26}(a),(b) las
diferencias de contar o no con una estrategia integrada de SDDEF/CTF. El estad{\'\i}stico combinado puede
apreciarse en la Fig. \ref{f4_26}(d) y las salida del SDDEF en la Fig. \ref{f4_26}(e). Las contribuci{\'o}n
media de las variables del proceso a cada regla clasificada se puede observar en las Figs.
\ref{f4_26}(f),(g).

%\textbf{conclusions:} In this work was presented a new decentralized FTC strategy integrated to FDIE system
%to address the possible faults occurrence in chemical process. An application to the bigger benchmark
%process existing in the research community is implemented. The pulp mill benchmark allows us to work with a
%very big plant finding problems very close to the real one. Different faulty elements like sensors and
%actuators have been proposed, acting in both single and sequential form. The FDIE system was developed in
%hybrid form based on history methods like APCA, FL and ANN in order to make the fault detection,
%classification and estimation respectively. The good temporal resolution in fault detection and the
%information of the overall process variables given for the APCA approach is used to carried out the
%classification process state by FL methods. Has been possible to observe that the FL approach makes a
%correct classification of the faults, given a methodology to overcome the ASM problem. With the help of the
%process data base where have been recorded the normal operation behavior and the all historical abnormal
%events is possible to construct patterns given for the APCA method that tie the fault magnitude with
%variables representative of this via ANN approach. In order to minimize the effect of these faults and
%return the process operation to normal behavior a decentralized FTC strategy is proposed based in on line
%update. For one hand, the sensors faults effect is avoided by mean of on line reconfiguration of the set
%point policy using the fault magnitude estimation given for the FDIE system. By other hand, the actuators
%faults effect is compensate on line by turn on the corresponding additional control loop enable from FDIE.
%Thus the overall controlled process become tolerant to sensors and actuators faults minimizing the faults
%effect and assuring the plant performance like product quality, operational cost and security.

\subsection{PPP con control predictivo}
Cuando en la PPP se implementa una estrategia de control predictiva basada en modelos (CPM) multivariable,
las condiciones y los escenarios ante fallas se modifican un poco. En este caso la planta presenta cuatro
controladores CPM para cuatro {\'a}reas espec{\'\i}ficas de la planta, digestor/reactor de ox{\'\i}geno, torres de
blanqueo, evaporadores y recaustizadores/horno de cal. Estos CPM cumplen la funci{\'o}n de controladores
supervisores de lazos simples de control (P,PI), controlando adem{\'a}s algunas variables directamente. En esta
secci{\'o}n se detallan los aspectos principales de la integraci{\'o}n y desarrollo de un SDDEF cuando la planta
presenta una pol{\'\i}tica de control avanzada.
\subsubsection{Ajustes del SDDEF}
La Tabla \ref{t4_19} y \ref{t4_20} resumen el ajuste de los par{\'a}metros del subsistema de ACPA para el SDDEF.
Como se puede observar las r{\'a}pidas respuestas obtenidas por la pol{\'\i}tica de control predictiva permite
disminuir las dimensiones de algunas matrices, por ejemplo, $N_w$ y $N_{aux}$, respecto del caso
descentralizado.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros del APCA - CPM} \label{t4_20}
  \centering
  \small\rmfamily
  \begin{tabular}{ccccccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  $N_w$ [muestras] & $N_{aux}$ [muestras] & $\delta_z$ & $\nu$ & $\delta_{pva}$ [\%] & $T_s$ [min.] & N\textordmasculine entradas & $A$ & $N_a$\\
  \midrule[0.08em]
  500              & 300                  & 2          & 3     & 90                  & 5            & 63                          & 15  & 6\\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

El conjunto de par{\'a}metros involucrados en el ajuste del subsistema LD se muestran en la Tabla \ref{t4_21} y
\ref{t4_22}. Adem{\'a}s la matriz de reglas resultante del proceso de extracci{\'o}n autom{\'a}tica de reglas se puede
observar en la Fig. \ref{f4_27}.

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{N\textordmasculine de reglas / Tipo de falla - CPM}\label{t4_21}
  \centering
  \small\rmfamily
  \begin{tabular}{llll}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Fallas                  & Regla      & Fallas                         & Regla     \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){1-2} \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  $F_{1}$ (-/+ offset)    & $1-3$      & $F_{11}$ (-/+ offset)          & $22/23$    \\
  $F_{2}$ (-/+ offset)    & $4/5$      & $F_{12}$ (-/+ offset)          & $24/25$    \\
  $F_{3}$ (-/+ offset)    & $6/7$      & $F_{13}$ (-/+ bloqueo)         & $26/27$    \\
  $F_{4}$ (-/+ offset)    & $8/9$      & $F_{14}$ (-/+ bloqueo)         & $28/29$    \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  $F_{5}$ (-/+ offset)    & $10/11$     & Eventos                        & Regla       \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){3-4}
  $F_{6}$ (-/+ offset)    & $12/13$    & Cambios de referencia          & 30         \\
  $F_{7}$ (-/+ offset)    & $14/15$    & Humedad de las astillas        & 31         \\
  $F_{8}$ (-/+ offset)    & $16/17$    & Concentraci{\'o}n lignina-celulosa & 32         \\
  $F_{9}$ (-/+ offset)    & $18/19$    & Concentraci{\'o}n $ClO_2$          & 33         \\
  $F_{10}$ (-/+ offset)   & $20/21$    &                                &  \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

% Figure------------------------------------------------------------------------------------
\begin{figure}[t]
\centering {\includegraphics[width=10cm,height=10cm]{Ch4/matrix_mpc}} \caption{Matriz de reglas - CPM}
\label{f4_27}
\end{figure}
%-------------------------------------------------------------------------------------------

% Figure-------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[$RNA_3$]{\includegraphics[width=7cm,height=7cm]{Ch4/fig6a_mpc}}
\subfigure[$RNA_{10}$]{\includegraphics[width=7cm,height=7cm]{Ch4/fig6b_mpc}} \caption{Generalizaci{\'o}n de
las RNA - CPM} \label{f4_28}
\end{figure}
%--------------------------------------------------------------

Los ajustes realizados al subsistema de RNA se pueden apreciar en la Tabla \ref{t4_23} y \ref{t4_24}. La
generalizaci{\'o}n de las $RNA_3$ y $RNA_{10}$ por ejemplo se muestra en la Fig. \ref{f4_28}.

\begin{landscape}
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros de SLD - CPM} \label{t4_22}
  \centering
  \small\rmfamily
  \begin{tabular}{ccccccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Reglas, $p$ & $r$ & $a_i$           & $b_i$           & $c_i$           & $d_i$           & $e_i$         & $f_i$         & $[T_{iz},T_{fz}]$[muestras]\\
  \midrule[0.08em]
  33          & 78  & $L_{max}^i-0.5$ & $L_{max}^i+0.5$ & $L_{min}^i+0.5$ & $L_{min}^i-0.5$ & $1\times10^5$& $-1\times10^5$ & $[0,80]$\\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Mapeo propuesto por las RNA - CPM} \label{t4_23}
  \centering
  \small\rmfamily
  \begin{tabular}{lllllllllllll}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  RNA                          &$RNA_1$&$RNA_2$&$RNA_3$ & $RNA_4$& $RNA_5$& $RNA_6$& $RNA_7$& $RNA_8$& $RNA_9$&$RNA_{10}$ & $RNA_{11}$ & $RNA_{12}$\\
  Offset del sensor de         & $VC3$ & $VC5$ & $VC12$ & $VC13$ & $VC14$ & $VC20$ & $VC21$ & $VC22$ & $VC23$ & $VC25$    & $VC26$     & $VC37$ \\
  Variaciones de la media en   & $VM1$ & $VM8$ & $VM8$  & $VM8$  & $VM8$  & $VM14$ & $VM17$ & $VM20$ & $VM22$ & $VM25$    & $VM26$     & $VM29$  \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros de las RNA - CPM} \label{t4_24}
  \centering
  \small\rmfamily
  \begin{tabular}{ccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Capa oculta          & Capa de salida & Entrenamiento       & Unidades ocultas                & Unidades de salida  \\
  \midrule[0.08em]
  Tangente hiperb{\'o}lica & Lineal         & Levenberg-Marquardt & $RNA_{1-8,10-12}=1$, $RNA_{9}=2$ & $RNA_{1-12}=1$ \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------
\end{landscape}

\subsubsection{Integraci{\'o}n al CTF}
La integraci{\'o}n al CTF en el caso de sensores se realiza de forma similar a el caso presentado anteriormente,
con la diferencia que la informaci{\'o}n suministrada del SDDEF no actualiza las pol{\'\i}tica de referencia, si no
que en este caso directamente corrige la medici{\'o}n err{\'o}nea. Es decir,
\begin{equation}
y^{mc}_i(k) = y^{m}_i(k) - \hat{o}_{ff}^{CVi}(k)
\end{equation}
donde $y^{m}_i(k)$ es la medici{\'o}n err{\'o}nea, $y^{mc}_i(k)$ es la medici{\'o}n compensada para el CPM y
$\hat{o}_{ff}^{CVi}(k)$ es la estimaci{\'o}n del offset de la variable $i$ generada por el SDDEF.

La filosof{\'\i}a mostrada para el caso descentralizado de actualizar referencias en este caso de CPM puede no
dar buenos resultados. Generalmente, un CPM involucra varias VC y VM, la mayor{\'\i}a de las VM resultan
referencias para lazos de control de bajo nivel. Compensar entonces estas referencias o las referencias del
CPM puede resultar en un efecto indeseado para otras variables del proceso, debido a la interacci{\'o}n
multivariable. Resulta entonces mas efectivo directamente compensar la medici{\'o}n que el CPM utilizar{\'a}. Este
{\'u}ltimo punto de vista da una metodolog{\'\i}a general, sin considerar estructuras del proceso y con iguales
resultados.

Para el caso de fallas en actuadores/v{\'a}lvulas la estrategia de compensaci{\'o}n puede realizarse de dos formas
diferentes. Una es aplicando la misma estrategia mostrada en el caso descentralizado mediante lazos
adicionales de control. Es decir, lazos auxiliares que contemplen las correcciones necesarias a la
referencia de tasa de producci{\'o}n para retornar al proceso a una estado seguro de trabajo. Dichos lazos ser{\'a}n
activados de forma adecuada seg{\'u}n la clasificaci{\'o}n del evento anormal realizada por el SDDEF. En este caso
los par{\'a}metros de dichos lazos resultan como se muestra en la Tabla \ref{t4_25}.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Par{\'a}metros de los lazos adicionales de control - CPM} \label{t4_25} \centering
  \small\rmfamily
  \begin{tabular}{lcccccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  Caso   & $\kappa_i$ & $\nu_i$ & $k_p$ & $\tau_p$ [min.]  & $\theta_p$ [min.] & $K_{PI}$ & $\tau_{PI}$ [min.] & $T_s$ [min.]  \\
  \midrule[0.08em]
  Lazo 1 & -0.14      & 5.15    & 0.19  & 0.50             & 5                 & 0.89        & 1.43            & 5        \\
  Lazo 2 & -1.10      & 6.10    & 0.07  & 0.50             & 5                 & 2.22        & 1.43            & 5        \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

Otra alternativa de dise{\~n}o (con resultados similares al descentralizado) de caracter{\'\i}sticas tolerantes en
estrategias de CPM, es integrar el lazo de control adicional mostrado en secciones anteriores, en la
pol{\'\i}tica de control existente. El caso de CPM brinda esta posibilidad de integraci{\'o}n, de forma natural y
debido esencialmente a su dise{\~n}o, mediante el correspondiente ajuste de los pesos en el funcional costo.

En este caso se desarrolla un modelo lineal (respuesta al impulso o al escal{\'o}n) para predecir el
comportamiento del proceso sobre el horizonte de predicci{\'o}n. Este modelo relaciona, igual que el caso de
lazo adicional, la medici{\'o}n de flujo a la salida de la v{\'a}lvula correspondiente (salida), con la referencia
de tasa de producci{\'o}n (entrada), en el caso de que no existen fallas en el proceso. As{\'\i}, se tiene un modelo
para predecir comportamiento libre de fallas. La esencia del control predictivo basado en modelo es
minimizar un determinado funcional costo, para obtener de forma {\'o}ptima los movimientos de la variable
manipulada, considerando adem{\'a}s posibles restricciones (ver secci{\'o}n \ref{sec_CPBM}). De esta forma se puede
incluir en un funcional ya existente $V(u_i^c(k))$ el lazo de control adicional ajustando de forma adecuada
los pesos involucrados y computar sus movimientos en la VM por minimizaci{\'o}n. Es decir, recordando el
funcional de la ec. \ref{e2_45}, se tiene
\begin{equation}\label{e4_24}
\begin{split}
V(u_i^c(k))=&V_o(k)+V_a(k)\\
           =&V_o(k)+\sum_{j=H_w}^{H_p}\left(\alpha_i^j\left(y_i^{fm}-\hat{y}_i^{fm}(j)\right)\right)^2+
\sum_{j=1}^{H_u-1}\left(\beta_i^ju_i^c(j)\right)^2
\end{split}
\end{equation}
donde $V_o(k)$ es la pol{\'\i}tica de control predictivo existente y $V_a(k)$ es el funcional de los lazos
adicionales de control integrados ($i=1,2$, para $F_{13}$ o $F_{14}$ respectivamente). Donde $[H_w,H_p]$ es
el horizonte de predicci{\'o}n, $H_u$ el horizonte de control, $\alpha_i^k$ los coeficientes de peso del error
de predicci{\'o}n, $\beta_i^k$ los coeficientes de peso de la magnitud de la se{\~n}al de control $u_i^c(k)$. La
referencia de la tasa de producci{\'o}n ser{\'a} compensada seg{\'u}n $u_i^c(k)$, siendo $\hat{y}_i^{fm}(k)$ las
predicciones del modelo libre de falla del flujo y $y_i^{fm}$ la medici{\'o}n de dicho flujo, actuando como
referencia para el lazo adicional.

El modelo de predicci{\'o}n puede realizarse por ejemplo mediante un modelo FIR identificado fuera de l{\'\i}nea,
$\hat{y}_i^{fm}(k)=\sum_{j=1}^{N}g_i^ju_i^c(k-j)$, donde $g_i^j$ son los correspondientes coeficientes del
FIR, para el lazo de control adicional $i$ y $N$ el orden del modelo. De forma similar a los lazos
adicionales descentralizados las correcciones de la referencia de producci{\'o}n se realizan seg{\'u}n la pol{\'\i}tica
$sp_{pr}^1(k)=sp_{pr}^0(k)+u_i^c(k)$ y  lograr la compensaci{\'o}n.

La estrategia resulta entonces en activar los pesos correspondientes ($\alpha_i^k$ y $\beta_i^k$, con
$i=1,2$) de acuerdo a la detecci{\'o}n y clasificaci{\'o}n realizada por el SDDEF en la estrategia de CPM existente
($V_a(k)\neq 0$). En el caso de que ninguna v{\'a}lvula ha fallado, estos pesos son ajustados a cero y la
estrategia de CPM no es modificada manteniendo su formado original ($V_a(k)=0$). Al final de esta secci{\'o}n se
muestran los resultados alternativos de utilizar esta estrategia integrada respecto a la  de lazos de
control adicionales descentralizados.

La estructura final del SDDEF integrado al CTF se puede apreciar en la Fig. \ref{f4_28bis}. Claramente se
puede observar las similitudes con la mostrada en la Fig. \ref{f4_21} en lo que respecta a las herramientas
de detecci{\'o}n, clasificaci{\'o}n y estimaci{\'o}n de las fallas. La modificaci{\'o}n aqu{\'\i} se encuentra en la forma de
integraci{\'o}n al CTF. En la versi{\'o}n descentralizada se rechazaban los efectos de las fallas en v{\'a}lvulas
mediante actualizaci{\'o}n en l{\'\i}nea de las trayectorias de referencia en este caso en cambio se compensa
directamente las mediciones err{\'o}neas utilizando la estimaci{\'o}n de la falla. Adicionalmente, este caso de
SDDEF/CPM presenta la doble posibilidad de realizar la tolerancia a fallas en v{\'a}lvulas ya sea mediante de
lazos adicionales descentralizados de control o por integraci{\'o}n directa con la pol{\'\i}tica de CPM existente,
v{\'\i}a modificaci{\'o}n del funcional original.
% Figure---------------------------------------------
\begin{figure}[t]
\centering
\includegraphics[width=10cm,height=13cm]{Ch4/SDDEF_ppp_mpc}
\caption{Estructura del SDDEF para la PPP - CPM} \label{f4_28bis}
\end{figure}
%----------------------------------------------------


\subsubsection{Resultados}
En esta secci{\'o}n se resume los principales resultados obtenidos en este complejo caso de estudio. A t{\'\i}tulo de
comparaci{\'o}n con el caso descentralizado se proponen analizar los mismos tipos de fallas vistos
anteriormente. Diferentes {\'\i}ndices de rendimiento se proponen para llevar a cabo las comparaciones.
B{\'a}sicamente estos {\'\i}ndices est{\'a}n compuestos por dos grandes grupos,  el primero esta encargado de evaluar el
rendimiento del SDDEF y el segundo eval{\'u}a la estrategia de integraci{\'o}n con y sin SDDEF/CTF.

Adem{\'a}s, a final de esta secci{\'o}n puede observarse el caso de tolerancia por medio de lazos adicionales de
control utilizando la estrategia vista en la ec. \ref{e4_24}.

Inicialmente, se propone analizar el caso de falla en el sensor de no. Kappa en $E$ correspondiente con la
falla $F_{8}$. Las variables mas afectadas por este tipo de falla se pueden apreciar en la Fig. \ref{f4_29}.
El instante de ocurrencia de la falla es $T_f=25$ hr. con una magnitud de 15\% respecto de su punto
operativo normal. El SDDEF realiza las acciones de detecci{\'o}n, clasificaci{\'o}n y estimaci{\'o}n en los instantes,
$T_d=25,83$ hr., $T_c=32.50$ hr. y $T_r=50.75$ hr. respectivamente. Adicionalmente, en $T_u=67.50$ hr. se
propone una actualizaci{\'o}n de los par{\'a}metros del subsistema ACPA. La Fig. \ref{f4_29}(a) muestra el no. Kappa
en $E$ real y medido con y sin estrategia SDDEF/CTF. En $T_r$ la informaci{\'o}n generada por el SDDEF es
utilizada para realizar la correcci{\'o}n de la medici{\'o}n de forma adecuada. De esta forma el valor real del no.
Kappa en $E$ es retornado a su punto operativo deseado. Sin estrategia SDDEF/CTF claramente se observa como
la variable real se desv{\'\i}a del punto de trabajo deseado. La Fig. \ref{f4_29}(b) muestra la evoluci{\'o}n del
estad{\'\i}stico combinado, el subsistema ACPA. Claramente se distingue la detecci{\'o}n del evento y la
correspondiente actualizaci{\'o}n al nuevo punto operativo. Las salidas del SDDEF para este caso particular se
pueden observar en la Fig. \ref{f4_29}(c), en esta se presentan el soporte de la regla correctamente
clasificada, la estimaci{\'o}n del offset normalizado en $\hat{o}_{CV22}(k)$ y el tipo de falla/regla( regla
N\textordmasculine 17, $F_8+$ offset positivo en el no. Kappa en $E$). Finalmente la Fig. \ref{f4_29}(d)
presenta la contribuci{\'o}n media de las variables del proceso ($u^m_i(k)$, $i=16,\ldots,78$) a la regla
identificada.
% Figure----------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[no. Kappa en $E$]{\includegraphics[width=7cm,height=4cm]{Ch4/f1a}}
\subfigure[Estad{\'\i}stico combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/f1b}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/f1c}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 17]{\includegraphics[width=7cm,height=4cm]{Ch4/f1d}} \caption{Falla en el sensor de no.
Kappa en E ($F_8$)} \label{f4_29}
\end{figure}
%-----------------------------------------------------------------------------------------------------

Otra importante caracter{\'\i}stica de todo SDDEF es la posibilidad de manejar correctamente fallas o eventos
secuenciales. En la Fig. \ref{f4_30} se presenta el caso de fallas secuenciales en sensores. Inicialmente,
se produce una falla en el sensor de temperatura del reactor $O$ ($F_6$) en $T_{f1}=8,33$ hr. con un valor
de $-1\%$ respecto a su punto operativo normal. De forma secuencial en $T_{f2}=116,66$ hr. aparece una falla
en el sensor de temperatura de $E$ ($F_{9}$) con una magnitud de $1,5\%$. Las Figs. \ref{f4_30}(a),(b)
muestran la evoluci{\'o}n de la temperatura en $O$ y $E$ real y medida cuando se tiene o no una estrategia de
SDDEF/CTF. Contando con una estrategia integrada de SDDEF/CTF las variables reales pueden ser retornadas a
sus puntos operativos deseados correctamente, minimizando el efecto de la falla. El caso sin SDDEF/CTF
claramente muestra como estas variables se encuentran trabajando fuera del rengo deseado. En la Fig.
\ref{f4_30}(c) se puede observar el estad{\'\i}stico combinado en este caso de fallas secuenciales mostrando la
correcta detecci{\'o}n y reconfiguraci{\'o}n en cada evento. Para la primer falla los tiempos involucrados son
$T_{d1}=8,75$ hr., $T_{c1}=15,41$ hr. y $T_{r1}=33,66$ hr. para la detecci{\'o}n, clasificaci{\'o}n y estimaci{\'o}n del
valor de la falla respectivamente. Para la segunda falla estos tiempos resultan de $T_{d2}=119,41$ hr.,
$T_{c2}=126,08$ y $T_{r2}=144,33$ hr.. Los instantes de actualizaci{\'o}n de los par{\'a}metros de escala del
subsistema ACPA se producen en $T_{u1}=50,41$ hr. y $T_{u2}=161,08$ hr. para cada falla respectivamente. En
la Fig. \ref{f4_30}(d) se resumen las salidas del SDDEF, el soporte de las reglas identificadas, la
estimaci{\'o}n del offset normalizado ($\hat{o}_{CV20}(k)$ y $\hat{o}_{CV23}(k)$) y los n{\'u}meros de las reglas /
tipos de fallas(regla 12, $F_6-$ y regla 19, $F_9+$). Las Figs. \ref{f4_30}(e),(f) presentan la contribuci{\'o}n
media de las variables del proceso ($u^m_i(k)$, $i=16,\ldots,78$) a las reglas identificadas en cada caso.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[Temperatura en $O$]{\includegraphics[width=7cm,height=4cm]{Ch4/f2a}}
\subfigure[Temperatura en $E$]{\includegraphics[width=7cm,height=4cm]{Ch4/f2b}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/f2c}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/f2d}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 12]{\includegraphics[width=7cm,height=4cm]{Ch4/f2e}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 19]{\includegraphics[width=7cm,height=4cm]{Ch4/f2f}} \caption{Fallas secuenciales
en sensores ($F_6$ y $F_9$) } \label{f4_30}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

El caso de simulaci{\'o}n siguiente, mostrado en la Fig. \ref{f4_31}, consiste en probar el sistema completo
cuando ingresan perturbaciones no mediadas al proceso y secuencialmente se produce una falla en el actuador.
En $T_{f1}=8,33$ hr. se produce un cambio en las propiedades de las astillas representadas por la lignina y
la celulosa (regla 31) con valores normalizados de 1 y -1 respectivamente. Como se desprende de las Figs.
\ref{f4_31}(a),(b),(c) el efecto de la perturbaci{\'o}n es rechazado correctamente por la estrategia de control
existente y el SDDEF/CTF solo se encarga de las tareas de detecci{\'o}n, clasificaci{\'o}n y eventual informaci{\'o}n
para monitoreo. Las Figs. \ref{f4_31}(e),(f) resumen la evoluci{\'o}n del estad{\'\i}stico combinado y la
correspondiente clasificaci{\'o}n. Los instantes temporales de estas tareas resultaron $T_{d1}=11$ hr.,
$T_{c1}=17,66$ hr. y $T_{r1}=52,66$ para la detecci{\'o}n, clasificaci{\'o}n y la correspondiente actualizaci{\'o}n del
modelo ACPA. Cuando se produce la falla en la v{\'a}lvula que comanda el flujo de LV hacia el apagador de cal
($F_{14}$, regla 28) en $T_{f2}=116,66$ con un valor de 30 \%, la estrategia de control original (sin
SDDEF/CTF) no es capaz de mantener correctamente la operaci{\'o}n del proceso. Esto puede observarse de las
Figs. \ref{f4_31}(a),(b),(c) donde el flujo de astillas se incrementa dr{\'a}sticamente tratando de mantener la
tasa de producci{\'o}n original. La imposibilidad de mantener esta tasa por la estrategia cl{\'a}sica de control
produce que algunas variables del proceso se desv{\'\i}en de sus puntos operativos habituales hacia otros no
deseados. La Fig. \ref{f4_31}(c) muestra la evoluci{\'o}n del AE superior del extracto con y sin estrategia
integrada de SDDEF/CTF, esta variable esta directamente relacionada con las propiedades de dureza de la
pulpa. Este tipo de evento anormal resulta ser de suma importancia ya que r{\'a}pidamente numerosos tanques
podr{\'\i}an vaciarse provocando la parada inesperada del proceso. Para evitar estos inconvenientes la estrategia
integrada de SDDEF/CTF utiliza lazos adicionales de control para actualizar de forma adecuada la referencia
en la tasa de producci{\'o}n (Fig. \ref{f4_31}(d)). Los tiempos involucrados en este segundo evento anormal son
$T_{d2}=117,50$ hr. y $T_{c2}=124,16$ hr. para la detecci{\'o}n y clasificaci{\'o}n de la falla. En este caso no
existe $T_{r2}$ ya que no se realiza estimaci{\'o}n de magnitud de la falla por el SDDEF. En cambio en el
instante $T_{c2}$ autom{\'a}ticamente se habilita el lazo de control adicional adecuado (lazo 2) que se
encargar{\'a} de la compensaci{\'o}n de la referencia. As{\'\i} el proceso es conducido hacia un estado mas adecuado y
seguro de operaci{\'o}n. En la Fig. \ref{f4_31}(c) puede verse como el AE es retornado a su punto operativo
normal gracias a esta estrategia. Las salidas del SSDEF pueden observarse en la Fig. \ref{f4_31}(f) donde se
muestra el soporte de cada regla clasificada, el n{\'u}mero de regla/tipo de falla (reglas 31 y 28) y la
activaci{\'o}n del correspondiente lazo de control (lazo 2). Las Figs. \ref{f4_31}(g),(h) resumen la
contribuci{\'o}n media de las variables del proceso ($u^m_i(k)$, $i=13,\ldots,40$) a las reglas involucradas.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[th]
\centering \subfigure[Flujo de astillas]{\includegraphics[width=7cm,height=4cm]{Ch4/f3a}} \subfigure[Tasa de
producci{\'o}n]{\includegraphics[width=7cm,height=4cm]{Ch4/f3b}} \subfigure[AE superior del
extracto]{\includegraphics[width=7cm,height=4cm]{Ch4/f3c}} \subfigure[Lazo de control
adicional]{\includegraphics[width=7cm,height=4cm]{Ch4/f3d}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/f3e}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/f3f}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 31]{\includegraphics[width=7cm,height=4cm]{Ch4/f3g}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 28]{\includegraphics[width=7cm,height=4cm]{Ch4/f3h}} \caption{Eventos secuenciales
(perturbaci{\'o}n de lignina/celulosa y falla en el actuador $F_{14}$)} \label{f4_31}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

En la Fig. \ref{f4_32} se presenta el caso de fallas secuenciales en sensores y actuadores. En $T_{f1}=8,33$
hr. aparece inicialmente una falla en el sensor de temperatura de la torre de blanqueo $D_2$ ($F_{10}$) con
una magnitud de $-1,5\%$ respecto de su punto habitual de trabajo. Secuencialmente en $T_{f2}=116,66$ hr. se
produce un atasco de la v{\'a}lvula que comanda el flujo de pulpa hacia las torres de blanqueo ($F_{13}$) con
una valor del $-5\%$. La Fig. \ref{f4_32}(a) muestra la evoluci{\'o}n de la temperatura en $D_2$ con y sin
estrategia SDDEF/CTF. Nuevamente en este caso la estrategia integrada de SDDEF/CTF permite retornar la
variable real del proceso hacia las proximidades del punto operativo deseado, disminuyendo el efecto de la
falla. En los instantes $T_{c1}=8,75$ hr., $T_{d1}=15,41$ hr. y $T_{r1}=33,75$ hr. se realizan la detecci{\'o}n
, clasificaci{\'o}n y estimaci{\'o}n del valor de la falla para el primer evento anormal. La segunda falla
secuencial produce el bloqueo de la v{\'a}lvula que comanda el flujo de pulpa hacia las torres de blanqueo
produciendo que el proceso se desv{\'\i}e hacia otro punto operativo. Este efecto puede apreciarse claramente de
las Figs. \ref{f4_32}(b),(c),(d). Para el caso sin estrategia integrada de SDDEF/CTF la tasa de producci{\'o}n
no puede mantenerse y en consecuencia el flujo de astillas es incrementado dr{\'a}sticamente. Esto provoca que
otras variables del proceso se muevan fuera de su especificaci{\'o}n. Para evitar este comportamiento y conducir
el proceso hacia un estado de operaci{\'o}n mas seguro, la estrategia integrada de SDDEF/CTF activa el lazo de
control adicional correspondiente para actualizar la referencia de tasa de producci{\'o}n. En $T_{d2}=117,33$
hr. la falla del actuador es detectada por el subsistema ACPA utilizando el estad{\'\i}stico combinado y
clasificada en $T_{c2}=124,00$ por el subsistema de LD permitiendo la activaci{\'o}n del lazo de control
correspondiente,  Fig.\ref{f4_32}(e). Esto produce la estabilizaci{\'o}n del proceso hacia un nuevo punto
operativo mas seguro considerando las limitaciones dadas por la magnitud de la falla. Los par{\'a}metros de
escala del ACPA son actualizados en $T_{u1}=50,41$ hr. y $T_{u2}=159,00$ hr. secuencialmente. En la Fig.
\ref{f4_32}(f) se muestra el estad{\'\i}stico combinado y el proceso de actualizaci{\'o}n mencionado. Las salidas del
SDDEF se presentan en la Fig. \ref{f4_32}(g) donde se resume el soporte de cada regla clasificada, la
estimaci{\'o}n del offset normalizado ($\hat{o}_{CV25}(k)$), el lazo adicional de control activado (lazo 1), y
el n{\'u}mero de las reglas (reglas 20 y 26). Las Figs. \ref{f4_32}(h),(i) resumen la contribuci{\'o}n media de las
variables del proceso ($u^m_i(k)$, $i=13,\ldots,40$) a las reglas involucradas.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[th]
\centering \subfigure[Temperatura en $D_2$]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4a}}
\subfigure[no. Kappa del digestor]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4b}} \subfigure[Flujo de
astillas]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4c}} \subfigure[Tasa de
producci{\'o}n]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4d}} \subfigure[Lazo de control
adicional]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4e}} \subfigure[Estad{\'\i}sticos
combinados]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4f}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4g}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 20]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4h}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 26]{\includegraphics[width=7cm,height=3.5cm]{Ch4/f4i}} \caption{Fallas
secuenciales ($F_{10}$ y $F_{13}$)} \label{f4_32}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

El pr{\'o}ximo caso de simulaci{\'o}n presenta la modificaci{\'o}n del punto operativo deseado del proceso y
secuencialmente un falla del tipo sensor. Las modificaciones severas del punto operativo en $T_{f1}=8,33$
hr. consideran el cambio en la referencia de la tasa de producci{\'o}n a 690 toneladas/d{\'\i}a, el no. Kappa en $E$
a 2 y la modificaci{\'o}n de la referencia del brillo a 0.86, simult{\'a}neamente (Figs. \ref{f4_33}(a),(c)). De
forma secuencial en $T_{f2}=116,66$ hr. aparece una falla en el sensor de tasa de producci{\'o}n ($F_1$) con una
magnitud de $-10\%$. La estrategia propuesta aqu{\'\i} correctamente detecta ($T_{d2}=117.08$ hr.), clasifica
($T_{c2}=123.75$ hr.) y estima ($T_{r2}=142.08$ hr.) el valor de la falla despu{\'e}s de considerables cambios
en las condiciones de operaci{\'o}n del proceso. Este comportamiento importante del SDDEF es principalmente
debido al las caracter{\'\i}sticas adaptivas del ACP que permite retornar la contribuciones a los estad{\'\i}sticos a
su comportamiento normal, preparando as{\'\i} el sistema para posibles nuevas detecciones, clasificaciones y
estimaciones, Fig. \ref{f4_33}(b). Las salidas del SDDEF en este caso se presentan en la Fig.
\ref{f4_33}(d). La contribuci{\'o}n media de las variables del proceso ($u^m_i(k)$, $i=13,\ldots,40$) a las
reglas involucradas se pueden observar en las Figs. \ref{f4_33}(e),(f). Las modificaciones en las
referencias debido a cambios en la estrategia de venta o la demanda del mercado son considerados aqu{\'\i} como
eventos normales (no fallas, ni eventos anormales), de todas formas estas modificaciones provocan cambios
considerables en las condiciones de operaci{\'o}n del proceso, que deben ser tenidos en cuenta por el SDDEF/CTF
para evitar las falsas alarmas o p{\'e}rdida de detecci{\'o}n.
% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[th]
\centering \subfigure[Tasa de producci{\'o}n con SDDEF/CTF]{\includegraphics[width=7cm,height=4cm]{Ch4/f5a}}
\subfigure[no. Kappa en $E$ y brillo]{\includegraphics[width=7cm,height=4cm]{Ch4/f5b}}
\subfigure[Estad{\'\i}stico combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/f5c}} \subfigure[FDIE
Outputs]{\includegraphics[width=7cm,height=4cm]{Ch4/f5d}} \subfigure[Contribuci{\'o}n media a la regla N
\textordmasculine 33]{\includegraphics[width=7cm,height=4cm]{Ch4/f5e}} \subfigure[Contribuci{\'o}n media a la
regla N \textordmasculine 1]{\includegraphics[width=7cm,height=4cm]{Ch4/f5f}} \caption{Eventos secuenciales
(tres cambios de referencia y $F_{1}$)} \label{f4_33}
\end{figure}
%--------------------------------------------------------------------------------------------------------------

Finalmente, en esta secci{\'o}n se muestra el caso de falla en v{\'a}lvula utilizando e implementando la estrategia
de integraci{\'o}n al CTF sugerida en la ec. \ref{e4_24}. En este caso particular se propone comprobar el
funcionamiento del sistema cuando una falla tipo $F_{13}$ ocurre en $T_f=25$ hr. con una magnitud de $-5\%$
respecto de su valor normal de operaci{\'o}n. En la Fig. \ref{f4_34} se puede observar el modelo FIR
correspondiente a este lazo adicional de control (lazo 1), cuyos coeficientes son representados como
$g_1^j$, con $j=1,\ldots,N$ siendo $N$ el orden del modelo. Este modelo vincula entonces la tasa de
producci{\'o}n (entrada) y el flujo de pulpa hacia las torres de blanqueo (salida) en condiciones normales de
operaci{\'o}n, generando as{\'\i} un modelo libre de fallas. Los principales par{\'a}metros de esta estrategia integrada
con CPM pueden apreciarse en la Tabla \ref{t4_26} para este lazo particular. La Fig. \ref{f4_35} resume las
evoluciones de las principales variables en este caso con y sin SDDEF/CTF. Como se puede observar en
$T_d=25.4$ hr., $T_c=32.1667$ hr. and $T_r=50.5$ hr. se realizan las tareas de detcci{\'o}n, clasificaci{\'o}n y
reconfiguraci{\'o}n respectivamente. De las Figs. \ref{f4_35}(a),(b),(c) puede apreciarse como la estrategia
integrada de SDDEF/CTF/CPM permite mantener el proceso bajo un {\'a}rea segura y confiable de funcionamiento.
Sin la estrategia integrada de CTF el algoritmo de control cl{\'a}sico incrementa dr{\'a}sticamente el flujo de
astillas tratando de alcanzar la tasa de producci{\'o}n deseada. Este comportamiento produce que otras variables
del proceso se desv{\'\i}en hacia valores no deseados. Esto puede evitarse mediante la estrategia integrada
SDDEF/CTF/CPM de forma similar a el caso de lazos adicionales descentralizados, en este caso activando los
pesos en el funcional costo del lazo adicional $i=F_{13}$, como puede observarse en la Fig. \ref{f4_35}(d).
La Fig. \ref{f4_35}(e) muestra la evoluci{\'o}n del estad{\'\i}stico combinado en este caso. Las salidas del SDDEF
pueden apreciarse en la Fig. \ref{f4_35}(f). Comparando estos resultados con los mostrados oportunamente en
la Fig. \ref{f4_32}, para el caso de lazos adicionales de control descentralizados se puede observar que no
existen diferencias significativas entre las dos estrategias de integraci{\'o}n al CTF. Justamente, desde el
punto de vista de la integraci{\'o}n la estrategia basada en CPM, que activa o no los pesos correspondientes en
el funcional costo existente, parece ser la mas adecuada y elegante. Pero desde el punto de vista del
esfuerzo necesario en el ajuste de controladores, la estrategia descentralizada de la Fig. \ref{f4_32}
parece ser la ganadora en este caso. Ambas pol{\'\i}ticas definen una estrategia concreta para el correcto manejo
de este tipo de fallas. Un procedimiento similar se puede realizar para el caso de falla tipo $F_{14}$ e
integrar este lazo adicional tambi{\'e}n dentro de la estrategia CPM utilizando pesos y el funcional costo.
%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{Ajuste de par{\'a}metros lazo adicional de control integrado a CPM} \label{t4_26}
\centering
\rmfamily
  \begin{tabular}{cccccc}
  \addlinespace[0.3cm]
  \toprule[0.1em]
  $[h_w,h_P]$ [muestras] & $h_u$ [muestras] & $\alpha_{F13}$ & $\beta_{F13}$ & $N$ [muestras] & $T_S$ [min.] \\
  \midrule[0.08em]
  [1,7]                  &  1               &  1             & 0             & 20             & 5            \\
  \bottomrule[0.1em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering
\includegraphics[width=7cm,height=6cm]{Ch4/fnew_fir}
\caption{Modelo FIR -- Lazo adicional de control N\textordmasculine 1} \label{f4_34}
\end{figure}
%-----------------------------------------------------------------------------------------------------------

% Figure-------------------------------------------------------------------------------------------------------
\begin{figure}[t]
\centering \subfigure[no. Kappa del digestor]{\includegraphics[width=7cm,height=4cm]{Ch4/f6a}}
\subfigure[Flujo de astillas]{\includegraphics[width=7cm,height=4cm]{Ch4/f6b}} \subfigure[Tasa de
producci{\'o}n]{\includegraphics[width=7cm,height=4cm]{Ch4/f6c}} \subfigure[Lazo adicional en el
CPM]{\includegraphics[width=7cm,height=4cm]{Ch4/f6d}} \subfigure[Estad{\'\i}stico
combinado]{\includegraphics[width=7cm,height=4cm]{Ch4/f6e}} \subfigure[Salidas del
SDDEF]{\includegraphics[width=7cm,height=4cm]{Ch4/f6f}} \caption{Falla $F_{13}$ para la estrategia integrada
CPM} \label{f4_35}
\end{figure}
%-----------------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{{\'I}ndices de rendimiento - CPM} \label{t4_27} \centering
  \footnotesize\rmfamily
  \begin{tabular}{lrrrcccc}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  Eventos               & $T_f$ [hr.]& $T_d$ [hr.] & $PTD$ [\%] & $y_j$   & $PSR_j$ [\%]  & $ECMP_j$             & $PME_j$ [\%] \\
  \midrule[0.08em]
  $F_{1}$($+10$\%)      &  25,00     &  25,41      &  1,66      & 0,65    & 51            & $3,35\times 10^{-5}$ & 71,56            \\
  $F_{2}$($+12$\%)      &  25,00     &  25,50      &  2,00      & 0,87    & 54            & $7,56\times 10^{-6}$ & 77,78             \\
  $F_{3}$($+1$\%)       &  25,00     &  26,41      &  5,66      & 0,75    & 57            & $1,87\times 10^{-6}$ & 17,80             \\
  $F_{4}$($+1$\%)       &  25,00     &  25,41      &  1,66      & 0,77    & 56            & $2,25\times 10^{-4}$ & 62,20             \\
  $F_{5}$($+1.5$\%)     &  25,00     &  25,41      &  1,66      & 0,87    & 50            & $8,80\times 10^{-3}$ & 53,16             \\
  $F_{6}$($+1$\%)       &  25,00     &  25,41      &  1,66      & 0,75    & 55            & $2,11\times 10^{-4}$ & 78,34             \\
  $F_{7}$($+1$\%)       &  25,00     &  25,41      &  1,66      & 0,77    & 48            & $1,02\times 10^{-5}$ & 76,66              \\
  $F_{8}$($+15$\%)      &  25,00     &  25,83      &  3,33      & 0,84    & 47            & $5,65\times 10^{-7}$ & 76,30              \\
  $F_{9}$($+1.5$\%)     &  25,00     &  27,08      &  8,33      & 0,85    & 48            & $3,91\times 10^{-5}$ & 75,84              \\
  $F_{10}$($+2$\%)      &  25,00     &  25,41      &  1,66      & 0,98    & 53            & $64,00\times 10^{-3}$& 56,03              \\
  $F_{11}$($+4$\%)      &  25,00     &  25,41      &  1,66      & 0,87    & 61            & $5,76\times 10^{-4}$ & 80,54             \\
  $F_{12}$($+45$\%)     &  25,00     &  25,41      &  1,66      & 0,89    & 51            & $4,40\times 10^{-3}$ & 62,30             \\
  $F_{13}$($-5$\%)      &  25,00     &  25,50      &  2,00      & 0,98    & 26            &  $\bigotimes$        & 51,84              \\
  $F_{14}$($-15$\%)     &  25,00     &  25,75      &  3,00      & 0,99    & 75            &  $\bigotimes$        & 18,42              \\
  \midrule[0.08em]
  $F_{6}$($-1$\%) and   &  8,33      &   8,75      &  1,68      & 0,69    & 54            & $2,39\times 10^{-4}$ & 83,24             \\
  $F_{9}$($+1.5$\%)     &  116,66    & 119,41      & 11,00      & 0,85    & 48            & $2,10\times 10^{-3}$ & 58,02             \\
  \midrule[0.08em]
  lignin dist. and      &  8,33      &  11,00      & 10,68      & 0,98    & 58            & $\bigotimes$         & $\bigotimes$              \\
  $F_{14}$($-15$\%)        &  116,66    & 117,50   &  3,36      & 0,84    & 69            & $\bigotimes$         & 15,02               \\
  \midrule[0.08em]
  $F_{10}$($-1.5$\%) and &  8,33      &   8,75      &  1,68      & 0,95    & 52           & $1,64\times 10^{-4}$ & 83,07             \\
  $F_{13}$($-5$\%)       &  116,66    & 117,33      &  2,56      & 0,87    & 69           & $\bigotimes$         & 44,83              \\
  \midrule[0.08em]
  set point and          &  8,33      &   8,83      &  2,00      & 0,99    & 70           & $\bigotimes$         & $\bigotimes$             \\
  $F_{1}$($-10$\%)       &  116,66    & 117,08      &  1,68      & 0,56    & 40           & $3,21\times 10^{-4}$ & 22,42              \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

%--------------------------------------------------------------------------------------------------
\begin{table}[t]
\caption{{\'I}ndices de costos - CPM} \label{t4_28} \centering
  \footnotesize\rmfamily
  \begin{tabular}{lccccc}
  \addlinespace[0.3cm]
  \toprule[0.13em]
  \multirow{2}{1.5cm}{Fallas} & \multicolumn{2}{c}{Beneficio [\$]} & \multicolumn{2}{c}{$PMB_j$ [\%]} & Per{\'\i}odo \\
  \cmidrule[0.08em](l{0.6em}r{0.6em}){2-3}\cmidrule[0.08em](l{0.6em}r{0.6em}){4-5}
                              &Sin CTF      &Con CTF                &Sin CTF       & Con CTF             & [d{\'\i}as] \\
  \midrule[0.08em]
  $F_{1}$($+10$\%)           &  600036     &  681404                &  -11,72      &   0,24              &  4,5 \\
  $F_{11}$($+4$\%)           & -3409675    &  681706                & -601,61      &   0,28              &  4,5 \\
  $F_{13}$($-7.5$\%)         & -679745     &  456993                & -200,00      & -32,76              &  4,5 \\
  \bottomrule[0.13em]
  \end{tabular}
  \normalsize\sffamily
\end{table}
%-----------------------------------------------------------------------------------------------------

La Tabla \ref{t4_27} resume todas las evaluaciones realizadas sobre la PPP y el SDDEF, muchas de ellas no
han sido presentada en forma gr{\'a}fica debido a cuestiones de espacio. Puede observarse en todos los casos la
rapidez de detecci{\'o}n evaluada por medio de $T_d$ y el porcentaje de tiempo de detecci{\'o}n ($PTD$) utilizando
la din{\'a}mica mas lenta del proceso. En todos los casos este {\'\i}ndice no excede una magnitud del 11 \%. El
subsistema de LD es evaluado considerando el {\'\i}ndice $PSR$ y el soporte de la regla $y_j$, indicando el grado
de robustez de la falla clasificada respecto de las que no fueron consideradas. Para todos los casos se
presenta un correcto soporte de la regla y un $PSR$ nunca inferior al 26 \%. En los casos de fallas en
actuadores, perturbaciones y cambios de referencia en que el subsistema de RNA no es utilizado el s{\'\i}mbolo
$\bigotimes$ define estas situaciones. Para los casos en que las RNA son utilizadas se puede apreciar el
m{\'\i}nimo error introducido en la generalizaci{\'o}n de dichas redes, generando una correcta estimaci{\'o}n de las
fallas. Por otro lado el conjunto SDDEF/CTF es evaluado mediante el {\'\i}ndice de porcentaje de mejora del
error, $PME$, utilizando las variables involucradas en cada caso y referido al caso de estrategia de control
sin CTF. Es evidente la mejora obtenida en todos los casos.

Finalmente, el sistema integrado \c{c}sddef/CTF es evaluado en funci{\'o}n de {\'\i}ndices propios del proceso. La Tabla
\ref{t4_28} resume el an{\'a}lisis de costos realizado sobre las fallas mas importantes en este caso, utilizando
el porcentaje de mejora del beneficio $PMB$ y los beneficios de operaci{\'o}n del proceso en \$. Ambos {\'\i}ndices
son computados considerando o no la integraci{\'o}n con un SDDEF/CTF, los beneficios en condiciones normales con
la estrategia cl{\'a}sica de control y  los costos de los materiales presentados en la Tabla \ref{t4_16}. En
este caso se presentan tres falla que poseen un efecto crucial sobre el proceso, fallas en el sensor de tasa
de producci{\'o}n ($F_1$), el sensor de brillo ($F_{11}$) y falla en el actuador que comanda el flujo de pulpa
$F_{13}$). En todos los casos el tiempo de evaluaci{\'o}n a sido fijado en 4,5 d{\'\i}as luego que las acciones de
compensaci{\'o}n han sido seleccionadas. En el caso de la falla $F_1$ y sin estrategia de compensaci{\'o}n se
produce la disminuci{\'o}n de la tasa de producci{\'o}n efectiva, provocando esto grandes p{\'e}rdidas (un $PMB$
negativo de gran valor) por productos no vendidos y no poder compensar la demanda. Cuando una estrategia
SDDEF/CTF esta integrada la falla puede ser rechazada retornando el proceso a sus beneficios originales,
esto puede apreciarse con un $PMB$ peque{\~n}o cercano a cero. Conclusiones similares pueden derivarse para el
caso de falla $F_{11}$ donde el brillo es afectado con un desplazamiento fuera de especificaci{\'o}n. En este
caso el producto es fuertemente penalizado debido a que no puede ser vendido por estar fuera de
especificaci{\'o}n. Esto esta representado con un {\'\i}ndice negativo y elevado del  $PMB$ para el caso de no contar
con una estrategia SDDEF/CTF. Cuando existe una estrategia integrada de SDDEF/CTF la falla puede ser
compensada manteniendo el brillo entorno a sus valores deseados de mercado, esto se puede apreciar en un
$PMB$ peque{\~n}o y cercanoa cero evidenciando que el proceso a retornado a un punto operativo muy cercano al
normal. Un escenario diferente se puede apreciar cuando una falla en el actuador ocurre. Por ejemplo, en el
caso de ocurrencia de una falla tipo $F_{13}$ y no contar con una estrategia integrada de SDDEF/CTF se
produce un serio deterioro del rendimiento del proceso y su eventual parada de planta. Esto genera un  $PMB$
considerable y negativo, indicando claramente las p{\'e}rdidas ocasionadas. Estas p{\'e}rdidas enormes pueden
disminuirse conduciendo el proceso a un estado mas seguro de operaci{\'o}n (aunque a menor tasa de producci{\'o}n)
con la ayuda del SDDEF/CTF mediante los lazos adicionales de control (ya sea descentralizado o integrados al
CPM). Esto es claramente observable de los {\'\i}ndices de beneficio.

\subsection{Sinopsis}
En esta cap{\'\i}tulo se ha desarrollado una estrategia totalmente general para un correcto manejo de fallas y
eventos en grandes procesos qu{\'\i}micos. Se han propuesto diferentes tipos de fallas en sensores y actuadores,
as{\'\i} como tambi{\'e}n diferentes tipos de eventos como perturbaciones y cambios de referencia. La prueba de la
metodolog{\'\i}a se realizo tanto con fallas simples como secuenciales e intercalando diferentes eventos que
modifican considerablemente las condiciones de operaci{\'o}n de los procesos.

El SDDEF propuesto aqu{\'\i} esta basado en un dise{\~n}o h{\'\i}brido combinando diferentes {\'a}reas de desarrollo.
Herramientas tales como ACP adaptivo, SLD y RNA han sido combinadas y modificadas de forma de integrar un
sistema de alta eficiencia y confiabilidad. Claramente se ha demostrado como este tipo de sistemas puede
cumplir con casi todas las caracter{\'\i}sticas resumidas en la secci{\'o}n \ref{sec_caracSDDEF}.

Inicialmente se abord{\'o} el caso de procesos controlados con una estrategia de control descentralizada de
mediana y gran escala (PTAR y PPP) observando que la integraci{\'o}n con el SDDEF puede realizarse de forma
f{\'a}cil, directa y efectiva.

Claramente se ha podido constatar los beneficios de contar con una estrategia integrada de SDDEF/CTF en el
proceso, ya sea mediante {\'\i}ndices de rendimiento locales a los lazos de control como globales considerando
costos de producci{\'o}n, calidad de los productos, etc.

Se han desarrollado adem{\'a}s numerosos {\'\i}ndices que permiten la correcta evaluaci{\'o}n del SDDEF en cuanto a
rapidez de detecci{\'o}n, calidad de la clasificaci{\'o}n y calidad de la estimaci{\'o}n de la magnitud de la falla.
Todos han sido comprobados ante diferentes condiciones de operaci{\'o}n y representados de forma adecuada.

La correcta integraci{\'o}n del SDDEF/CTF por medio de actualizaci{\'o}n de trayectorias referencias para el caso de
fallas en sensores permite compensar la falla y retornar las variables reales del proceso a sus valores
habituales. La actualizaci{\'o}n del controlador (CBMI en l{\'\i}nea) y la pol{\'\i}tica de control (CEA y lazos
adicionales de control) para el caso de retardos o bloqueos en v{\'a}lvulas permiten conducir el proceso hacia
puntos operativos mas seguros y estables.

Al final del cap{\'\i}tulo se trabajo con la PPP en el caso de contar con una estrategia de control mixta
CPM/descentralizado. Claramente se observo como en este caso tambi{\'e}n la metodolog{\'\i}a de integraci{\'o}n propuesta
SDDEF/CTF resulta directa y eficaz. Dando una mejora global en el correcto manejo de eventos anormales. En
este caso de CPM la estrategia de compensaci{\'o}n de fallas en sensores radica en la compensaci{\'o}n directa de la
medici{\'o}n. Para el caso de fallas en actuadores se han propuestos dos metodolog{\'\i}as igualmente eficaces, por
un lado mantener la estrategia de lazos adicionales de control descentralizados, y por otro integrar
completamente estos lazos en la pol{\'\i}tica de CPM existente v{\'\i}a el funcional costo. Ambas estrategias ha
resultado de caracter{\'\i}sticas similares con la {\'u}nica diferencia en el esfuerzo de ajuste y la elegancia del
m{\'e}todo.
